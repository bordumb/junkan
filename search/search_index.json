{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Jnkn","text":"<p>Catch cross-domain breaking changes before they reach production.</p>"},{"location":"#why-jnkn","title":"Why <code>jnkn</code>?","text":"<ul> <li> <p> The 3am Page</p> <p>You renamed a variable in Terraform. CI passed. Code review approved. Deploy went smooth. Then your app crashes at 3am because Python still expects the old name. Every team has this story.</p> </li> <li> <p> It Gets Worse</p> <p>Your data engineer updates a dbt model, renaming <code>user_id</code> to <code>customer_id</code>. dbt tests pass. But downstream, three Airflow DAGs, a Spark job, and your ML pipeline all expect <code>user_id</code>. You find out when dashboards go blank Monday morning.</p> </li> <li> <p> Junkan Catches It</p> <p>Junkan builds a dependency graph across your entire stack. Before you merge, you see: \"This change impacts 4 Python files, 2 Terraform outputs, and 1 Kubernetes secret.\" No more surprises.</p> </li> </ul>"},{"location":"#how-it-works","title":"How It Works","text":"<pre><code>graph LR\n    subgraph Parse\n        PY[Python] --&gt; G[Graph]\n        TF[Terraform] --&gt; G\n        K8[Kubernetes] --&gt; G\n    end\n\n    subgraph Stitch\n        G --&gt; M{Token&lt;br/&gt;Matching}\n        M --&gt; L[Cross-Domain&lt;br/&gt;Links]\n    end\n\n    subgraph Analyze\n        L --&gt; B[Blast Radius]\n        B --&gt; PR[PR Comment]\n    end</code></pre> <ol> <li>Parse your codebase into a dependency graph</li> <li>Stitch cross-domain links using token matching</li> <li>Analyze blast radius for any change</li> </ol>"},{"location":"#quick-start","title":"Quick Start","text":"<ul> <li> <p>1. Install</p> <pre><code>pip install junkan\n</code></pre> </li> <li> <p>2. Scan</p> <pre><code>junkan init\njunkan scan\n</code></pre> </li> <li> <p>3. Analyze</p> <pre><code>junkan blast-radius env:DATABASE_URL\n</code></pre> </li> </ul>"},{"location":"#features","title":"Features","text":"<ul> <li> <p> 5-Minute Setup</p> <p>Install and scan your first project in minutes. No configuration required.</p> <p> Quickstart</p> </li> <li> <p> Understand Impact</p> <p>See what breaks when you change infrastructure or code. Traverse dependencies across domains.</p> <p> Blast Radius</p> </li> <li> <p> CI/CD Ready</p> <p>Block risky PRs automatically with GitHub Actions. Get impact analysis on every pull request.</p> <p> CI Integration</p> </li> <li> <p> Highly Configurable</p> <p>Tune confidence thresholds and suppress false positives. Make it work for your codebase.</p> <p> Configuration</p> </li> </ul>"},{"location":"#supported-stacks","title":"Supported Stacks","text":"Language/Tool Patterns Detected Python <code>os.getenv</code>, Pydantic Settings, Click/Typer, django-environ Terraform Resources, variables, outputs, data sources Kubernetes ConfigMaps, Secrets, environment variables dbt <code>ref()</code>, <code>source()</code>, <code>var()</code> JavaScript <code>process.env</code>, dotenv"},{"location":"#get-started","title":"Get Started","text":"<ul> <li> <p> Install</p> <p> Installation Guide</p> </li> <li> <p> Quickstart</p> <p> 5-Minute Tutorial</p> </li> <li> <p> Learn</p> <p> Full Tutorials</p> </li> </ul>"},{"location":"about/","title":"About Junkan (<code>jnkn</code>)","text":""},{"location":"about/#the-name","title":"The Name","text":"<p>Junkan (\u5faa\u74b0, \u3058\u3085\u3093\u304b\u3093, jun-kan) is Japanese for \"circulation\" or \"cycle.\"</p> <p>For the ergonomics of CLI typing, I opted to shorten this to <code>jnkn</code>.</p> <p>In Japanese, you can have:</p> <ul> <li>\u597d\u5faa\u74b0 (k\u014d-junkan) \u2014 a virtuous cycle</li> <li>\u60aa\u5faa\u74b0 (aku-junkan) \u2014 a vicious cycle</li> </ul> <p>That's exactly what cross-domain dependencies create. </p> <p>When everything is connected but nothing is tracked, you get a vicious cycle: change something, break something else, scramble to fix it, break a third thing. Repeat at 3am.</p> <p>Junkan breaks that cycle by going around your entire infrastructure \u2014 Python, Terraform, Kubernetes, dbt \u2014 and showing you the connections before they become incidents.</p> <p>jnkn is just the shorthand. Easier to type, fits nicely in a CLI.</p>"},{"location":"about/#the-philosophy","title":"The Philosophy","text":"<p>Most tools check their own domain:</p> <ul> <li>Terraform validates Terraform</li> <li>pytest tests Python</li> <li>dbt tests dbt</li> </ul> <p>Nobody checks the seams. The gaps between domains are where production breaks hide.</p> <p>Junkan's job is to trace the circle \u2014 follow a variable from your Python config, through your Terraform outputs, into your Kubernetes secrets, and back. If renaming one thing ripples across your stack, you should know before you merge.</p>"},{"location":"about/#the-goal","title":"The Goal","text":"<p>Turn \u60aa\u5faa\u74b0 into \u597d\u5faa\u74b0.</p> <p>Instead of: change \u2192 deploy \u2192 break \u2192 page \u2192 fix \u2192 repeat</p> <p>You get: change \u2192 analyze \u2192 fix \u2192 deploy \u2192 sleep</p> <p>That's the cycle we're optimizing for.</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to Jnkn.</p>"},{"location":"changelog/#versioning","title":"Versioning","text":"<p>Jnkn follows Semantic Versioning:</p> <ul> <li>MAJOR \u2014 Incompatible API changes</li> <li>MINOR \u2014 New functionality, backwards compatible</li> <li>PATCH \u2014 Bug fixes, backwards compatible</li> </ul>"},{"location":"changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"changelog/#added","title":"Added","text":"<ul> <li>Python parser expansion (50+ patterns)</li> <li>Click/Typer <code>envvar=</code> detection</li> <li>django-environ support</li> <li>python-dotenv support</li> </ul>"},{"location":"changelog/#changed","title":"Changed","text":"<ul> <li>Improved confidence calculation</li> <li>Better false positive handling</li> </ul>"},{"location":"changelog/#fixed","title":"Fixed","text":"<ul> <li>Multiline env var detection</li> <li>Pydantic <code>env_prefix</code> handling</li> </ul>"},{"location":"changelog/#010-2023-12-01","title":"[0.1.0] - 2023-12-01","text":""},{"location":"changelog/#added_1","title":"Added","text":"<ul> <li>Initial release</li> </ul>"},{"location":"changelog/#links","title":"Links","text":"<ul> <li>GitHub Releases</li> <li>Migration Guides</li> </ul>"},{"location":"cicd_date/design/","title":"CI/CD Gate Design","text":"<p>Version: 1.0.0 Last Updated: December 2024</p> <p>This document describes the design and implementation of Jnkn's CI/CD gate - a pre-merge enforcement layer that prevents breaking changes from reaching production.</p>"},{"location":"cicd_date/design/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Value Proposition</li> <li>The Problem We Solve</li> <li>Solution Overview</li> <li>Architecture</li> <li>Data Flow</li> <li>Policy Engine</li> <li>Exit Codes and Gate Logic</li> <li>Integration Points</li> <li>Technical Implementation</li> <li>Usage Examples</li> <li>Deployment Guide</li> </ol>"},{"location":"cicd_date/design/#value-proposition","title":"Value Proposition","text":""},{"location":"cicd_date/design/#the-one-liner","title":"The One-Liner","text":"<p>Jnkn's CI/CD gate tells you \"this PR will break the executive dashboard\" before you merge, not after the CEO asks why the numbers are wrong.</p>"},{"location":"cicd_date/design/#before-jnkn","title":"Before Jnkn","text":"<pre><code>Developer \u2192 PR \u2192 Code Review \u2192 Merge \u2192 Deploy \u2192 Run \u2192 Silent Failure \u2192 Alert\n                      \u2502                                       \u2502\n                      \u2502                                       \u25bc\n                      \u2502                              Hours/days later:\n                      \u2502                              \"Why are the numbers wrong?\"\n                      \u25bc\n              Reviewer can only check:\n              - Code quality\n              - Test coverage\n              - Logic correctness\n\n              Reviewer CANNOT know:\n              - What consumes this data in production\n              - Which dashboards depend on it\n              - Which ML models use it as input\n</code></pre>"},{"location":"cicd_date/design/#after-jnkn","title":"After Jnkn","text":"<pre><code>Developer \u2192 PR \u2192 Jnkn Check \u2192 Decision\n                      \u2502\n                      \u251c\u2500\u2192 PASS: Safe to merge\n                      \u2502\n                      \u251c\u2500\u2192 WARN: \"Affects ML pipeline, notify @ml-team\"\n                      \u2502\n                      \u2514\u2500\u2192 BLOCK: \"Affects executive dashboard, requires approval\"\n                              \u2502\n                              \u25bc\n                      Before any damage occurs:\n                      - Stakeholders notified\n                      - Approvals requested\n                      - Impact documented\n</code></pre>"},{"location":"cicd_date/design/#quantified-value","title":"Quantified Value","text":"Metric Without Jnkn With Jnkn Time to detect impact Hours to days Seconds (at PR time) Data incidents from code changes Common Preventable Mean time to resolution 4+ hours N/A (prevented) Stakeholder surprise Frequent Eliminated Cross-team coordination Reactive Proactive"},{"location":"cicd_date/design/#the-problem-we-solve","title":"The Problem We Solve","text":""},{"location":"cicd_date/design/#silent-data-pipeline-failures","title":"Silent Data Pipeline Failures","text":"<p>Data pipelines don't crash - they produce wrong data. A schema change, a filter modification, a column rename - none of these throw errors. They silently propagate incorrect data downstream.</p> <pre><code>graph LR\n    subgraph \"The Silent Failure Chain\"\n        CHANGE[Code Change] --&gt; JOB[Job Runs Successfully]\n        JOB --&gt; DATA[Wrong Data Written]\n        DATA --&gt; DOWNSTREAM[Downstream Jobs Run]\n        DOWNSTREAM --&gt; DASHBOARD[Dashboard Shows Wrong Numbers]\n        DASHBOARD --&gt; CEO[CEO Asks Questions]\n    end\n\n    style CHANGE fill:#4dabf7,stroke:#1971c2,color:#fff\n    style CEO fill:#ff6b6b,stroke:#c92a2a,color:#fff</code></pre>"},{"location":"cicd_date/design/#the-knowledge-gap","title":"The Knowledge Gap","text":"<p>The developer making a change often doesn't know:</p> <ol> <li>Who consumes their output - \"I didn't know the ML team uses this table\"</li> <li>What's considered critical - \"I didn't know this feeds the board deck\"</li> <li>Who to notify - \"I didn't know @finance-data owns this\"</li> </ol> <p>This knowledge exists in two places: - OpenLineage: Actual runtime dependencies - Tribal knowledge: Who owns what, what's critical</p> <p>Jnkn bridges both gaps.</p>"},{"location":"cicd_date/design/#solution-overview","title":"Solution Overview","text":""},{"location":"cicd_date/design/#core-concept","title":"Core Concept","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         jnkn check                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                     \u2502\n\u2502   INPUTS:                                                           \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502   \u2502 Changed     \u2502  \u2502 OpenLineage \u2502  \u2502 Policy      \u2502                \u2502\n\u2502   \u2502 Files       \u2502  \u2502 Data        \u2502  \u2502 Rules       \u2502                \u2502\n\u2502   \u2502 (from PR)   \u2502  \u2502 (runtime)   \u2502  \u2502 (business)  \u2502                \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502\n\u2502          \u2502                \u2502                \u2502                        \u2502\n\u2502          \u25bc                \u25bc                \u25bc                        \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502   \u2502              Analysis Engine                     \u2502              \u2502\n\u2502   \u2502                                                  \u2502              \u2502\n\u2502   \u2502  1. Parse changed files                          \u2502              \u2502\n\u2502   \u2502  2. Identify affected assets                     \u2502              \u2502\n\u2502   \u2502  3. Expand blast radius (OpenLineage)            \u2502              \u2502\n\u2502   \u2502  4. Evaluate policy rules                        \u2502              \u2502\n\u2502   \u2502  5. Determine gate decision                      \u2502              \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502                           \u2502                                         \u2502\n\u2502                           \u25bc                                         \u2502\n\u2502   OUTPUT:                                                           \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                \u2502\n\u2502   \u2502 Exit Code   \u2502  \u2502 PR Comment  \u2502  \u2502 JSON Report \u2502                \u2502\n\u2502   \u2502 0/1/2       \u2502  \u2502 (Markdown)  \u2502  \u2502 (Artifact)  \u2502                \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                \u2502\n\u2502                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"cicd_date/design/#key-design-principles","title":"Key Design Principles","text":"<ol> <li>Fail-safe defaults: Unknown assets are flagged, not ignored</li> <li>Configurable severity: Business defines what's critical</li> <li>Transparent decisions: Every block/warn includes explanation</li> <li>Graceful degradation: Works without OpenLineage (reduced accuracy)</li> <li>CI-native: Exit codes, JSON output, environment variable support</li> </ol>"},{"location":"cicd_date/design/#architecture","title":"Architecture","text":""},{"location":"cicd_date/design/#component-diagram","title":"Component Diagram","text":"<pre><code>graph TB\n    subgraph \"Input Sources\"\n        GIT[Git Diff]\n        GITHUB[GitHub API]\n        FILE[Diff File]\n    end\n\n    subgraph \"Jnkn Check Command\"\n        PARSER[Diff Parser]\n        ENGINE[Check Engine]\n        POLICY_ENGINE[Policy Engine]\n        OL_CLIENT[OpenLineage Client]\n    end\n\n    subgraph \"External Systems\"\n        MARQUEZ[(Marquez/DataHub)]\n        POLICY_FILE[policy.yaml]\n    end\n\n    subgraph \"Outputs\"\n        EXIT[Exit Code]\n        REPORT[JSON Report]\n        MARKDOWN[PR Comment]\n    end\n\n    GIT --&gt; PARSER\n    GITHUB --&gt; PARSER\n    FILE --&gt; PARSER\n\n    PARSER --&gt; ENGINE\n    OL_CLIENT --&gt; ENGINE\n    POLICY_ENGINE --&gt; ENGINE\n\n    MARQUEZ --&gt; OL_CLIENT\n    POLICY_FILE --&gt; POLICY_ENGINE\n\n    ENGINE --&gt; EXIT\n    ENGINE --&gt; REPORT\n    ENGINE --&gt; MARKDOWN\n\n    style ENGINE fill:#4dabf7,stroke:#1971c2,color:#fff</code></pre>"},{"location":"cicd_date/design/#class-hierarchy","title":"Class Hierarchy","text":"<pre><code>classDiagram\n    class CheckEngine {\n        -Policy policy\n        -str openlineage_url\n        -Dict runtime_graph\n        +run(changed_files) CheckReport\n        -_load_openlineage_data()\n        -_detect_column_changes()\n        -_identify_affected_assets()\n        -_expand_blast_radius()\n        -_evaluate_policy()\n        -_determine_result()\n    }\n\n    class Policy {\n        +List~PolicyRule~ rules\n        +Severity default_severity\n        +bool block_on_critical\n        +bool warn_on_high\n    }\n\n    class PolicyRule {\n        +str name\n        +str pattern\n        +Severity severity\n        +List~str~ owners\n        +bool require_approval\n    }\n\n    class CheckReport {\n        +CheckResult result\n        +List~ChangedFile~ changed_files\n        +List~ColumnChange~ column_changes\n        +List~AffectedAsset~ affected_assets\n        +List~PolicyViolation~ violations\n        +to_dict()\n        +to_markdown()\n    }\n\n    class ChangedFile {\n        +str path\n        +str change_type\n        +str old_path\n    }\n\n    class AffectedAsset {\n        +str id\n        +str name\n        +str asset_type\n        +Severity severity\n        +float confidence\n        +List~str~ path\n        +List~str~ owners\n    }\n\n    CheckEngine --&gt; Policy\n    CheckEngine --&gt; CheckReport\n    Policy --&gt; PolicyRule\n    CheckReport --&gt; ChangedFile\n    CheckReport --&gt; AffectedAsset</code></pre>"},{"location":"cicd_date/design/#data-flow","title":"Data Flow","text":""},{"location":"cicd_date/design/#sequence-diagram","title":"Sequence Diagram","text":"<pre><code>sequenceDiagram\n    participant CI as CI Pipeline\n    participant Check as jnkn check\n    participant Git as Git\n    participant OL as OpenLineage API\n    participant Policy as Policy File\n\n    CI-&gt;&gt;Check: Run check command\n\n    rect rgb(240, 248, 255)\n        Note over Check,Git: Step 1: Get Changed Files\n        Check-&gt;&gt;Git: git diff main HEAD\n        Git--&gt;&gt;Check: List of changed files\n    end\n\n    rect rgb(255, 248, 240)\n        Note over Check,OL: Step 2: Load Runtime Lineage\n        Check-&gt;&gt;OL: GET /api/v1/namespaces/{ns}/jobs\n        OL--&gt;&gt;Check: Jobs with inputs/outputs\n        Check-&gt;&gt;Check: Build dependency graph\n    end\n\n    rect rgb(240, 255, 240)\n        Note over Check,Policy: Step 3: Load Policy\n        Check-&gt;&gt;Policy: Read policy.yaml\n        Policy--&gt;&gt;Check: Rules and severity levels\n    end\n\n    rect rgb(255, 240, 255)\n        Note over Check: Step 4: Analysis\n        Check-&gt;&gt;Check: Parse changed files for assets\n        Check-&gt;&gt;Check: Expand blast radius via graph\n        Check-&gt;&gt;Check: Evaluate policy rules\n        Check-&gt;&gt;Check: Determine result\n    end\n\n    Check--&gt;&gt;CI: Exit code + Report\n\n    alt Exit Code 1 (BLOCKED)\n        CI-&gt;&gt;CI: Fail the build\n    else Exit Code 2 (WARN)\n        CI-&gt;&gt;CI: Pass with warnings\n    else Exit Code 0 (PASS)\n        CI-&gt;&gt;CI: Pass\n    end</code></pre>"},{"location":"cicd_date/design/#blast-radius-expansion","title":"Blast Radius Expansion","text":"<pre><code>graph TB\n    subgraph \"Direct Impact (from code)\"\n        FILE[daily_user_etl.py]\n        JOB1[job:daily_user_etl]\n        TABLE1[data:dim_users]\n    end\n\n    subgraph \"1st Degree (from OpenLineage)\"\n        JOB2[job:user_metrics_agg]\n        JOB3[job:churn_features]\n        JOB4[job:marketing_loader]\n    end\n\n    subgraph \"2nd Degree (from OpenLineage)\"\n        TABLE2[data:agg_user_metrics]\n        TABLE3[data:ml-features/churn]\n        TABLE4[data:campaign_targets]\n    end\n\n    subgraph \"3rd Degree (from OpenLineage)\"\n        JOB5[job:exec_dashboard_loader]\n    end\n\n    subgraph \"Final Impact\"\n        CRITICAL[data:exec_dashboard]\n    end\n\n    FILE --&gt; JOB1\n    JOB1 --&gt; TABLE1\n    TABLE1 --&gt; JOB2\n    TABLE1 --&gt; JOB3\n    TABLE1 --&gt; JOB4\n    JOB2 --&gt; TABLE2\n    JOB3 --&gt; TABLE3\n    JOB4 --&gt; TABLE4\n    TABLE2 --&gt; JOB5\n    JOB5 --&gt; CRITICAL\n\n    style FILE fill:#4dabf7,stroke:#1971c2,color:#fff\n    style CRITICAL fill:#ff6b6b,stroke:#c92a2a,color:#fff</code></pre>"},{"location":"cicd_date/design/#policy-engine","title":"Policy Engine","text":""},{"location":"cicd_date/design/#policy-configuration","title":"Policy Configuration","text":"<pre><code># policy.yaml\n\n# Global settings\nblock_on_critical: true   # Exit 1 when critical systems affected\nwarn_on_high: true        # Exit 2 when high-severity systems affected\n\n# Critical assets - BLOCK the PR\ncritical:\n  - name: Executive Dashboards\n    pattern: \".*(exec|executive|board).*dashboard.*\"\n    severity: critical\n    owners:\n      - \"@data-platform-team\"\n      - \"@analytics-leadership\"\n    require_approval: true\n    notify_always: true\n\n  - name: Financial Systems\n    pattern: \".*(revenue|finance|billing).*\"\n    severity: critical\n    owners:\n      - \"@finance-data\"\n    require_approval: true\n\n# High-severity assets - WARN\nrules:\n  - name: ML Feature Pipelines\n    pattern: \".*(ml-feature|feature-store|model).*\"\n    severity: high\n    owners:\n      - \"@ml-engineering\"\n    require_approval: true\n\n  - name: Data Warehouse Core\n    pattern: \".*(dim_|fact_|warehouse\\\\.).*\"\n    severity: medium\n    owners:\n      - \"@data-engineering\"\n    require_approval: false\n</code></pre>"},{"location":"cicd_date/design/#pattern-matching","title":"Pattern Matching","text":"<pre><code>graph TB\n    subgraph \"Asset ID\"\n        ASSET[\"data:redshift/analytics.exec_dashboard\"]\n    end\n\n    subgraph \"Policy Rules\"\n        RULE1[\"Executive Dashboards&lt;br/&gt;pattern: .*(exec|executive).*dashboard.*\"]\n        RULE2[\"Financial Systems&lt;br/&gt;pattern: .*(revenue|finance).*\"]\n        RULE3[\"ML Features&lt;br/&gt;pattern: .*(ml-feature).*\"]\n    end\n\n    subgraph \"Evaluation\"\n        MATCH[\"\u2713 MATCH: Executive Dashboards\"]\n        RESULT[\"severity: CRITICAL&lt;br/&gt;owners: @data-platform-team\"]\n    end\n\n    ASSET --&gt; RULE1\n    ASSET --&gt; RULE2\n    ASSET --&gt; RULE3\n\n    RULE1 --&gt; MATCH\n    MATCH --&gt; RESULT\n\n    style MATCH fill:#40c057,stroke:#2f9e44,color:#fff\n    style RESULT fill:#ff6b6b,stroke:#c92a2a,color:#fff</code></pre>"},{"location":"cicd_date/design/#severity-levels","title":"Severity Levels","text":"Severity Exit Code Behavior Use Case CRITICAL 1 Block PR Executive dashboards, compliance, revenue HIGH 2 Warn, request approval ML pipelines, core warehouse MEDIUM 0 Warn, notify owners Reporting tables, analytics LOW 0 Log only Staging, temp tables"},{"location":"cicd_date/design/#exit-codes-and-gate-logic","title":"Exit Codes and Gate Logic","text":""},{"location":"cicd_date/design/#decision-tree","title":"Decision Tree","text":"<pre><code>flowchart TB\n    START[Start Check] --&gt; ANALYZE[Analyze Changed Files]\n    ANALYZE --&gt; EXPAND[Expand Blast Radius]\n    EXPAND --&gt; EVAL[Evaluate Policy Rules]\n\n    EVAL --&gt; CRIT{Any CRITICAL&lt;br/&gt;violations?}\n\n    CRIT --&gt;|Yes| BLOCK_CHECK{block_on_critical&lt;br/&gt;= true?}\n    BLOCK_CHECK --&gt;|Yes| BLOCKED[Exit 1: BLOCKED]\n    BLOCK_CHECK --&gt;|No| HIGH_CHECK\n\n    CRIT --&gt;|No| HIGH_CHECK{Any HIGH&lt;br/&gt;violations?}\n\n    HIGH_CHECK --&gt;|Yes| WARN_CHECK{warn_on_high&lt;br/&gt;= true?}\n    WARN_CHECK --&gt;|Yes| WARN[Exit 2: WARN]\n    WARN_CHECK --&gt;|No| ANY_CHECK\n\n    HIGH_CHECK --&gt;|No| ANY_CHECK{Any other&lt;br/&gt;violations?}\n\n    ANY_CHECK --&gt;|Yes| WARN\n    ANY_CHECK --&gt;|No| PASS[Exit 0: PASS]\n\n    style BLOCKED fill:#ff6b6b,stroke:#c92a2a,color:#fff\n    style WARN fill:#fab005,stroke:#f59f00,color:#000\n    style PASS fill:#40c057,stroke:#2f9e44,color:#fff</code></pre>"},{"location":"cicd_date/design/#exit-code-semantics","title":"Exit Code Semantics","text":"<pre><code>Exit 0 (PASS)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n- No policy violations\n- OR only LOW severity matches\n- Safe to merge automatically\n\nExit 1 (BLOCKED)  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n- CRITICAL severity violation\n- AND block_on_critical = true\n- PR cannot merge without override\n- Requires explicit approval from owners\n\nExit 2 (WARN)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n- HIGH severity violation\n- OR MEDIUM with notify\n- PR can merge but stakeholders notified\n- Approval recommended but not required\n</code></pre>"},{"location":"cicd_date/design/#integration-points","title":"Integration Points","text":""},{"location":"cicd_date/design/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Jnkn Impact Analysis\n\non:\n  pull_request:\n    paths:\n      - 'src/**/*.py'\n      - 'dbt/**/*.sql'\n\njobs:\n  impact-check:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Run Jnkn Check\n        id: jnkn\n        env:\n          OPENLINEAGE_URL: ${{ secrets.MARQUEZ_URL }}\n        run: |\n          jnkn check \\\n            --git-diff origin/${{ github.base_ref }} HEAD \\\n            --policy policy.yaml \\\n            --output report.json \\\n            --format json\n        continue-on-error: true\n\n      - name: Comment on PR\n        uses: actions/github-script@v7\n        with:\n          script: |\n            const report = require('./report.json');\n            // Post formatted comment\n\n      - name: Enforce Gate\n        if: steps.jnkn.outcome == 'failure'\n        run: exit 1\n</code></pre>"},{"location":"cicd_date/design/#gitlab-ci","title":"GitLab CI","text":"<pre><code>jnkn-check:\n  stage: validate\n  script:\n    - jnkn check --git-diff $CI_MERGE_REQUEST_TARGET_BRANCH_NAME HEAD\n      --openlineage-url $MARQUEZ_URL\n      --policy policy.yaml\n      --output report.json\n  artifacts:\n    reports:\n      dotenv: jnkn.env\n    paths:\n      - report.json\n  allow_failure:\n    exit_codes:\n      - 2  # Allow WARN to pass\n</code></pre>"},{"location":"cicd_date/design/#jenkins","title":"Jenkins","text":"<pre><code>pipeline {\n    stages {\n        stage('Impact Analysis') {\n            steps {\n                sh '''\n                    jnkn check \\\n                        --git-diff origin/main HEAD \\\n                        --policy policy.yaml \\\n                        --output report.json\n                '''\n            }\n            post {\n                always {\n                    archiveArtifacts artifacts: 'report.json'\n                }\n                failure {\n                    // Notify stakeholders\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"cicd_date/design/#technical-implementation","title":"Technical Implementation","text":""},{"location":"cicd_date/design/#command-interface","title":"Command Interface","text":"<pre><code>@click.command()\n@click.option(\"--diff\", \"diff_file\", type=click.Path(exists=True),\n              help=\"File containing list of changed files\")\n@click.option(\"--git-diff\", \"git_diff\", nargs=2, metavar=\"BASE HEAD\",\n              help=\"Git refs to diff (e.g., main HEAD)\")\n@click.option(\"--github-pr\", type=int, \n              help=\"GitHub PR number\")\n@click.option(\"--repo\", \n              help=\"GitHub repo (owner/repo)\")\n@click.option(\"--openlineage-url\", envvar=\"OPENLINEAGE_URL\",\n              help=\"OpenLineage/Marquez API URL\")\n@click.option(\"--policy\", \"policy_file\", type=click.Path(exists=True),\n              help=\"Policy YAML file\")\n@click.option(\"--fail-if-critical\", is_flag=True,\n              help=\"Exit 1 if critical systems affected\")\n@click.option(\"--output\", \"-o\", type=click.Path(),\n              help=\"Write JSON report to file\")\n@click.option(\"--format\", type=click.Choice([\"text\", \"json\", \"markdown\"]),\n              default=\"text\")\ndef check(...):\n    \"\"\"Run pre-merge impact analysis.\"\"\"\n</code></pre>"},{"location":"cicd_date/design/#core-algorithm","title":"Core Algorithm","text":"<pre><code>class CheckEngine:\n    def run(self, changed_files: List[ChangedFile]) -&gt; CheckReport:\n        # Step 1: Load runtime lineage (if configured)\n        if self.openlineage_url:\n            self._load_openlineage_data()\n\n        # Step 2: Detect column-level changes\n        column_changes = self._detect_column_changes(changed_files)\n\n        # Step 3: Identify directly affected assets\n        direct_assets = self._identify_affected_assets(changed_files)\n\n        # Step 4: Expand blast radius using OpenLineage graph\n        all_affected = self._expand_blast_radius(direct_assets)\n\n        # Step 5: Evaluate policy rules\n        violations = self._evaluate_policy(all_affected)\n\n        # Step 6: Determine final result\n        result = self._determine_result(violations)\n\n        return CheckReport(\n            result=result,\n            changed_files=changed_files,\n            column_changes=column_changes,\n            affected_assets=all_affected,\n            violations=violations,\n        )\n</code></pre>"},{"location":"cicd_date/design/#output-formats","title":"Output Formats","text":"<p>Text (Terminal) <pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551  \u274c BLOCKED - Critical Impact Detected \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\nSummary:\n  Changed files:     1\n  Downstream impact: 10\n  Critical systems:  2\n\nPolicy Violations:\n  \ud83d\udea8 Executive Dashboards: Changes affect 2 assets\n     Required approvers: @data-platform-team\n</code></pre></p> <p>JSON (Artifacts) <pre><code>{\n  \"result\": \"BLOCKED\",\n  \"exit_code\": 1,\n  \"summary\": {\n    \"changed_files\": 1,\n    \"total_downstream\": 10,\n    \"critical_count\": 2\n  },\n  \"violations\": [\n    {\n      \"rule\": \"Executive Dashboards\",\n      \"severity\": \"critical\",\n      \"required_approvers\": [\"@data-platform-team\"]\n    }\n  ]\n}\n</code></pre></p> <p>Markdown (PR Comments) <pre><code>## \ud83d\udd0d Jnkn Impact Analysis\n\n### \u274c BLOCKED - Critical Impact Detected\n\n| Metric | Count |\n|--------|-------|\n| Changed Files | 1 |\n| Downstream Impact | 10 |\n| Critical Systems | 2 |\n\n### \ud83d\udea8 Critical Systems Affected\n\n- **exec_dashboard** (owners: @data-platform-team)\n</code></pre></p>"},{"location":"cicd_date/design/#usage-examples","title":"Usage Examples","text":""},{"location":"cicd_date/design/#basic-usage","title":"Basic Usage","text":"<pre><code># Diff against main branch\njnkn check --git-diff main HEAD\n\n# From a file of changed paths\njnkn check --diff changed_files.txt\n\n# From GitHub PR\njnkn check --github-pr 123 --repo myorg/myrepo\n</code></pre>"},{"location":"cicd_date/design/#with-openlineage","title":"With OpenLineage","text":"<pre><code># Enrich with runtime lineage\njnkn check --git-diff main HEAD \\\n    --openlineage-url http://marquez:5000 \\\n    --openlineage-namespace spark-production\n</code></pre>"},{"location":"cicd_date/design/#with-policy","title":"With Policy","text":"<pre><code># Apply business rules\njnkn check --git-diff main HEAD \\\n    --policy policy.yaml \\\n    --fail-if-critical\n</code></pre>"},{"location":"cicd_date/design/#full-ci-integration","title":"Full CI Integration","text":"<pre><code># Complete example for CI\njnkn check \\\n    --git-diff origin/main HEAD \\\n    --openlineage-url $MARQUEZ_URL \\\n    --policy policy.yaml \\\n    --output impact-report.json \\\n    --format json \\\n    --fail-if-critical\n\n# Use exit code for gate decision\nif [ $? -eq 1 ]; then\n    echo \"BLOCKED: Critical impact detected\"\n    exit 1\nelif [ $? -eq 2 ]; then\n    echo \"WARNING: Review required\"\nfi\n</code></pre>"},{"location":"cicd_date/design/#deployment-guide","title":"Deployment Guide","text":""},{"location":"cicd_date/design/#prerequisites","title":"Prerequisites","text":"<ol> <li>Jnkn installed: <code>pip install jnkn</code></li> <li>Git available: For diff parsing</li> <li>OpenLineage/Marquez (optional): For runtime enrichment</li> <li>Policy file: Define your critical assets</li> </ol>"},{"location":"cicd_date/design/#quick-start","title":"Quick Start","text":"<pre><code># 1. Create policy file\ncat &gt; policy.yaml &lt;&lt; 'EOF'\nblock_on_critical: true\ncritical:\n  - name: Executive Dashboards\n    pattern: \".*exec.*dashboard.*\"\n    severity: critical\n    owners: [\"@data-platform\"]\n    require_approval: true\nEOF\n\n# 2. Test locally\njnkn check --git-diff main HEAD --policy policy.yaml\n\n# 3. Add to CI pipeline\n# (see GitHub Actions example above)\n</code></pre>"},{"location":"cicd_date/design/#environment-variables","title":"Environment Variables","text":"Variable Description Default <code>OPENLINEAGE_URL</code> Marquez/DataHub API URL None <code>OPENLINEAGE_NAMESPACE</code> Namespace to query All <code>GITHUB_TOKEN</code> For GitHub PR API None <code>JUNKAN_POLICY</code> Default policy file None"},{"location":"cicd_date/design/#rollout-strategy","title":"Rollout Strategy","text":"<pre><code>Phase 1: Shadow Mode (Week 1-2)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n- Run check but don't block\n- Collect data on what would be blocked\n- Tune policy rules based on findings\n\nPhase 2: Warn Mode (Week 3-4)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n- Enable warn_on_high\n- Post PR comments\n- Don't block merges yet\n\nPhase 3: Enforce Mode (Week 5+)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n- Enable block_on_critical\n- Fail CI for critical impacts\n- Full enforcement active\n</code></pre>"},{"location":"cicd_date/design/#summary","title":"Summary","text":""},{"location":"cicd_date/design/#what-we-built","title":"What We Built","text":"Component Purpose <code>jnkn check</code> CLI command for CI/CD integration Policy Engine Business rules for severity classification OpenLineage Client Runtime lineage enrichment Multiple Outputs Text, JSON, Markdown for different consumers"},{"location":"cicd_date/design/#key-differentiators","title":"Key Differentiators","text":"<ol> <li>Pre-merge, not post-facto - Catch issues before they cause damage</li> <li>OpenLineage integration - Real production dependencies, not guesses</li> <li>Policy-driven - Business defines what's critical</li> <li>CI-native - Exit codes, artifacts, PR comments</li> </ol>"},{"location":"cicd_date/design/#whats-next","title":"What's Next","text":"<ol> <li>Diff-aware analysis - \"Column X removed\" vs \"file changed\"</li> <li>Approval workflows - Native GitHub/GitLab approval integration</li> <li>Slack notifications - Direct alerts to team channels</li> <li>Dashboard - Web UI for exploring impact history</li> </ol>"},{"location":"community/","title":"Community","text":"<p>Join the Jnkn community.</p>"},{"location":"community/#get-help","title":"Get Help","text":"<ul> <li>GitHub Discussions \u2014 Ask questions, share ideas</li> <li>Slack \u2014 Real-time chat with maintainers</li> <li>Stack Overflow \u2014 Tag questions with <code>jnkn</code></li> </ul>"},{"location":"community/#contribute","title":"Contribute","text":"<p>We welcome contributions of all kinds:</p> <ul> <li>\ud83d\udc1b Bug reports \u2014 Found an issue? Open an issue</li> <li>\ud83d\udca1 Feature requests \u2014 Have an idea? Start a discussion</li> <li>\ud83d\udcd6 Documentation \u2014 Fix typos, add examples</li> <li>\ud83d\udd27 Code \u2014 Bug fixes, new features</li> </ul> <p>See Contributing Guide to get started.</p>"},{"location":"community/#links","title":"Links","text":"<ul> <li>GitHub Repository</li> <li>Issue Tracker</li> <li>Discussions</li> <li>Slack Workspace</li> </ul>"},{"location":"community/#code-of-conduct","title":"Code of Conduct","text":"<p>We are committed to providing a welcoming and inclusive experience for everyone. Please read our Code of Conduct.</p>"},{"location":"community/code-of-conduct/","title":"Code of Conduct","text":"<p>Community standards.</p>"},{"location":"community/contributing/","title":"Contributing","text":"<p>Thank you for your interest in contributing to Jnkn!</p>"},{"location":"community/contributing/#quick-start","title":"Quick Start","text":"<pre><code># Clone\ngit clone https://github.com/bordumb/jnkn.git\ncd jnkn\n\n# Install with dev dependencies\npip install -e \".[full,dev]\"\n\n# Run tests\npytest\n\n# Run linter\nruff check .\n</code></pre>"},{"location":"community/contributing/#development-workflow","title":"Development Workflow","text":""},{"location":"community/contributing/#1-find-or-create-an-issue","title":"1. Find or Create an Issue","text":"<ul> <li>Check existing issues</li> <li>For new features, open a discussion first</li> <li>Comment on an issue to claim it</li> </ul>"},{"location":"community/contributing/#2-create-a-branch","title":"2. Create a Branch","text":"<pre><code>git checkout -b feature/your-feature-name\n# or\ngit checkout -b fix/issue-number-description\n</code></pre>"},{"location":"community/contributing/#3-make-changes","title":"3. Make Changes","text":"<ul> <li>Write code</li> <li>Add tests</li> <li>Update documentation</li> </ul>"},{"location":"community/contributing/#4-test","title":"4. Test","text":"<pre><code># Run all tests\npytest\n\n# Run specific tests\npytest tests/unit/test_confidence.py\n\n# Run with coverage\npytest --cov=jnkn\n</code></pre>"},{"location":"community/contributing/#5-lint","title":"5. Lint","text":"<pre><code># Check\nruff check .\n\n# Fix automatically\nruff check --fix .\n\n# Format\nruff format .\n</code></pre>"},{"location":"community/contributing/#6-submit-pr","title":"6. Submit PR","text":"<ul> <li>Push your branch</li> <li>Open a Pull Request</li> <li>Fill out the PR template</li> <li>Wait for review</li> </ul>"},{"location":"community/contributing/#what-to-contribute","title":"What to Contribute","text":""},{"location":"community/contributing/#good-first-issues","title":"Good First Issues","text":"<p>Look for issues labeled <code>good first issue</code>:</p> <ul> <li>Documentation improvements</li> <li>Test coverage</li> <li>Small bug fixes</li> </ul>"},{"location":"community/contributing/#larger-contributions","title":"Larger Contributions","text":"<p>For bigger changes, discuss first:</p> <ul> <li>New language parsers</li> <li>New stitching rules</li> <li>Performance improvements</li> <li>New output formats</li> </ul>"},{"location":"community/contributing/#code-style","title":"Code Style","text":"<ul> <li>Python 3.11+ \u2014 Use modern syntax</li> <li>Type hints \u2014 All public functions</li> <li>Docstrings \u2014 Google style</li> <li>Tests \u2014 Aim for 90%+ coverage</li> </ul>"},{"location":"community/contributing/#example","title":"Example","text":"<pre><code>def calculate_confidence(\n    source_tokens: list[str],\n    target_tokens: list[str],\n) -&gt; float:\n    \"\"\"\n    Calculate match confidence between token sets.\n\n    Args:\n        source_tokens: Tokens from source artifact.\n        target_tokens: Tokens from target artifact.\n\n    Returns:\n        Confidence score between 0.0 and 1.0.\n\n    Example:\n        &gt;&gt;&gt; calculate_confidence([\"database\", \"url\"], [\"database\", \"url\"])\n        0.9\n    \"\"\"\n    ...\n</code></pre>"},{"location":"community/contributing/#documentation","title":"Documentation","text":"<p>Documentation lives in <code>docs/</code>. We use MkDocs Material.</p>"},{"location":"community/contributing/#preview-locally","title":"Preview Locally","text":"<pre><code>pip install mkdocs-material\nmkdocs serve\n# Open http://localhost:8000\n</code></pre>"},{"location":"community/contributing/#guidelines","title":"Guidelines","text":"<ul> <li>Be concise</li> <li>Include examples</li> <li>Update relevant pages when changing features</li> </ul>"},{"location":"community/contributing/#questions","title":"Questions?","text":"<ul> <li>Open a GitHub Discussion</li> <li>Ask in Slack</li> <li>Email maintainers@jnkn.io</li> </ul>"},{"location":"community/development-setup/","title":"Development Setup","text":"<p>Set up a local development environment.</p>"},{"location":"community/development-setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11+</li> <li>Git</li> <li>(Optional) Docker</li> </ul>"},{"location":"community/development-setup/#clone-repository","title":"Clone Repository","text":"<pre><code>git clone https://github.com/bordumb/jnkn.git\ncd jnkn\n</code></pre>"},{"location":"community/development-setup/#install-dependencies","title":"Install Dependencies","text":""},{"location":"community/development-setup/#using-pip","title":"Using pip","text":"<pre><code># Create virtual environment\npython -m venv .venv\nsource .venv/bin/activate  # or .venv\\Scripts\\activate on Windows\n\n# Install with all dependencies\npip install -e \".[full,dev]\"\n</code></pre>"},{"location":"community/development-setup/#using-uv-recommended","title":"Using uv (Recommended)","text":"<pre><code>uv venv\nsource .venv/bin/activate\nuv pip install -e \".[full,dev]\"\n</code></pre>"},{"location":"community/development-setup/#verify-installation","title":"Verify Installation","text":"<pre><code># CLI works\njnkn --version\n\n# Tests pass\npytest tests/unit/ -v\n\n# Linter passes\nruff check .\n</code></pre>"},{"location":"community/development-setup/#project-structure","title":"Project Structure","text":"<pre><code>jnkn/\n\u251c\u2500\u2500 src/jnkn/           # Main package\n\u2502   \u251c\u2500\u2500 cli/              # CLI commands\n\u2502   \u251c\u2500\u2500 core/             # Core types, graph, storage\n\u2502   \u251c\u2500\u2500 parsing/          # Language parsers\n\u2502   \u2502   \u251c\u2500\u2500 python/\n\u2502   \u2502   \u251c\u2500\u2500 terraform/\n\u2502   \u2502   \u2514\u2500\u2500 kubernetes/\n\u2502   \u251c\u2500\u2500 stitching/        # Cross-domain linking\n\u2502   \u2514\u2500\u2500 analysis/         # Blast radius, explain, diff\n\u251c\u2500\u2500 tests/\n\u2502   \u251c\u2500\u2500 unit/             # Unit tests\n\u2502   \u251c\u2500\u2500 integration/      # Integration tests\n\u2502   \u2514\u2500\u2500 e2e/              # End-to-end tests\n\u251c\u2500\u2500 docs/                 # Documentation\n\u2514\u2500\u2500 pyproject.toml        # Project configuration\n</code></pre>"},{"location":"community/development-setup/#running-tests","title":"Running Tests","text":"<pre><code># All tests\npytest\n\n# Unit tests only\npytest tests/unit/\n\n# Specific test file\npytest tests/unit/test_confidence.py\n\n# With coverage\npytest --cov=jnkn --cov-report=html\nopen htmlcov/index.html\n</code></pre>"},{"location":"community/development-setup/#running-linter","title":"Running Linter","text":"<pre><code># Check\nruff check .\n\n# Fix automatically\nruff check --fix .\n\n# Format\nruff format .\n</code></pre>"},{"location":"community/development-setup/#building-documentation","title":"Building Documentation","text":"<pre><code># Install docs dependencies\npip install mkdocs-material mkdocstrings[python]\n\n# Serve locally\nmkdocs serve\n\n# Build\nmkdocs build\n</code></pre>"},{"location":"community/development-setup/#ide-setup","title":"IDE Setup","text":""},{"location":"community/development-setup/#vs-code","title":"VS Code","text":"<p>Recommended extensions: - Python - Ruff - Even Better TOML</p> <p>Settings (<code>.vscode/settings.json</code>):</p> <pre><code>{\n  \"python.defaultInterpreterPath\": \".venv/bin/python\",\n  \"python.testing.pytestEnabled\": true,\n  \"editor.formatOnSave\": true,\n  \"[python]\": {\n    \"editor.defaultFormatter\": \"charliermarsh.ruff\"\n  }\n}\n</code></pre>"},{"location":"community/development-setup/#pycharm","title":"PyCharm","text":"<ul> <li>Set Project Interpreter to <code>.venv</code></li> <li>Enable pytest as test runner</li> <li>Configure Ruff as external tool</li> </ul>"},{"location":"community/development-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"community/development-setup/#tree-sitter-not-found","title":"Tree-sitter not found","text":"<pre><code>pip install tree-sitter tree-sitter-languages\n</code></pre>"},{"location":"community/development-setup/#tests-fail-with-import-error","title":"Tests fail with import error","text":"<pre><code>pip install -e \".[full,dev]\"\n</code></pre>"},{"location":"community/development-setup/#permission-denied-on-scripts","title":"Permission denied on scripts","text":"<pre><code>chmod +x scripts/*.sh\n</code></pre>"},{"location":"community/release-process/","title":"Release Process","text":"<p>How versions are released.</p>"},{"location":"community/roadmap/","title":"Roadmap","text":"<p>Future plans.</p>"},{"location":"community/testing-guide/","title":"Testing Guide","text":"<p>Running and writing tests.</p>"},{"location":"explanation/","title":"Explanation","text":"<p>Understand how and why Jnkn works.</p>"},{"location":"explanation/#architecture","title":"Architecture","text":"<ul> <li>Overview \u2014 High-level system design</li> <li>Parsing Pipeline \u2014 How code becomes a graph</li> <li>Stitching Engine \u2014 How cross-domain links are made</li> <li>Confidence Model \u2014 How match quality is scored</li> </ul>"},{"location":"explanation/#concepts","title":"Concepts","text":"<ul> <li>Dependency Graph \u2014 The core data structure</li> <li>Blast Radius \u2014 Understanding impact analysis</li> <li>Cross-Domain Dependencies \u2014 The problem Jnkn solves</li> </ul>"},{"location":"explanation/#design-decisions","title":"Design Decisions","text":"<ul> <li>Why Tree-Sitter \u2014 Parser technology choice</li> <li>Why Token Matching \u2014 Matching strategy rationale</li> </ul>"},{"location":"explanation/#security","title":"Security","text":"<ul> <li>Threat Model \u2014 Security considerations</li> </ul>"},{"location":"explanation/architecture/confidence-model/","title":"Confidence Model","text":"<p>How Jnkn scores match quality.</p>"},{"location":"explanation/architecture/confidence-model/#overview","title":"Overview","text":"<p>Confidence answers: \"How likely is this match correct?\"</p> <pre><code>Final Score = Base Signal \u00d7 \u03a0(Penalties)\n</code></pre> <p>A score of 0.85 means \"85% confident this is a real dependency.\"</p>"},{"location":"explanation/architecture/confidence-model/#signals","title":"Signals","text":"<p>Signals are positive indicators that increase base confidence.</p> Signal Score Description <code>exact_match</code> 1.0 Names are identical <code>normalized_match</code> 0.9 Names equal after normalization <code>token_overlap_high</code> 0.85 &gt;80% of tokens overlap <code>token_overlap_medium</code> 0.7 50-80% overlap <code>suffix_match</code> 0.6 Names end with same tokens <code>prefix_match</code> 0.6 Names start with same tokens <code>contains</code> 0.5 One name contains the other <code>single_token</code> 0.4 Only one token matches <p>Only the highest signal is used (they don't stack).</p>"},{"location":"explanation/architecture/confidence-model/#penalties","title":"Penalties","text":"<p>Penalties reduce confidence when matches are weak.</p> Penalty Multiplier Condition <code>short_token</code> 0.5 Any matched token &lt; 4 chars <code>common_token</code> 0.7 Only generic words matched <code>ambiguous</code> 0.8 Multiple targets could match <code>low_value</code> 0.9 Matched low-value tokens <p>Penalties stack multiplicatively.</p>"},{"location":"explanation/architecture/confidence-model/#calculation-example","title":"Calculation Example","text":"<p>Match: <code>env:DB_HOST</code> \u2192 <code>infra:db_host</code></p> <pre><code>Tokens:\n  Source: [db, host]\n  Target: [db, host]\n\nSignal:\n  normalized_match \u2192 0.9 (names equal after normalization)\n\nPenalties:\n  short_token (db=2 chars) \u2192 \u00d70.5\n\nFinal:\n  0.9 \u00d7 0.5 = 0.45\n</code></pre> <p>With threshold 0.5, this match is rejected (0.45 &lt; 0.5).</p>"},{"location":"explanation/architecture/confidence-model/#another-example","title":"Another Example","text":"<p>Match: <code>env:PAYMENT_DATABASE_URL</code> \u2192 <code>infra:payment_db_instance</code></p> <pre><code>Tokens:\n  Source: [payment, database, url]\n  Target: [payment, db, instance]\n\nOverlap: [payment] (1 of 3)\n\nSignal:\n  single_token \u2192 0.4\n\nPenalties:\n  none\n\nFinal:\n  0.4\n</code></pre> <p>With threshold 0.5, this is rejected.</p>"},{"location":"explanation/architecture/confidence-model/#high-confidence-match","title":"High-Confidence Match","text":"<p>Match: <code>env:STRIPE_API_KEY</code> \u2192 <code>infra:var.stripe_api_key</code></p> <pre><code>Tokens:\n  Source: [stripe, api, key]\n  Target: [stripe, api, key]\n\nSignal:\n  normalized_match \u2192 0.9\n\nPenalties:\n  short_token (api=3, key=3) \u2192 \u00d70.5 \u00d7 0.5 = \u00d70.25? \n\n  No! Penalty applies once per category, not per token.\n  short_token \u2192 \u00d70.5\n\nFinal:\n  0.9 \u00d7 0.5 = 0.45\n</code></pre> <p>Hmm, this is still rejected. Let's tune:</p>"},{"location":"explanation/architecture/confidence-model/#tuning-confidence","title":"Tuning Confidence","text":"<p>If good matches are being rejected, you have options:</p>"},{"location":"explanation/architecture/confidence-model/#lower-the-threshold","title":"Lower the threshold","text":"<pre><code>stitching:\n  min_confidence: 0.4\n</code></pre>"},{"location":"explanation/architecture/confidence-model/#adjust-signal-weights","title":"Adjust signal weights","text":"<pre><code>stitching:\n  confidence:\n    signals:\n      normalized_match: 0.95  # Increase from 0.9\n</code></pre>"},{"location":"explanation/architecture/confidence-model/#reduce-penalty-severity","title":"Reduce penalty severity","text":"<pre><code>stitching:\n  confidence:\n    penalties:\n      short_token: 0.7  # Less harsh than 0.5\n</code></pre>"},{"location":"explanation/architecture/confidence-model/#dont-penalize-specific-tokens","title":"Don't penalize specific tokens","text":"<pre><code>stitching:\n  min_token_length: 2  # Allow 2-char tokens\n</code></pre>"},{"location":"explanation/architecture/confidence-model/#threshold-guidelines","title":"Threshold Guidelines","text":"Threshold Use Case 0.3 Discovery mode \u2014 find all possible links 0.5 Balanced (default) 0.7 Conservative \u2014 high precision 0.9 Very strict \u2014 only obvious matches"},{"location":"explanation/architecture/confidence-model/#the-tradeoff","title":"The Tradeoff","text":"<pre><code>Lower threshold \u2192 More matches \u2192 More false positives\nHigher threshold \u2192 Fewer matches \u2192 More false negatives\n</code></pre> <p>Jnkn's philosophy: False positives are worse than false negatives. A developer investigating a bogus alert wastes time. Missing a dependency is caught during testing or review.</p>"},{"location":"explanation/architecture/confidence-model/#inspecting-confidence","title":"Inspecting Confidence","text":"<pre><code>jnkn explain env:DB_HOST infra:db_host\n</code></pre> <p>Shows full breakdown of signals and penalties.</p>"},{"location":"explanation/architecture/graph-algorithms/","title":"Graph Algorithms","text":"<p>Traversal and pathfinding.</p>"},{"location":"explanation/architecture/overview/","title":"Architecture Overview","text":"<p>Jnkn's architecture in one page.</p>"},{"location":"explanation/architecture/overview/#system-diagram","title":"System Diagram","text":"<pre><code>graph TB\n    subgraph Input\n        F[Source Files]\n        C[Config]\n    end\n\n    subgraph \"Parsing Layer\"\n        PE[Parser Engine]\n        PP[Python Parser]\n        PT[Terraform Parser]\n        PK[K8s Parser]\n    end\n\n    subgraph \"Graph Layer\"\n        G[(Dependency&lt;br/&gt;Graph)]\n        S[Storage&lt;br/&gt;SQLite]\n    end\n\n    subgraph \"Stitching Layer\"\n        SE[Stitching Engine]\n        M[Matchers]\n        R[Rules]\n        CC[Confidence&lt;br/&gt;Calculator]\n    end\n\n    subgraph \"Analysis Layer\"\n        BR[Blast Radius]\n        EX[Explainer]\n        DF[Differ]\n    end\n\n    subgraph Output\n        CLI[CLI]\n        JSON[JSON]\n        SARIF[SARIF]\n    end\n\n    F --&gt; PE\n    C --&gt; PE\n    PE --&gt; PP &amp; PT &amp; PK\n    PP &amp; PT &amp; PK --&gt; G\n    G &lt;--&gt; S\n    G --&gt; SE\n    SE --&gt; M &amp; R\n    M --&gt; CC\n    R --&gt; CC\n    CC --&gt; G\n    G --&gt; BR &amp; EX &amp; DF\n    BR &amp; EX &amp; DF --&gt; CLI &amp; JSON &amp; SARIF</code></pre>"},{"location":"explanation/architecture/overview/#components","title":"Components","text":""},{"location":"explanation/architecture/overview/#parsing-layer","title":"Parsing Layer","text":"<p>Responsibility: Convert source files into nodes and edges.</p> <ul> <li>Parser Engine \u2014 Orchestrates file discovery and parser dispatch</li> <li>Language Parsers \u2014 Extract patterns from specific languages</li> <li>Extractors \u2014 Detect specific code patterns (e.g., <code>os.getenv</code>)</li> </ul>"},{"location":"explanation/architecture/overview/#graph-layer","title":"Graph Layer","text":"<p>Responsibility: Store and query the dependency graph.</p> <ul> <li>Dependency Graph \u2014 In-memory NetworkX graph for traversal</li> <li>Storage \u2014 SQLite for persistence and incremental updates</li> </ul>"},{"location":"explanation/architecture/overview/#stitching-layer","title":"Stitching Layer","text":"<p>Responsibility: Create cross-domain edges.</p> <ul> <li>Stitching Engine \u2014 Evaluates all node pairs against rules</li> <li>Matchers \u2014 Compute similarity between artifact names</li> <li>Rules \u2014 Define which node types can be linked</li> <li>Confidence Calculator \u2014 Score match quality</li> </ul>"},{"location":"explanation/architecture/overview/#analysis-layer","title":"Analysis Layer","text":"<p>Responsibility: Answer questions about the graph.</p> <ul> <li>Blast Radius \u2014 BFS traversal to find downstream impact</li> <li>Explainer \u2014 Show why matches were made/rejected</li> <li>Differ \u2014 Compare graphs across git refs</li> </ul>"},{"location":"explanation/architecture/overview/#data-flow","title":"Data Flow","text":""},{"location":"explanation/architecture/overview/#scan","title":"Scan","text":"<pre><code>Files \u2192 Parsers \u2192 Nodes/Edges \u2192 Graph \u2192 Stitching \u2192 Cross-Domain Edges \u2192 Storage\n</code></pre>"},{"location":"explanation/architecture/overview/#query","title":"Query","text":"<pre><code>User Query \u2192 Graph Load \u2192 Traversal \u2192 Results \u2192 Output Format\n</code></pre>"},{"location":"explanation/architecture/overview/#key-design-principles","title":"Key Design Principles","text":"<ol> <li>Incremental by default \u2014 Only re-scan changed files</li> <li>Explainable \u2014 Every match can be explained</li> <li>Configurable \u2014 Thresholds and rules are tunable</li> <li>Extensible \u2014 Add new parsers/rules without core changes</li> <li>Fast \u2014 SQLite + in-memory graph for speed</li> </ol>"},{"location":"explanation/architecture/overview/#technology-choices","title":"Technology Choices","text":"Component Technology Rationale Parsing Tree-sitter Language-agnostic, accurate AST Graph NetworkX Rich algorithms, Python-native Storage SQLite Zero-config, portable, fast CLI Click Standard for Python CLIs Config YAML Human-readable, version-controllable"},{"location":"explanation/architecture/parsing-pipeline/","title":"Parsing Pipeline","text":"<p>How source files become nodes and edges.</p>"},{"location":"explanation/architecture/parsing-pipeline/#pipeline-stages","title":"Pipeline Stages","text":"<pre><code>graph LR\n    F[File] --&gt; D{Discover}\n    D --&gt; R[Read]\n    R --&gt; P[Parse AST]\n    P --&gt; E[Extract]\n    E --&gt; N[Nodes]\n    E --&gt; Ed[Edges]</code></pre>"},{"location":"explanation/architecture/parsing-pipeline/#stage-1-discovery","title":"Stage 1: Discovery","text":"<p>The parser engine discovers files to scan:</p> <pre><code># Pseudocode\nfor file in walk_directory(root):\n    if not ignored(file) and supported_extension(file):\n        yield file\n</code></pre> <p>Filters applied: - <code>.jnknignore</code> patterns - Built-in ignores (<code>.git</code>, <code>node_modules</code>, etc.) - File extension whitelist</p>"},{"location":"explanation/architecture/parsing-pipeline/#stage-2-read-hash","title":"Stage 2: Read &amp; Hash","text":"<p>Files are read and hashed for incremental scanning:</p> <pre><code>content = file.read_bytes()\nhash = xxhash.xxh64(content).hexdigest()\n\nif hash == stored_hash:\n    skip()  # File unchanged\n</code></pre>"},{"location":"explanation/architecture/parsing-pipeline/#stage-3-parse-ast","title":"Stage 3: Parse AST","text":"<p>Tree-sitter parses the file into an Abstract Syntax Tree:</p> <pre><code>parser = get_parser(\"python\")\ntree = parser.parse(content)\n</code></pre> <p>The AST represents code structure:</p> <pre><code>(module\n  (expression_statement\n    (assignment\n      left: (identifier)  # DATABASE_URL\n      right: (call\n        function: (attribute\n          object: (identifier)   # os\n          attribute: (identifier))  # getenv\n        arguments: (argument_list\n          (string))))))  # \"DATABASE_URL\"\n</code></pre>"},{"location":"explanation/architecture/parsing-pipeline/#stage-4-extract","title":"Stage 4: Extract","text":"<p>Extractors run tree-sitter queries to find patterns:</p> <pre><code>query = language.query(\"\"\"\n(call\n  function: (attribute\n    object: (identifier) @obj\n    attribute: (identifier) @method)\n  arguments: (argument_list (string) @env_var)\n  (#eq? @obj \"os\")\n  (#eq? @method \"getenv\"))\n\"\"\")\n\nfor match in query.captures(tree.root_node):\n    yield EnvVar(name=match.text)\n</code></pre> <p>Extractors run in priority order: 1. StdlibExtractor (100) \u2014 <code>os.getenv</code>, <code>os.environ</code> 2. PydanticExtractor (90) \u2014 BaseSettings 3. ClickTyperExtractor (80) \u2014 <code>envvar=</code> 4. HeuristicExtractor (10) \u2014 Fallback patterns</p>"},{"location":"explanation/architecture/parsing-pipeline/#stage-5-yield-nodes-edges","title":"Stage 5: Yield Nodes &amp; Edges","text":"<p>Extractors yield graph elements:</p> <pre><code># Node: The env var itself\nyield Node(\n    id=\"env:DATABASE_URL\",\n    type=NodeType.ENV_VAR,\n    metadata={\"line\": 10}\n)\n\n# Edge: File reads this env var\nyield Edge(\n    source=\"file://src/config.py\",\n    target=\"env:DATABASE_URL\",\n    type=RelationshipType.READS\n)\n</code></pre>"},{"location":"explanation/architecture/parsing-pipeline/#complete-example","title":"Complete Example","text":"<p>Input file <code>src/config.py</code>:</p> <pre><code>import os\n\nDATABASE_URL = os.getenv(\"DATABASE_URL\")\nREDIS_HOST = os.environ.get(\"REDIS_HOST\", \"localhost\")\n</code></pre> <p>Output:</p> <pre><code>Nodes:\n  - file://src/config.py (code_file)\n  - env:DATABASE_URL (env_var)\n  - env:REDIS_HOST (env_var)\n\nEdges:\n  - file://src/config.py \u2192 env:DATABASE_URL (reads)\n  - file://src/config.py \u2192 env:REDIS_HOST (reads)\n</code></pre>"},{"location":"explanation/architecture/parsing-pipeline/#fallback-regex-parsing","title":"Fallback: Regex Parsing","text":"<p>When tree-sitter isn't available, regex patterns are used:</p> <pre><code>ENV_VAR_PATTERNS = [\n    (r'os\\.getenv\\s*\\(\\s*[\"\\']([^\"\\']+)[\"\\']', \"os.getenv\"),\n    (r'os\\.environ\\.get\\s*\\(\\s*[\"\\']([^\"\\']+)[\"\\']', \"os.environ.get\"),\n    ...\n]\n</code></pre> <p>Regex is less accurate but provides broad compatibility.</p>"},{"location":"explanation/architecture/parsing-pipeline/#adding-a-new-extractor","title":"Adding a New Extractor","text":"<ol> <li>Implement <code>BaseExtractor</code></li> <li>Define tree-sitter query or regex pattern</li> <li>Register with parser</li> <li>Extractors are automatically run in priority order</li> </ol> <p>See Custom Parsers Tutorial.</p>"},{"location":"explanation/architecture/stitching-engine/","title":"Stitching Engine","text":"<p>How cross-domain links are discovered.</p>"},{"location":"explanation/architecture/stitching-engine/#the-problem","title":"The Problem","text":"<p>After parsing, we have nodes from different domains:</p> <pre><code>Python: env:DATABASE_URL, env:REDIS_HOST\nTerraform: infra:aws_db_instance.main, infra:aws_elasticache.redis\n</code></pre> <p>These are semantically related but not explicitly connected. Stitching finds these implicit dependencies.</p>"},{"location":"explanation/architecture/stitching-engine/#how-it-works","title":"How It Works","text":"<pre><code>graph TD\n    N[All Nodes] --&gt; R{Rules Filter}\n    R --&gt; |Candidate Pairs| M[Matcher]\n    M --&gt; C[Confidence Calculator]\n    C --&gt; |Score \u2265 Threshold| E[Create Edge]\n    C --&gt; |Score &lt; Threshold| X[Reject]</code></pre>"},{"location":"explanation/architecture/stitching-engine/#stage-1-rule-filtering","title":"Stage 1: Rule Filtering","text":"<p>Rules define which node pairs to consider:</p> <pre><code>class EnvVarToInfraRule(StitchingRule):\n    source_types = {NodeType.ENV_VAR}\n    target_types = {NodeType.INFRA_RESOURCE}\n\n    def should_evaluate(self, source, target):\n        # Quick filter before expensive matching\n        return len(source.tokens) &gt; 0 and len(target.tokens) &gt; 0\n</code></pre> <p>This reduces the search space from O(n\u00b2) to relevant pairs.</p>"},{"location":"explanation/architecture/stitching-engine/#stage-2-token-extraction","title":"Stage 2: Token Extraction","text":"<p>Names are tokenized for comparison:</p> <pre><code>\"DATABASE_URL\"     \u2192 [\"database\", \"url\"]\n\"aws_db_instance\"  \u2192 [\"aws\", \"db\", \"instance\"]\n\"REDIS_HOST\"       \u2192 [\"redis\", \"host\"]\n</code></pre> <p>Tokenization rules: - Split on <code>_</code>, <code>-</code>, case changes - Lowercase everything - Remove blocked tokens (<code>id</code>, <code>key</code>, etc.) - Filter tokens shorter than <code>min_token_length</code></p>"},{"location":"explanation/architecture/stitching-engine/#stage-3-matching","title":"Stage 3: Matching","text":"<p>The matcher computes similarity:</p> <pre><code>source_tokens = {\"database\", \"url\"}\ntarget_tokens = {\"database\", \"instance\"}\n\noverlap = source_tokens &amp; target_tokens  # {\"database\"}\nscore = len(overlap) / max(len(source_tokens), len(target_tokens))\n# score = 1/2 = 0.5\n</code></pre> <p>Match types:</p> Type Condition Base Score Exact Normalized names equal 1.0 Normalized Lowercased names equal 0.9 High Overlap &gt;80% token overlap 0.85 Medium Overlap 50-80% overlap 0.7 Suffix Names end the same 0.6 Contains One name contains the other 0.5"},{"location":"explanation/architecture/stitching-engine/#stage-4-confidence-calculation","title":"Stage 4: Confidence Calculation","text":"<p>Penalties adjust the base score:</p> <pre><code>base_score = 0.85  # High token overlap\n\npenalties = [\n    0.5 if any(len(t) &lt; 4 for t in matched_tokens) else 1.0,  # Short token\n    0.7 if matched_only_common_tokens else 1.0,  # Common tokens\n]\n\nfinal_score = base_score * product(penalties)\n# 0.85 * 0.5 = 0.425\n</code></pre>"},{"location":"explanation/architecture/stitching-engine/#stage-5-edge-creation","title":"Stage 5: Edge Creation","text":"<p>If confidence \u2265 threshold, create an edge:</p> <pre><code>if confidence.score &gt;= min_confidence:\n    graph.add_edge(\n        source=source.id,\n        target=target.id,\n        type=RelationshipType.REFERENCES,\n        metadata={\n            \"rule\": rule.name,\n            \"confidence\": confidence.score,\n            \"matched_tokens\": matched_tokens,\n        }\n    )\n</code></pre>"},{"location":"explanation/architecture/stitching-engine/#example-walkthrough","title":"Example Walkthrough","text":"<p>Input: - <code>env:DATABASE_URL</code> (from Python) - <code>infra:output.database_url</code> (from Terraform)</p> <p>Step 1: Rule check - EnvVarToInfraRule matches (env_var \u2192 infra_resource)</p> <p>Step 2: Tokenize - Source: <code>[\"database\", \"url\"]</code> - Target: <code>[\"database\", \"url\"]</code></p> <p>Step 3: Match - Overlap: <code>{\"database\", \"url\"}</code> = 100% - Type: Normalized match (names equal after normalization)</p> <p>Step 4: Confidence - Base: 0.9 (normalized match) - Penalties: none - Final: 0.9 (HIGH)</p> <p>Step 5: Create edge - <code>env:DATABASE_URL \u2192 infra:output.database_url</code> (confidence: 0.9)</p>"},{"location":"explanation/architecture/stitching-engine/#performance","title":"Performance","text":"<p>Stitching is O(n \u00d7 m) where n and m are node counts per type. Optimizations:</p> <ol> <li>Rule filtering \u2014 Only evaluate relevant pairs</li> <li>Token indexing \u2014 Hash tokens for fast lookup</li> <li>Early termination \u2014 Skip if no token overlap possible</li> <li>Batch processing \u2014 Process in chunks for large graphs</li> </ol>"},{"location":"explanation/architecture/stitching-engine/#adding-custom-rules","title":"Adding Custom Rules","text":"<p>See Custom Stitching Rules Tutorial.</p>"},{"location":"explanation/architecture/storage-model/","title":"Storage Model","text":"<p>SQLite schema and indexing.</p>"},{"location":"explanation/concepts/blast-radius/","title":"Blast Radius","text":"<p>Understanding impact analysis.</p>"},{"location":"explanation/concepts/blast-radius/#definition","title":"Definition","text":"<p>Blast radius is the set of artifacts affected by a change.</p> <p>If you modify <code>env:DATABASE_URL</code>, what else might break?</p> <pre><code>graph TD\n    E[env:DATABASE_URL]:::source --&gt; F1[connection.py]\n    E --&gt; F2[users.py]\n    E --&gt; T[aws_rds.main]\n    F1 --&gt; F3[api.py]\n\n    classDef source fill:#ff6b6b,stroke:#c92a2a</code></pre> <p>Blast radius of <code>env:DATABASE_URL</code>: 4 artifacts</p>"},{"location":"explanation/concepts/blast-radius/#how-its-calculated","title":"How It's Calculated","text":"<p>Jnkn uses Breadth-First Search (BFS) from the source node:</p> <pre><code>1. Start at source node\n2. Find all nodes with edges FROM source\n3. Add to \"impacted\" set\n4. Repeat from each impacted node\n5. Stop at max_depth (if set)\n</code></pre>"},{"location":"explanation/concepts/blast-radius/#direct-vs-transitive","title":"Direct vs. Transitive","text":"<p>Direct impact (depth 1): - <code>connection.py</code> \u2014 directly reads <code>DATABASE_URL</code> - <code>users.py</code> \u2014 directly reads <code>DATABASE_URL</code> - <code>aws_rds.main</code> \u2014 directly provides <code>DATABASE_URL</code></p> <p>Transitive impact (depth 2+): - <code>api.py</code> \u2014 imports <code>connection.py</code>, which reads <code>DATABASE_URL</code></p>"},{"location":"explanation/concepts/blast-radius/#interpreting-results","title":"Interpreting Results","text":"<pre><code>{\n  \"source_artifacts\": [\"env:DATABASE_URL\"],\n  \"total_impacted_count\": 4,\n  \"max_depth_reached\": 2\n}\n</code></pre>"},{"location":"explanation/concepts/blast-radius/#by-impact-size","title":"By Impact Size","text":"Impact Risk Level Action 1-3 Low Normal review 4-10 Medium Careful review, notify teams 10+ High Extra caution, staged rollout"},{"location":"explanation/concepts/blast-radius/#by-artifact-type","title":"By Artifact Type","text":"<pre><code>{\n  \"breakdown\": {\n    \"code\": [\"connection.py\", \"users.py\", \"api.py\"],\n    \"infra\": [\"aws_rds.main\"],\n    \"env\": [],\n    \"data\": []\n  }\n}\n</code></pre> <p>Infrastructure impact often needs more scrutiny than code impact.</p>"},{"location":"explanation/concepts/blast-radius/#limiting-depth","title":"Limiting Depth","text":"<p>For large graphs, limit traversal:</p> <pre><code># Only direct dependencies\njnkn blast env:X --max-depth 1\n\n# Up to 3 levels\njnkn blast env:X --max-depth 3\n</code></pre>"},{"location":"explanation/concepts/blast-radius/#multiple-sources","title":"Multiple Sources","text":"<p>Analyze combined impact:</p> <pre><code>jnkn blast env:DATABASE_URL env:REDIS_URL\n</code></pre> <p>Returns the union of all impacted artifacts.</p>"},{"location":"explanation/concepts/blast-radius/#use-cases","title":"Use Cases","text":""},{"location":"explanation/concepts/blast-radius/#pre-merge-review","title":"Pre-Merge Review","text":"<p>\"What does this PR affect?\"</p> <pre><code>jnkn blast file://terraform/rds.tf\n</code></pre>"},{"location":"explanation/concepts/blast-radius/#incident-response","title":"Incident Response","text":"<p>\"What could have caused this failure?\"</p> <pre><code>jnkn blast infra:aws_rds.main --reverse\n</code></pre>"},{"location":"explanation/concepts/blast-radius/#change-planning","title":"Change Planning","text":"<p>\"If we deprecate this env var, what needs updating?\"</p> <pre><code>jnkn blast env:LEGACY_API_KEY\n</code></pre>"},{"location":"explanation/concepts/blast-radius/#limitations","title":"Limitations","text":"<p>Blast radius shows potential impact, not guaranteed breakage:</p> <ul> <li>A code file might read an env var but handle missing values gracefully</li> <li>Infrastructure might be referenced but not actively used</li> <li>Some dependencies may be optional</li> </ul> <p>Use blast radius as a signal for investigation, not absolute truth.</p>"},{"location":"explanation/concepts/confidence-levels/","title":"Confidence Levels","text":"<p>Understanding HIGH, MEDIUM, and LOW.</p>"},{"location":"explanation/concepts/cross-domain-deps/","title":"Cross-Domain Dependencies","text":"<p>The \"glue\" problem Jnkn solves.</p>"},{"location":"explanation/concepts/cross-domain-deps/#the-problem","title":"The Problem","text":"<p>Modern systems span multiple domains:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Python    \u2502     \u2502  Terraform  \u2502     \u2502 Kubernetes  \u2502\n\u2502   Service   \u2502     \u2502   Infra     \u2502     \u2502  Manifests  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                   \u2502                   \u2502\n       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2502\n                    ??? Dependencies ???\n</code></pre> <p>Each domain has its own tools:</p> Domain Tools Blind Spot Python pytest, mypy Doesn't know about infra Terraform terraform plan Doesn't know what code uses resources Kubernetes kubectl, helm Doesn't know what secrets code expects <p>No tool checks across domains.</p>"},{"location":"explanation/concepts/cross-domain-deps/#real-world-scenarios","title":"Real-World Scenarios","text":""},{"location":"explanation/concepts/cross-domain-deps/#scenario-1-renamed-variable","title":"Scenario 1: Renamed Variable","text":"<pre><code># Before\noutput \"db_host\" { value = aws_rds.main.endpoint }\n\n# After (renamed)\noutput \"database_host\" { value = aws_rds.main.endpoint }\n</code></pre> <pre><code># This will break!\nDB_HOST = os.getenv(\"DB_HOST\")  # Still expects old name\n</code></pre> <p>Terraform plan: \u2705 Success Python tests: \u2705 Success (mocked) Production: \ud83d\udca5 Crash</p>"},{"location":"explanation/concepts/cross-domain-deps/#scenario-2-deleted-secret","title":"Scenario 2: Deleted Secret","text":"<pre><code># Removed from Kubernetes\n# apiVersion: v1\n# kind: Secret\n# metadata:\n#   name: api-credentials\n</code></pre> <pre><code># Still expects the secret\nAPI_KEY = os.environ[\"API_KEY\"]  # KeyError in production\n</code></pre>"},{"location":"explanation/concepts/cross-domain-deps/#scenario-3-schema-change","title":"Scenario 3: Schema Change","text":"<pre><code>-- dbt model change\n-- Renamed column: user_id \u2192 customer_id\n</code></pre> <pre><code># API still queries old column\nquery = \"SELECT user_id FROM fct_orders\"  # Column doesn't exist\n</code></pre>"},{"location":"explanation/concepts/cross-domain-deps/#why-this-happens","title":"Why This Happens","text":"<ol> <li>No explicit links \u2014 Code references env vars by string, not by import</li> <li>Convention-based \u2014 <code>DATABASE_URL</code> in code is expected to match infra output</li> <li>Different ownership \u2014 Platform team manages infra, app team manages code</li> <li>Async changes \u2014 Changes merged at different times</li> </ol>"},{"location":"explanation/concepts/cross-domain-deps/#how-jnkn-helps","title":"How Jnkn Helps","text":"<p>Jnkn creates implicit links based on naming:</p> <pre><code>graph LR\n    subgraph Python\n        E[env:DATABASE_URL]\n    end\n\n    subgraph Terraform\n        T[output.database_url]\n    end\n\n    E -.-&gt;|\"token match&lt;br/&gt;0.92 confidence\"| T</code></pre> <p>Now when you run:</p> <pre><code>jnkn blast infra:output.database_url\n</code></pre> <p>You see:</p> <pre><code>Impacted: env:DATABASE_URL, file://src/config.py\n</code></pre>"},{"location":"explanation/concepts/cross-domain-deps/#the-stitching-process","title":"The Stitching Process","text":"<pre><code>graph TD\n    P[Parse All Files] --&gt; N[Extract Nodes]\n    N --&gt; T[Tokenize Names]\n    T --&gt; M[Match Tokens]\n    M --&gt; C[Calculate Confidence]\n    C --&gt; E[Create Edges]</code></pre> <ol> <li>Parse \u2014 Find all env vars, resources, etc.</li> <li>Tokenize \u2014 <code>DATABASE_URL</code> \u2192 <code>[database, url]</code></li> <li>Match \u2014 Find nodes with overlapping tokens</li> <li>Score \u2014 Calculate match confidence</li> <li>Link \u2014 Create edges above threshold</li> </ol>"},{"location":"explanation/concepts/cross-domain-deps/#limitations","title":"Limitations","text":"<p>Jnkn uses lexical matching, not semantic understanding:</p> Can Detect Cannot Detect <code>DB_HOST</code> \u2194 <code>db_host</code> IAM role \u2192 S3 permission <code>REDIS_URL</code> \u2194 <code>redis_cluster</code> Table size \u2192 IOPS limit Name-based connections Behavioral dependencies <p>For semantic understanding, you need runtime observability or explicit documentation.</p>"},{"location":"explanation/concepts/cross-domain-deps/#best-practices","title":"Best Practices","text":"<ol> <li>Use consistent naming \u2014 <code>DATABASE_URL</code> everywhere, not <code>DB_URL</code> in one place</li> <li>Run Jnkn in CI \u2014 Catch cross-domain breaks before merge</li> <li>Review high-impact changes \u2014 Pay attention to blast radius</li> <li>Document exceptions \u2014 Suppress known false positives with reasons</li> </ol>"},{"location":"explanation/concepts/dependency-graph/","title":"Dependency Graph","text":"<p>The core data structure of Jnkn.</p>"},{"location":"explanation/concepts/dependency-graph/#what-is-it","title":"What Is It?","text":"<p>A dependency graph is a directed graph where:</p> <ul> <li>Nodes are artifacts (files, env vars, infrastructure)</li> <li>Edges are dependencies between artifacts</li> </ul> <pre><code>graph LR\n    F[config.py] --&gt; E[env:DATABASE_URL]\n    E --&gt; T[aws_db_instance.main]\n    F --&gt; R[env:REDIS_HOST]\n    R --&gt; C[aws_elasticache.redis]</code></pre>"},{"location":"explanation/concepts/dependency-graph/#nodes","title":"Nodes","text":"<p>Each node represents an artifact in your system:</p> <pre><code>{\n  \"id\": \"env:DATABASE_URL\",\n  \"name\": \"DATABASE_URL\",\n  \"type\": \"env_var\",\n  \"metadata\": {\n    \"source\": \"os.getenv\",\n    \"file\": \"src/config.py\",\n    \"line\": 10\n  }\n}\n</code></pre>"},{"location":"explanation/concepts/dependency-graph/#node-types","title":"Node Types","text":"Type Represents Example ID <code>code_file</code> Source file <code>file://src/app.py</code> <code>code_entity</code> Function/class <code>entity:src/app.py:main</code> <code>env_var</code> Environment variable <code>env:DATABASE_URL</code> <code>infra_resource</code> Terraform resource <code>infra:aws_rds.main</code> <code>k8s_resource</code> Kubernetes resource <code>k8s:default/deployment/api</code> <code>data_asset</code> dbt model <code>data:fct_orders</code>"},{"location":"explanation/concepts/dependency-graph/#edges","title":"Edges","text":"<p>Edges represent dependencies:</p> <pre><code>{\n  \"source\": \"file://src/config.py\",\n  \"target\": \"env:DATABASE_URL\",\n  \"type\": \"reads\",\n  \"metadata\": {\n    \"pattern\": \"os.getenv\",\n    \"line\": 10\n  }\n}\n</code></pre>"},{"location":"explanation/concepts/dependency-graph/#edge-types","title":"Edge Types","text":"Type Meaning Example <code>reads</code> Source reads from target File reads env var <code>imports</code> Source imports target Python import <code>provides</code> Source provides target Terraform outputs value <code>configures</code> Source configures target K8s uses ServiceAccount <code>contains</code> Source contains target File contains function <code>references</code> Generic reference Cross-domain link"},{"location":"explanation/concepts/dependency-graph/#graph-properties","title":"Graph Properties","text":"<p>Directed \u2014 Edges have direction. <code>A \u2192 B</code> means \"A depends on B.\"</p> <p>Mostly Acyclic \u2014 Well-designed systems don't have circular dependencies.</p> <p>Multi-Domain \u2014 Nodes span different technology domains (Python, Terraform, K8s).</p>"},{"location":"explanation/concepts/dependency-graph/#querying-the-graph","title":"Querying the Graph","text":""},{"location":"explanation/concepts/dependency-graph/#find-dependencies","title":"Find Dependencies","text":"<p>\"What does X depend on?\"</p> <pre><code>jnkn blast env:DATABASE_URL\n</code></pre>"},{"location":"explanation/concepts/dependency-graph/#view-statistics","title":"View Statistics","text":"<pre><code>jnkn stats\n</code></pre>"},{"location":"explanation/concepts/dependency-graph/#storage","title":"Storage","text":"<p>The graph is stored in SQLite at <code>.jnkn/jnkn.db</code>.</p>"},{"location":"explanation/concepts/dependency-graph/#why-a-graph","title":"Why a Graph?","text":"<p>Graphs enable:</p> <ol> <li>Traversal \u2014 Follow dependencies to any depth</li> <li>Visualization \u2014 See system structure  </li> <li>Algorithms \u2014 Shortest path, cycle detection</li> <li>Incremental updates \u2014 Add/remove nodes efficiently</li> </ol>"},{"location":"explanation/concepts/tokens-and-matching/","title":"Token Matching","text":"<p>Fuzzy matching logic.</p>"},{"location":"explanation/design-decisions/extensibility-model/","title":"Extensibility","text":"<p>Plugin architecture.</p>"},{"location":"explanation/design-decisions/false-positive-tradeoffs/","title":"Precision vs Recall","text":"<p>Philosophy on false positives.</p>"},{"location":"explanation/design-decisions/why-sqlite/","title":"Why SQLite?","text":"<p>Storage strategy.</p>"},{"location":"explanation/design-decisions/why-token-matching/","title":"Why Token Matching","text":"<p>Rationale for our cross-domain linking strategy.</p>"},{"location":"explanation/design-decisions/why-token-matching/#the-problem","title":"The Problem","text":"<p>How do you know <code>env:DATABASE_URL</code> in Python relates to <code>output.database_url</code> in Terraform?</p> <p>There's no explicit link \u2014 it's a convention.</p>"},{"location":"explanation/design-decisions/why-token-matching/#the-alternatives","title":"The Alternatives","text":"Approach Accuracy Effort Coverage Manual annotation Perfect High Limited Semantic analysis High Very high Limited Token matching Good Low Broad"},{"location":"explanation/design-decisions/why-token-matching/#why-not-manual-annotation","title":"Why Not Manual Annotation?","text":"<pre><code># Manual mapping file\nlinks:\n  - source: env:DATABASE_URL\n    target: infra:output.database_url\n  - source: env:REDIS_HOST\n    target: infra:output.redis_endpoint\n</code></pre> <p>Problems:</p> <ol> <li>Doesn't scale \u2014 Hundreds of env vars \u00d7 resources</li> <li>Gets stale \u2014 New vars aren't added</li> <li>Human error \u2014 Typos, missed entries</li> <li>Defeats the purpose \u2014 If you tracked it manually, you wouldn't need Jnkn</li> </ol>"},{"location":"explanation/design-decisions/why-token-matching/#why-not-semantic-analysis","title":"Why Not Semantic Analysis?","text":"<p>Semantic analysis would understand that: - <code>aws_rds_instance</code> provides a database - <code>DATABASE_URL</code> is a database connection string - Therefore, they're related</p> <p>Problems:</p> <ol> <li>Requires domain knowledge \u2014 What does <code>aws_elasticache</code> provide?</li> <li>Computationally expensive \u2014 Need embeddings, inference</li> <li>Brittle \u2014 Custom resources, unusual naming</li> <li>Overkill \u2014 Names usually tell you what you need</li> </ol>"},{"location":"explanation/design-decisions/why-token-matching/#why-token-matching-works","title":"Why Token Matching Works","text":"<p>In practice, teams use consistent naming:</p> <pre><code>Python:          DATABASE_URL\nTerraform:       output.database_url\nKubernetes:      secret.database-url\nConfig file:     database_url\n\nTokens: [database, url] \u2014 identical!\n</code></pre> <p>Token matching exploits this convention.</p>"},{"location":"explanation/design-decisions/why-token-matching/#how-it-works","title":"How It Works","text":""},{"location":"explanation/design-decisions/why-token-matching/#step-1-tokenize","title":"Step 1: Tokenize","text":"<p>Split names on separators and case boundaries:</p> <pre><code>DATABASE_URL     \u2192 [database, url]\ndatabaseUrl      \u2192 [database, url]  \ndatabase-url     \u2192 [database, url]\nPAYMENT_DB_HOST  \u2192 [payment, db, host]\n</code></pre>"},{"location":"explanation/design-decisions/why-token-matching/#step-2-normalize","title":"Step 2: Normalize","text":"<p>Lowercase, remove noise:</p> <pre><code>DATABASE_URL \u2192 [database, url]\nDataBase_URL \u2192 [database, url]\n</code></pre>"},{"location":"explanation/design-decisions/why-token-matching/#step-3-compare","title":"Step 3: Compare","text":"<p>Calculate overlap:</p> <pre><code>Source: [database, url]\nTarget: [database, url]\nOverlap: 100% \u2192 High confidence\n</code></pre>"},{"location":"explanation/design-decisions/why-token-matching/#step-4-score","title":"Step 4: Score","text":"<p>Apply penalties for weak matches:</p> <pre><code>Source: [db, host]\nTarget: [db, host]\nOverlap: 100%\nPenalty: short tokens (db=2 chars)\nFinal: Medium confidence\n</code></pre>"},{"location":"explanation/design-decisions/why-token-matching/#when-it-works-well","title":"When It Works Well","text":"<p>\u2705 Consistent naming \u2014 Teams follow conventions \u2705 Descriptive names \u2014 <code>PAYMENT_DATABASE_HOST</code> not <code>PDH</code> \u2705 Similar patterns \u2014 <code>*_URL</code>, <code>*_HOST</code>, <code>*_KEY</code> </p>"},{"location":"explanation/design-decisions/why-token-matching/#when-it-struggles","title":"When It Struggles","text":"<p>\u274c Abbreviations \u2014 <code>DB</code> doesn't match <code>database</code> \u274c Generic names \u2014 <code>HOST</code> matches everything \u274c Different conventions \u2014 <code>camelCase</code> vs <code>SCREAMING_SNAKE</code> </p> <p>We mitigate with: - Blocked tokens (<code>id</code>, <code>key</code>, etc.) - Confidence thresholds - Suppressions for known false positives</p>"},{"location":"explanation/design-decisions/why-token-matching/#the-tradeoff","title":"The Tradeoff","text":"<p>Token matching is heuristic, not perfect.</p> <pre><code>Precision: ~85-95% (with tuning)\nRecall: ~70-85%\n</code></pre> <p>This is acceptable because:</p> <ol> <li>False positives are visible \u2014 Developers review and suppress</li> <li>False negatives surface elsewhere \u2014 Tests, prod errors</li> <li>The alternative is nothing \u2014 No other tool catches this</li> </ol>"},{"location":"explanation/design-decisions/why-token-matching/#improving-accuracy","title":"Improving Accuracy","text":""},{"location":"explanation/design-decisions/why-token-matching/#organization-level","title":"Organization-Level","text":"<ul> <li>Enforce naming conventions</li> <li>Document env var \u2192 resource mappings</li> <li>Run Jnkn in CI to catch drift</li> </ul>"},{"location":"explanation/design-decisions/why-token-matching/#jnkn-level","title":"Jnkn-Level","text":"<ul> <li>Tune confidence thresholds</li> <li>Add suppressions for known issues</li> <li>Custom rules for domain-specific patterns</li> </ul>"},{"location":"explanation/design-decisions/why-tree-sitter/","title":"Why Tree-Sitter","text":"<p>Rationale for our parsing technology choice.</p>"},{"location":"explanation/design-decisions/why-tree-sitter/#the-alternatives","title":"The Alternatives","text":"Approach Pros Cons Regex Simple, fast Misses context, false positives AST libraries Accurate Language-specific, slow Tree-sitter Accurate, fast, universal Learning curve"},{"location":"explanation/design-decisions/why-tree-sitter/#why-not-regex","title":"Why Not Regex?","text":"<p>Regex works for simple cases:</p> <pre><code># Matches\nos.getenv(\"DATABASE_URL\")\n</code></pre> <p>But fails on edge cases:</p> <pre><code># False positive: it's in a string\ndoc = 'Use os.getenv(\"DATABASE_URL\")'\n\n# False positive: it's a comment\n# os.getenv(\"DATABASE_URL\")\n\n# False positive: different module\nimport mylib.os as os\nos.getenv(\"NOT_STDLIB\")\n\n# Misses: multiline\nos.getenv(\n    \"VALID_VAR\"\n)\n</code></pre> <p>Regex can't understand context.</p>"},{"location":"explanation/design-decisions/why-tree-sitter/#why-not-ast-libraries","title":"Why Not AST Libraries?","text":"<p>Python's <code>ast</code> module is accurate:</p> <pre><code>import ast\n\ntree = ast.parse(code)\nfor node in ast.walk(tree):\n    if isinstance(node, ast.Call):\n        # Check if it's os.getenv\n        ...\n</code></pre> <p>But:</p> <ol> <li>Language-specific \u2014 Need different code for Python, JavaScript, HCL</li> <li>Slow for large files \u2014 Full parse required</li> <li>Fragile \u2014 Syntax errors break entire parse</li> </ol>"},{"location":"explanation/design-decisions/why-tree-sitter/#why-tree-sitter_1","title":"Why Tree-Sitter","text":"<p>Tree-sitter provides:</p>"},{"location":"explanation/design-decisions/why-tree-sitter/#1-universal-query-language","title":"1. Universal Query Language","text":"<p>One query syntax works across languages:</p> <pre><code>; Python\n(call\n  function: (attribute object: (identifier) @obj)\n  (#eq? @obj \"os\"))\n\n; JavaScript (similar pattern)\n(call_expression\n  function: (member_expression object: (identifier) @obj)\n  (#eq? @obj \"process\"))\n</code></pre>"},{"location":"explanation/design-decisions/why-tree-sitter/#2-error-tolerance","title":"2. Error Tolerance","text":"<p>Tree-sitter produces partial ASTs even with syntax errors:</p> <pre><code>def broken(\n    # Missing closing paren - tree-sitter still parses the rest\n\nos.getenv(\"STILL_DETECTED\")  # \u2705 Found\n</code></pre>"},{"location":"explanation/design-decisions/why-tree-sitter/#3-incremental-parsing","title":"3. Incremental Parsing","text":"<p>Only re-parse changed regions:</p> <pre><code># Change line 50 of a 1000-line file\n# Tree-sitter: ~1ms\n# Full re-parse: ~50ms\n</code></pre>"},{"location":"explanation/design-decisions/why-tree-sitter/#4-performance","title":"4. Performance","text":"<p>Tree-sitter is written in C with efficient memory usage:</p> File Size Tree-sitter Python AST 100 lines 0.5ms 2ms 1000 lines 3ms 20ms 10000 lines 25ms 200ms"},{"location":"explanation/design-decisions/why-tree-sitter/#trade-offs","title":"Trade-offs","text":""},{"location":"explanation/design-decisions/why-tree-sitter/#learning-curve","title":"Learning Curve","text":"<p>Tree-sitter queries have unusual syntax:</p> <pre><code>(call\n  function: (attribute\n    object: (identifier) @_obj\n    attribute: (identifier) @_method)\n  arguments: (argument_list (string) @env_var)\n  (#eq? @_obj \"os\")\n  (#eq? @_method \"getenv\"))\n</code></pre> <p>We mitigate this with: - Pre-built queries for common patterns - Regex fallback when tree-sitter isn't available - Documentation and examples</p>"},{"location":"explanation/design-decisions/why-tree-sitter/#dependency","title":"Dependency","text":"<p>Tree-sitter requires native binaries. We handle this by: - Making it optional (<code>jnkn[full]</code>) - Falling back to regex when unavailable - Providing pre-built Docker images</p>"},{"location":"explanation/design-decisions/why-tree-sitter/#the-result","title":"The Result","text":"<p>Tree-sitter enables Jnkn to:</p> <ol> <li>Parse accurately \u2014 Context-aware pattern detection</li> <li>Handle errors \u2014 Graceful degradation on syntax issues</li> <li>Scale \u2014 Fast parsing for large codebases</li> <li>Extend \u2014 Same query language for new languages</li> </ol>"},{"location":"explanation/security/data-handling/","title":"Data Handling","text":"<p>Privacy and data retention.</p>"},{"location":"explanation/security/supply-chain/","title":"Supply Chain","text":"<p>Dependency security.</p>"},{"location":"explanation/security/threat-model/","title":"Threat Model","text":"<p>Security considerations for Jnkn.</p>"},{"location":"explanation/security/threat-model/#what-jnkn-does","title":"What Jnkn Does","text":"<ul> <li>Reads source files from disk</li> <li>Parses file contents into an AST</li> <li>Stores graph data in SQLite</li> <li>Outputs analysis results</li> </ul>"},{"location":"explanation/security/threat-model/#what-jnkn-does-not-do","title":"What Jnkn Does NOT Do","text":"<ul> <li>Execute code</li> <li>Make network requests</li> <li>Access credentials or secrets</li> <li>Modify source files</li> </ul>"},{"location":"explanation/security/threat-model/#trust-boundaries","title":"Trust Boundaries","text":"<pre><code>graph TD\n    subgraph Trusted\n        FS[File System]\n        DB[(SQLite DB)]\n        CLI[CLI Output]\n    end\n\n    subgraph Untrusted\n        SF[Source Files]\n        CF[Config Files]\n    end\n\n    SF --&gt; |read| FS\n    CF --&gt; |read| FS\n    FS --&gt; |parse| DB\n    DB --&gt; |query| CLI</code></pre>"},{"location":"explanation/security/threat-model/#trusted","title":"Trusted","text":"<ul> <li>File system \u2014 Jnkn assumes it can read files you point it at</li> <li>SQLite database \u2014 Jnkn controls this file</li> <li>CLI output \u2014 Results are displayed to the user</li> </ul>"},{"location":"explanation/security/threat-model/#untrusted","title":"Untrusted","text":"<ul> <li>Source files \u2014 May contain malicious patterns</li> <li>Config files \u2014 User-controlled</li> </ul>"},{"location":"explanation/security/threat-model/#threat-analysis","title":"Threat Analysis","text":""},{"location":"explanation/security/threat-model/#threat-1-malicious-source-files","title":"Threat 1: Malicious Source Files","text":"<p>Scenario: Attacker includes crafted code that exploits parser.</p> <p>Mitigation: - Tree-sitter is memory-safe (written in C with fuzzing) - Jnkn doesn't execute code, only parses - Regex patterns are bounded</p> <p>Residual risk: Low</p>"},{"location":"explanation/security/threat-model/#threat-2-config-injection","title":"Threat 2: Config Injection","text":"<p>Scenario: Attacker modifies <code>.jnkn/config.yaml</code> to load malicious code.</p> <p>Mitigation: - Extra extractors/rules must be importable Python modules - Requires write access to config file - Requires code execution environment</p> <p>Residual risk: Medium (if attacker has write access, they have larger problems)</p>"},{"location":"explanation/security/threat-model/#threat-3-information-disclosure","title":"Threat 3: Information Disclosure","text":"<p>Scenario: Jnkn output reveals sensitive information.</p> <p>Mitigation: - Jnkn only reports artifact names, not contents - No secret values are extracted - Environment variable names (not values) are detected</p> <p>Residual risk: Low (env var names are not typically secret)</p>"},{"location":"explanation/security/threat-model/#threat-4-denial-of-service","title":"Threat 4: Denial of Service","text":"<p>Scenario: Large or malformed file causes excessive resource usage.</p> <p>Mitigation: - File size limits in parsing - Timeout on tree-sitter operations - Bounded regex execution</p> <p>Residual risk: Low</p>"},{"location":"explanation/security/threat-model/#best-practices","title":"Best Practices","text":""},{"location":"explanation/security/threat-model/#cicd-usage","title":"CI/CD Usage","text":"<pre><code># Run in isolated container\n- name: Jnkn\n  uses: docker://ghcr.io/jnkn-io/jnkn:latest\n  with:\n    args: scan --dir /github/workspace\n</code></pre>"},{"location":"explanation/security/threat-model/#secret-handling","title":"Secret Handling","text":"<p>Jnkn detects env var names, not values. However:</p> <ul> <li>Don't commit <code>.jnkn/jnkn.db</code> if it might contain sensitive paths</li> <li>Use <code>.jnknignore</code> to skip sensitive directories</li> </ul>"},{"location":"explanation/security/threat-model/#dependency-security","title":"Dependency Security","text":"<p>Jnkn's dependencies are: - Scanned with Dependabot - Pinned to specific versions - Audited for known vulnerabilities</p>"},{"location":"explanation/security/threat-model/#reporting-security-issues","title":"Reporting Security Issues","text":"<p>Report vulnerabilities to: security@jnkn.io</p> <p>We follow responsible disclosure with a 90-day window.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Get Jnkn running in your project in under 10 minutes.</p>"},{"location":"getting-started/#choose-your-path","title":"Choose Your Path","text":"<ul> <li> <p> Just want to try it?</p> <p>Follow the quickstart to scan your first project.</p> <p> Quickstart</p> </li> <li> <p> Want CI integration?</p> <p>Set up GitHub Actions to check PRs automatically.</p> <p> CI Integration</p> </li> </ul>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11+</li> <li>A project with Python, Terraform, or Kubernetes files</li> </ul>"},{"location":"getting-started/#what-youll-learn","title":"What You'll Learn","text":"<ol> <li>Installation \u2014 Multiple ways to install Jnkn</li> <li>Quickstart \u2014 Scan a project and understand the output</li> <li>CI Integration \u2014 Automate impact analysis on pull requests</li> </ol>"},{"location":"getting-started/example-repository/","title":"Example Repository","text":"<p>A walkthrough of the jnkn-examples repo.</p>"},{"location":"getting-started/first-ci-integration/","title":"CI Integration","text":"<p>Add Jnkn to your CI pipeline to catch breaking changes on every PR.</p>"},{"location":"getting-started/first-ci-integration/#github-actions","title":"GitHub Actions","text":"<p>Create <code>.github/workflows/jnkn.yml</code>:</p> <pre><code>name: Jnkn Impact Analysis\n\non:\n  pull_request:\n    paths:\n      - '**.py'\n      - '**.tf'\n      - '**/dbt/**'\n\njobs:\n  analyze:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0  # Need history for diff\n\n      - name: Set up Python\n        uses: actions/setup-python@v5\n        with:\n          python-version: '3.11'\n\n      - name: Install Jnkn\n        run: pip install jnkn[full]\n\n      - name: Scan codebase\n        run: jnkn scan\n\n      - name: Analyze changed files\n        run: |\n          # Get changed files\n          CHANGED=$(git diff --name-only origin/${{ github.base_ref }}...HEAD | grep -E '\\.(py|tf)$' || true)\n\n          if [ -n \"$CHANGED\" ]; then\n            echo \"## \ud83d\udd0d Impact Analysis\" &gt;&gt; $GITHUB_STEP_SUMMARY\n            for file in $CHANGED; do\n              echo \"### $file\" &gt;&gt; $GITHUB_STEP_SUMMARY\n              jnkn blast \"file://$file\" --format markdown &gt;&gt; $GITHUB_STEP_SUMMARY 2&gt;/dev/null || true\n            done\n          fi\n</code></pre>"},{"location":"getting-started/first-ci-integration/#what-this-does","title":"What This Does","text":"<ol> <li>Triggers on PRs that modify Python or Terraform files</li> <li>Scans your codebase to build the dependency graph</li> <li>Analyzes each changed file's blast radius</li> <li>Reports results in the GitHub Actions summary</li> </ol>"},{"location":"getting-started/first-ci-integration/#example-output","title":"Example Output","text":"<p>When a PR modifies <code>terraform/rds.tf</code>:</p> <pre><code>## \ud83d\udd0d Impact Analysis\n\n### terraform/rds.tf\n\n**Blast Radius: 5 artifacts**\n\n| Type | Artifact | Confidence |\n|------|----------|------------|\n| env_var | env:DATABASE_URL | 0.92 |\n| code_file | src/db/connection.py | 0.88 |\n| code_file | src/api/users.py | 0.85 |\n</code></pre>"},{"location":"getting-started/first-ci-integration/#block-on-high-risk-changes","title":"Block on High-Risk Changes","text":"<p>Add a failure condition for high-impact changes:</p> <pre><code>- name: Check impact threshold\n  run: |\n    IMPACT=$(jnkn blast \"file://$FILE\" --format json | jq '.total_impacted')\n    if [ \"$IMPACT\" -gt 10 ]; then\n      echo \"::error::High impact change: $IMPACT artifacts affected\"\n      exit 1\n    fi\n</code></pre>"},{"location":"getting-started/first-ci-integration/#gitlab-ci","title":"GitLab CI","text":"<p>See GitLab CI Integration for GitLab-specific setup.</p>"},{"location":"getting-started/first-ci-integration/#next-steps","title":"Next Steps","text":"<ul> <li> Configure confidence thresholds</li> <li> Manage suppressions</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#recommended-pip","title":"Recommended: pip","text":"<pre><code>pip install jnkn\n</code></pre> <p>For full functionality (tree-sitter parsing, all language support):</p> <pre><code>pip install jnkn[full]\n</code></pre>"},{"location":"getting-started/installation/#alternative-methods","title":"Alternative Methods","text":"pipx (isolated)uvDockerFrom Source <pre><code>pipx install jnkn[full]\n</code></pre> <pre><code>uv tool install jnkn[full]\n</code></pre> <pre><code>docker pull ghcr.io/jnkn-io/jnkn:latest\ndocker run --rm -v $(pwd):/app jnkn scan --dir /app\n</code></pre> <pre><code>git clone https://github.com/bordumb/jnkn.git\ncd jnkn\npip install -e \".[full,dev]\"\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<pre><code>jnkn --version\n</code></pre> <p>Expected output:</p> <pre><code>jnkn 0.1.0\n</code></pre>"},{"location":"getting-started/installation/#optional-dependencies","title":"Optional Dependencies","text":"Extra What It Enables <code>full</code> Tree-sitter parsing, all language support <code>dev</code> Testing and development tools"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<p> Run your first scan</p>"},{"location":"getting-started/quickstart/","title":"Quickstart","text":"<p>Scan your first project in 5 minutes.</p>"},{"location":"getting-started/quickstart/#1-initialize","title":"1. Initialize","text":"<pre><code>cd your-project\njnkn init\n</code></pre> <p>This creates <code>.jnkn/config.yaml</code> with sensible defaults.</p>"},{"location":"getting-started/quickstart/#2-scan","title":"2. Scan","text":"<pre><code>jnkn scan\n</code></pre> <p>Output:</p> <pre><code>\ud83d\udd0d Scanning /path/to/your-project\n\ud83d\udcc1 Found 47 files (12 Python, 8 Terraform, 27 other)\n\u2705 Parsed 156 nodes, 89 edges\n\ud83e\uddf5 Stitching cross-domain dependencies...\n\u2705 Created 8 cross-domain links\n</code></pre>"},{"location":"getting-started/quickstart/#3-explore","title":"3. Explore","text":""},{"location":"getting-started/quickstart/#view-statistics","title":"View Statistics","text":"<pre><code>jnkn stats\n</code></pre> <pre><code>\ud83d\udcca Graph Statistics\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nNodes:     156\nEdges:     97\nFiles:     47\n\nBy Type:\n  code_file:       42\n  env_var:         12\n  infra_resource:  8\n</code></pre>"},{"location":"getting-started/quickstart/#calculate-blast-radius","title":"Calculate Blast Radius","text":"<pre><code>jnkn blast env:DATABASE_URL\n</code></pre> <pre><code>{\n  \"source\": \"env:DATABASE_URL\",\n  \"total_impacted\": 3,\n  \"impacted\": [\n    \"file://src/db/connection.py\",\n    \"file://src/api/users.py\",\n    \"infra:aws_db_instance.main\"\n  ]\n}\n</code></pre>"},{"location":"getting-started/quickstart/#explain-a-match","title":"Explain a Match","text":"<pre><code>jnkn explain env:DB_HOST infra:db_host\n</code></pre> <pre><code>Source: env:DB_HOST \u2192 Tokens: [db, host]\nTarget: infra:db_host \u2192 Tokens: [db, host]\n\nConfidence: 0.85 (HIGH)\n  [+0.90] normalized_match: 'dbhost' == 'dbhost'\n  [\u00d70.95] penalty: short token 'db'\n</code></pre>"},{"location":"getting-started/quickstart/#what-just-happened","title":"What Just Happened?","text":"<ol> <li>Parse: Jnkn scanned your Python and Terraform files</li> <li>Extract: Found environment variables and infrastructure resources  </li> <li>Stitch: Linked <code>env:DATABASE_URL</code> to <code>infra:aws_db_instance.main</code> via token matching</li> <li>Store: Saved the graph to <code>.jnkn/jnkn.db</code></li> </ol>"},{"location":"getting-started/quickstart/#common-issues","title":"Common Issues","text":"No env vars found <p>Jnkn looks for specific patterns. Check Supported Patterns to ensure your code matches.</p> Too many false positives <p>Lower the confidence threshold or add suppressions:</p> <pre><code>jnkn suppress add \"env:*_ID\" \"infra:*\" --reason \"ID fields are generic\"\n</code></pre>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li> Set up CI integration</li> <li> Learn about blast radius</li> <li> Configure confidence thresholds</li> </ul>"},{"location":"how-to/","title":"How-To Guides","text":"<p>Task-oriented guides for specific goals.</p>"},{"location":"how-to/#scanning","title":"Scanning","text":"<ul> <li>Scan a Monorepo \u2014 Strategies for large codebases</li> <li>Incremental Scanning \u2014 Only scan changed files</li> </ul>"},{"location":"how-to/#analysis","title":"Analysis","text":"<ul> <li>Calculate Blast Radius \u2014 Find downstream impact</li> <li>Compare Branches \u2014 Diff between git refs</li> <li>Export Results \u2014 JSON, SARIF, CSV output</li> </ul>"},{"location":"how-to/#integration","title":"Integration","text":"<ul> <li>GitHub Actions \u2014 CI setup for GitHub</li> <li>GitLab CI \u2014 CI setup for GitLab</li> </ul>"},{"location":"how-to/#configuration","title":"Configuration","text":"<ul> <li>Configure Confidence \u2014 Tune thresholds</li> <li>Manage Suppressions \u2014 Handle false positives</li> </ul>"},{"location":"how-to/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>No Matches Found \u2014 Debug empty results</li> <li>Too Many False Positives \u2014 Improve precision</li> </ul>"},{"location":"how-to/analysis/calculate-blast-radius/","title":"Calculate Blast Radius","text":"<p>Find all artifacts impacted by a change.</p>"},{"location":"how-to/analysis/calculate-blast-radius/#basic-usage","title":"Basic Usage","text":"<pre><code>jnkn blast &lt;artifact-id&gt;\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#artifact-id-formats","title":"Artifact ID Formats","text":"Type Format Example Environment variable <code>env:NAME</code> <code>env:DATABASE_URL</code> File <code>file://path</code> <code>file://src/config.py</code> Infrastructure <code>infra:name</code> <code>infra:aws_rds.main</code> Kubernetes <code>k8s:ns/kind/name</code> <code>k8s:default/deployment/api</code> dbt model <code>data:model</code> <code>data:fct_orders</code>"},{"location":"how-to/analysis/calculate-blast-radius/#options","title":"Options","text":""},{"location":"how-to/analysis/calculate-blast-radius/#limit-depth","title":"Limit Depth","text":"<p>Only show direct dependencies:</p> <pre><code>jnkn blast env:X --max-depth 1\n</code></pre> <p>Show up to 3 levels:</p> <pre><code>jnkn blast env:X --max-depth 3\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#multiple-sources","title":"Multiple Sources","text":"<p>Analyze several artifacts at once:</p> <pre><code>jnkn blast env:DATABASE_URL env:REDIS_URL infra:aws_rds.main\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#filter-by-type","title":"Filter by Type","text":"<p>Only show infrastructure impacts:</p> <pre><code>jnkn blast env:X --type infra\n</code></pre> <p>Only show code files:</p> <pre><code>jnkn blast env:X --type code\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#output-formats","title":"Output Formats","text":"JSON (default)MarkdownPlainSARIF <pre><code>jnkn blast env:X --format json\n</code></pre> <pre><code>jnkn blast env:X --format markdown\n</code></pre> <pre><code>jnkn blast env:X --format plain\n</code></pre> <pre><code>jnkn blast env:X --format sarif &gt; results.sarif\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#scripting","title":"Scripting","text":""},{"location":"how-to/analysis/calculate-blast-radius/#check-impact-count","title":"Check Impact Count","text":"<pre><code>IMPACT=$(jnkn blast env:X --format json | jq '.total_impacted_count')\n\nif [ \"$IMPACT\" -gt 10 ]; then\n    echo \"High impact: $IMPACT artifacts\"\n    exit 1\nfi\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#get-impacted-files-only","title":"Get Impacted Files Only","text":"<pre><code>jnkn blast env:X --format json | jq -r '.impacted_artifacts[]' | grep '^file://'\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#pipe-to-other-tools","title":"Pipe to Other Tools","text":"<pre><code># Send to Slack\njnkn blast env:X --format markdown | slack-cli post \"#alerts\"\n\n# Create Jira ticket\njnkn blast env:X --format json | jira-create-ticket.sh\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#understanding-results","title":"Understanding Results","text":"<pre><code>{\n  \"source_artifacts\": [\"env:DATABASE_URL\"],\n  \"total_impacted_count\": 5,\n  \"impacted_artifacts\": [\n    \"file://src/db/connection.py\",\n    \"file://src/api/users.py\",\n    \"infra:aws_db_instance.main\"\n  ],\n  \"breakdown\": {\n    \"code\": [\"file://src/db/connection.py\", \"file://src/api/users.py\"],\n    \"infra\": [\"infra:aws_db_instance.main\"],\n    \"env\": [],\n    \"data\": []\n  },\n  \"max_depth_reached\": 2\n}\n</code></pre> <ul> <li><code>total_impacted_count</code>: Total number of affected artifacts</li> <li><code>impacted_artifacts</code>: Full list of affected artifact IDs</li> <li><code>breakdown</code>: Grouped by artifact type</li> <li><code>max_depth_reached</code>: How many hops the deepest impact is</li> </ul>"},{"location":"how-to/analysis/calculate-blast-radius/#troubleshooting","title":"Troubleshooting","text":""},{"location":"how-to/analysis/calculate-blast-radius/#artifact-not-found","title":"\"Artifact not found\"","text":"<p>The artifact ID may not exist in the graph. Check with:</p> <pre><code>jnkn stats --show-nodes | grep \"DATABASE_URL\"\n</code></pre>"},{"location":"how-to/analysis/calculate-blast-radius/#results-seem-incomplete","title":"Results seem incomplete","text":"<p>Ensure you've scanned all relevant directories:</p> <pre><code>jnkn scan --dir . --full\n</code></pre>"},{"location":"how-to/analysis/compare-branches/","title":"Compare Branches","text":"<p>Analyze dependency changes between git refs.</p>"},{"location":"how-to/analysis/compare-branches/#basic-usage","title":"Basic Usage","text":"<pre><code>jnkn diff main..feature-branch\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#how-it-works","title":"How It Works","text":"<ol> <li>Checks out base ref, scans to temporary database</li> <li>Checks out target ref, scans to another database</li> <li>Compares graphs and reports differences</li> </ol>"},{"location":"how-to/analysis/compare-branches/#output","title":"Output","text":"<pre><code>{\n  \"added_nodes\": [\n    {\"id\": \"env:NEW_VAR\", \"type\": \"env_var\"}\n  ],\n  \"removed_nodes\": [\n    {\"id\": \"env:OLD_VAR\", \"type\": \"env_var\"}\n  ],\n  \"added_edges\": [\n    {\"source\": \"file://src/new.py\", \"target\": \"env:NEW_VAR\"}\n  ],\n  \"removed_edges\": [\n    {\"source\": \"file://src/old.py\", \"target\": \"env:OLD_VAR\"}\n  ],\n  \"summary\": {\n    \"nodes_added\": 1,\n    \"nodes_removed\": 1,\n    \"edges_added\": 1,\n    \"edges_removed\": 1\n  }\n}\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#compare-with-working-directory","title":"Compare with Working Directory","text":"<p>Compare current state against a branch:</p> <pre><code>jnkn diff main\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#ci-integration","title":"CI Integration","text":"<pre><code>- name: Compare with main\n  run: |\n    DIFF=$(jnkn diff origin/main --format json)\n    ADDED=$(echo \"$DIFF\" | jq '.summary.nodes_added')\n    REMOVED=$(echo \"$DIFF\" | jq '.summary.nodes_removed')\n\n    echo \"Added $ADDED nodes, removed $REMOVED nodes\"\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#focus-on-specific-changes","title":"Focus on Specific Changes","text":""},{"location":"how-to/analysis/compare-branches/#new-dependencies-only","title":"New Dependencies Only","text":"<pre><code>jnkn diff main --show added\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#removed-dependencies-only","title":"Removed Dependencies Only","text":"<pre><code>jnkn diff main --show removed\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#filter-by-type","title":"Filter by Type","text":"<pre><code>jnkn diff main --type env_var\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#markdown-report","title":"Markdown Report","text":"<pre><code>jnkn diff main --format markdown\n</code></pre> <p>Output:</p> <pre><code>## Dependency Changes: main \u2192 HEAD\n\n### Added (3)\n| Type | Artifact |\n|------|----------|\n| env_var | env:NEW_API_KEY |\n| code_file | file://src/api/v2.py |\n| edge | src/api/v2.py \u2192 NEW_API_KEY |\n\n### Removed (1)\n| Type | Artifact |\n|------|----------|\n| env_var | env:DEPRECATED_VAR |\n</code></pre>"},{"location":"how-to/analysis/compare-branches/#performance","title":"Performance","text":"<p>Diff requires scanning both branches. For large repos, this can be slow.</p> <p>Tips:</p> <ul> <li>Use <code>--dir</code> to limit scope</li> <li>Cache base branch database in CI</li> <li>Run only on relevant file changes</li> </ul>"},{"location":"how-to/analysis/export-results/","title":"Export Results","text":"<p>Export Jnkn results in various formats for integration with other tools.</p>"},{"location":"how-to/analysis/export-results/#json-export","title":"JSON Export","text":"<p>Default format, suitable for scripting:</p> <pre><code>jnkn blast env:X --format json &gt; results.json\n</code></pre> <pre><code>jnkn stats --format json &gt; stats.json\n</code></pre>"},{"location":"how-to/analysis/export-results/#sarif-export","title":"SARIF Export","text":"<p>For IDE integration and GitHub Advanced Security:</p> <pre><code>jnkn blast env:X --format sarif &gt; jnkn.sarif\n</code></pre> <p>Upload to GitHub:</p> <pre><code>- name: Upload SARIF\n  uses: github/codeql-action/upload-sarif@v3\n  with:\n    sarif_file: jnkn.sarif\n</code></pre>"},{"location":"how-to/analysis/export-results/#csv-export","title":"CSV Export","text":"<p>For spreadsheet analysis:</p> <pre><code>jnkn stats --nodes --format csv &gt; nodes.csv\njnkn stats --edges --format csv &gt; edges.csv\n</code></pre>"},{"location":"how-to/analysis/export-results/#graphml-export","title":"GraphML Export","text":"<p>For visualization in tools like Gephi or yEd:</p> <pre><code>jnkn export --format graphml &gt; graph.graphml\n</code></pre>"},{"location":"how-to/analysis/export-results/#dot-export","title":"DOT Export","text":"<p>For Graphviz visualization:</p> <pre><code>jnkn export --format dot &gt; graph.dot\ndot -Tpng graph.dot -o graph.png\n</code></pre>"},{"location":"how-to/analysis/export-results/#export-full-graph","title":"Export Full Graph","text":"<p>Export all nodes and edges:</p> <pre><code>jnkn export --format json &gt; full-graph.json\n</code></pre> <p>Structure:</p> <pre><code>{\n  \"nodes\": [\n    {\"id\": \"env:DATABASE_URL\", \"type\": \"env_var\", \"metadata\": {...}},\n    ...\n  ],\n  \"edges\": [\n    {\"source\": \"file://src/app.py\", \"target\": \"env:DATABASE_URL\", \"type\": \"reads\"},\n    ...\n  ]\n}\n</code></pre>"},{"location":"how-to/analysis/export-results/#filter-exports","title":"Filter Exports","text":"<p>Export only certain types:</p> <pre><code>jnkn export --type env_var --format json &gt; env-vars.json\njnkn export --type infra --format json &gt; infrastructure.json\n</code></pre>"},{"location":"how-to/analysis/export-results/#pipe-to-other-tools","title":"Pipe to Other Tools","text":"<pre><code># Pretty print\njnkn blast env:X | jq .\n\n# Count impacted files\njnkn blast env:X | jq '.impacted_artifacts | length'\n\n# Get unique impacted types\njnkn blast env:X | jq -r '.breakdown | keys[]'\n</code></pre>"},{"location":"how-to/analysis/query-dependency-graph/","title":"Querying the Graph","text":"<p>Advanced graph traversal.</p>"},{"location":"how-to/configuration/configure-confidence/","title":"Configure Confidence","text":"<p>Tune confidence thresholds to balance precision and recall.</p>"},{"location":"how-to/configuration/configure-confidence/#understanding-confidence","title":"Understanding Confidence","text":"<p>Confidence scores range from 0.0 to 1.0:</p> Score Level Meaning 0.8 - 1.0 HIGH Very likely a real dependency 0.5 - 0.8 MEDIUM Probably related, review recommended 0.0 - 0.5 LOW Weak signal, often false positive"},{"location":"how-to/configuration/configure-confidence/#setting-the-threshold","title":"Setting the Threshold","text":"<p>In <code>.jnkn/config.yaml</code>:</p> <pre><code>stitching:\n  min_confidence: 0.5  # Default\n</code></pre> <p>Higher threshold = fewer matches, fewer false positives:</p> <pre><code>stitching:\n  min_confidence: 0.7  # More conservative\n</code></pre> <p>Lower threshold = more matches, may catch subtle dependencies:</p> <pre><code>stitching:\n  min_confidence: 0.3  # More permissive\n</code></pre>"},{"location":"how-to/configuration/configure-confidence/#per-rule-thresholds","title":"Per-Rule Thresholds","text":"<p>Different rules can have different thresholds:</p> <pre><code>stitching:\n  min_confidence: 0.5  # Default\n\n  rule_overrides:\n    EnvVarToInfraRule:\n      min_confidence: 0.6  # Stricter for env\u2192infra\n    K8sToSecretRule:\n      min_confidence: 0.4  # More permissive for K8s\n</code></pre>"},{"location":"how-to/configuration/configure-confidence/#signal-weights","title":"Signal Weights","text":"<p>Customize how confidence is calculated:</p> <pre><code>stitching:\n  confidence:\n    signals:\n      exact_match: 1.0\n      normalized_match: 0.9\n      token_overlap_high: 0.85\n      token_overlap_medium: 0.7\n      suffix_match: 0.6\n      contains: 0.5\n\n    penalties:\n      short_token: 0.5      # Tokens &lt; 4 chars\n      common_token: 0.7     # Generic words like \"url\", \"host\"\n      ambiguous: 0.8        # Multiple possible matches\n</code></pre>"},{"location":"how-to/configuration/configure-confidence/#token-configuration","title":"Token Configuration","text":""},{"location":"how-to/configuration/configure-confidence/#blocked-tokens","title":"Blocked Tokens","text":"<p>Tokens that provide no matching signal:</p> <pre><code>stitching:\n  blocked_tokens:\n    - id\n    - key\n    - url\n    - host\n    - port\n    - name\n    - value\n    - config\n</code></pre>"},{"location":"how-to/configuration/configure-confidence/#minimum-token-length","title":"Minimum Token Length","text":"<p>Ignore short tokens:</p> <pre><code>stitching:\n  min_token_length: 3  # Default\n</code></pre>"},{"location":"how-to/configuration/configure-confidence/#low-value-tokens","title":"Low-Value Tokens","text":"<p>Tokens that reduce confidence when matched:</p> <pre><code>stitching:\n  low_value_tokens:\n    - aws\n    - prod\n    - dev\n    - main\n    - test\n</code></pre>"},{"location":"how-to/configuration/configure-confidence/#finding-the-right-balance","title":"Finding the Right Balance","text":""},{"location":"how-to/configuration/configure-confidence/#start-conservative","title":"Start Conservative","text":"<pre><code>stitching:\n  min_confidence: 0.7\n</code></pre> <p>Run <code>jnkn scan</code> and check results. If you're missing real dependencies, lower the threshold.</p>"},{"location":"how-to/configuration/configure-confidence/#check-what-youre-missing","title":"Check What You're Missing","text":"<pre><code>jnkn explain env:DATABASE_URL infra:db_instance --why-not\n</code></pre> <p>If the confidence is 0.65 but the match is real, consider lowering your threshold.</p>"},{"location":"how-to/configuration/configure-confidence/#iterate","title":"Iterate","text":"<ol> <li>Scan with current settings</li> <li>Review a sample of matches</li> <li>Adjust threshold or add suppressions</li> <li>Repeat</li> </ol>"},{"location":"how-to/configuration/configure-confidence/#environment-variable-override","title":"Environment Variable Override","text":"<p>Override in CI without changing config:</p> <pre><code>JUNKAN_MIN_CONFIDENCE=0.6 jnkn scan\n</code></pre>"},{"location":"how-to/configuration/environment-variables/","title":"Environment Variables","text":"<p>Configuring Jnkn via env vars.</p>"},{"location":"how-to/configuration/ignore-files/","title":"Ignore Files","text":"<p>Using .jnknignore.</p>"},{"location":"how-to/configuration/manage-suppressions/","title":"Manage Suppressions","text":"<p>Handle false positives by suppressing incorrect matches.</p>"},{"location":"how-to/configuration/manage-suppressions/#add-a-suppression","title":"Add a Suppression","text":""},{"location":"how-to/configuration/manage-suppressions/#specific-match","title":"Specific Match","text":"<pre><code>jnkn suppress add \"env:HOST\" \"infra:ghost_writer\" \\\n  --reason \"Unrelated - ghost_writer is a logging service\"\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#pattern-match","title":"Pattern Match","text":"<p>Use globs for broader suppression:</p> <pre><code># All *_ID env vars\njnkn suppress add \"env:*_ID\" \"infra:*\" \\\n  --reason \"ID fields are too generic\"\n\n# All test infrastructure\njnkn suppress add \"*\" \"infra:test_*\" \\\n  --reason \"Test infrastructure\"\n\n# Specific prefix\njnkn suppress add \"env:LEGACY_*\" \"*\" \\\n  --reason \"Legacy vars being deprecated\"\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#list-suppressions","title":"List Suppressions","text":"<pre><code>jnkn suppress list\n</code></pre> <pre><code>ID  Source        Target         Reason                  Enabled  Expires\n1   env:HOST      infra:ghost_*  Unrelated services      yes      never\n2   env:*_ID      infra:*        ID fields too generic   yes      never\n3   *             infra:test_*   Test infrastructure     yes      2024-06-01\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#remove-a-suppression","title":"Remove a Suppression","text":"<p>By ID:</p> <pre><code>jnkn suppress remove 1\n</code></pre> <p>By pattern:</p> <pre><code>jnkn suppress remove --source \"env:*_ID\" --target \"infra:*\"\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#test-a-suppression","title":"Test a Suppression","text":"<p>Check if a match would be suppressed:</p> <pre><code>jnkn suppress test env:USER_ID infra:user_service\n</code></pre> <pre><code>\u2713 Would be SUPPRESSED by rule 2: \"env:*_ID\" \u2192 \"infra:*\"\n  Reason: ID fields too generic\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#temporary-suppressions","title":"Temporary Suppressions","text":"<p>Add an expiration date:</p> <pre><code>jnkn suppress add \"env:X\" \"infra:Y\" \\\n  --reason \"Temporary during migration\" \\\n  --expires 2024-06-01\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#enabledisable","title":"Enable/Disable","text":"<p>Disable without removing:</p> <pre><code>jnkn suppress disable 2\n</code></pre> <p>Re-enable:</p> <pre><code>jnkn suppress enable 2\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#suppressions-file","title":"Suppressions File","text":"<p>Stored in <code>.jnkn/suppressions.yaml</code>:</p> <pre><code>suppressions:\n  - id: 1\n    source_pattern: \"env:HOST\"\n    target_pattern: \"infra:ghost_*\"\n    reason: \"Unrelated services\"\n    enabled: true\n    expires: null\n    created_at: \"2024-01-15T10:30:00Z\"\n\n  - id: 2\n    source_pattern: \"env:*_ID\"\n    target_pattern: \"infra:*\"\n    reason: \"ID fields too generic\"\n    enabled: true\n    expires: null\n    created_at: \"2024-01-15T10:35:00Z\"\n</code></pre> <p>Version Control</p> <p>Commit <code>.jnkn/suppressions.yaml</code> to git so the team shares suppressions.</p>"},{"location":"how-to/configuration/manage-suppressions/#glob-patterns","title":"Glob Patterns","text":"Pattern Matches Doesn't Match <code>env:*</code> <code>env:X</code>, <code>env:DATABASE_URL</code> <code>infra:X</code> <code>env:DB_*</code> <code>env:DB_HOST</code>, <code>env:DB_PORT</code> <code>env:DATABASE</code> <code>*_URL</code> <code>env:DATABASE_URL</code>, <code>infra:api_url</code> <code>env:URL_PREFIX</code> <code>infra:aws_*</code> <code>infra:aws_rds</code>, <code>infra:aws_s3</code> <code>infra:gcp_sql</code>"},{"location":"how-to/configuration/manage-suppressions/#bulk-import","title":"Bulk Import","text":"<p>Import from JSON:</p> <pre><code>cat suppressions.json | jnkn suppress import\n</code></pre> <pre><code>[\n  {\"source\": \"env:*_ID\", \"target\": \"infra:*\", \"reason\": \"Generic\"},\n  {\"source\": \"env:HOST\", \"target\": \"infra:ghost_*\", \"reason\": \"Unrelated\"}\n]\n</code></pre>"},{"location":"how-to/configuration/manage-suppressions/#export","title":"Export","text":"<pre><code>jnkn suppress export --format json &gt; suppressions-backup.json\n</code></pre>"},{"location":"how-to/integration/azure-devops/","title":"Azure DevOps","text":"<p>Setting up Azure Pipelines.</p>"},{"location":"how-to/integration/github-actions/","title":"GitHub Actions","text":"<p>Set up Jnkn in GitHub Actions CI/CD.</p>"},{"location":"how-to/integration/github-actions/#minimal-setup","title":"Minimal Setup","text":"<pre><code>name: Jnkn\non: [pull_request]\n\njobs:\n  analyze:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-python@v5\n        with:\n          python-version: '3.11'\n      - run: pip install jnkn[full]\n      - run: jnkn scan\n      - run: jnkn stats\n</code></pre>"},{"location":"how-to/integration/github-actions/#with-pr-comments","title":"With PR Comments","text":"<pre><code>name: Jnkn Impact Analysis\non:\n  pull_request:\n    paths: ['**.py', '**.tf', '**.yaml']\n\npermissions:\n  contents: read\n  pull-requests: write\n\njobs:\n  analyze:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - uses: actions/setup-python@v5\n        with:\n          python-version: '3.11'\n          cache: 'pip'\n\n      - run: pip install jnkn[full]\n\n      - name: Scan and analyze\n        id: jnkn\n        run: |\n          jnkn scan\n\n          # Analyze changed files\n          CHANGED=$(git diff --name-only origin/${{ github.base_ref }}...HEAD | grep -E '\\.(py|tf)$' || true)\n\n          if [ -n \"$CHANGED\" ]; then\n            REPORT=$(mktemp)\n            for f in $CHANGED; do\n              echo \"### \\`$f\\`\" &gt;&gt; $REPORT\n              jnkn blast \"file://$f\" --format markdown &gt;&gt; $REPORT 2&gt;/dev/null || echo \"No dependencies\" &gt;&gt; $REPORT\n            done\n            echo \"report&lt;&lt;EOF\" &gt;&gt; $GITHUB_OUTPUT\n            cat $REPORT &gt;&gt; $GITHUB_OUTPUT\n            echo \"EOF\" &gt;&gt; $GITHUB_OUTPUT\n          fi\n\n      - name: Comment on PR\n        uses: actions/github-script@v7\n        with:\n          script: |\n            const report = `${{ steps.jnkn.outputs.report }}`;\n            if (report) {\n              github.rest.issues.createComment({\n                issue_number: context.issue.number,\n                owner: context.repo.owner,\n                repo: context.repo.repo,\n                body: `## \ud83d\udd0d Jnkn Impact Analysis\\n\\n${report}`\n              });\n            }\n</code></pre>"},{"location":"how-to/integration/github-actions/#with-caching","title":"With Caching","text":"<pre><code>- uses: actions/cache@v4\n  with:\n    path: .jnkn/\n    key: jnkn-${{ runner.os }}-${{ hashFiles('**/*.py', '**/*.tf') }}\n    restore-keys: |\n      jnkn-${{ runner.os }}-\n</code></pre>"},{"location":"how-to/integration/github-actions/#block-on-high-impact","title":"Block on High Impact","text":"<pre><code>- name: Check impact threshold\n  run: |\n    MAX_IMPACT=10\n\n    for f in $(git diff --name-only origin/main...HEAD | grep -E '\\.(py|tf)$'); do\n      IMPACT=$(jnkn blast \"file://$f\" --format json 2&gt;/dev/null | jq '.total_impacted_count // 0')\n      if [ \"$IMPACT\" -gt \"$MAX_IMPACT\" ]; then\n        echo \"::error file=$f::High impact ($IMPACT) exceeds threshold ($MAX_IMPACT)\"\n        exit 1\n      fi\n    done\n</code></pre>"},{"location":"how-to/integration/github-actions/#matrix-strategy","title":"Matrix Strategy","text":"<p>Scan different components in parallel:</p> <pre><code>jobs:\n  analyze:\n    strategy:\n      matrix:\n        component: [backend, frontend, infrastructure]\n    steps:\n      - run: jnkn scan --dir ${{ matrix.component }}/\n</code></pre>"},{"location":"how-to/integration/github-actions/#reusable-workflow","title":"Reusable Workflow","text":"<p>Create <code>.github/workflows/jnkn-reusable.yml</code>:</p> <pre><code>name: Jnkn Reusable\non:\n  workflow_call:\n    inputs:\n      directory:\n        type: string\n        default: '.'\n      threshold:\n        type: number\n        default: 10\n\njobs:\n  analyze:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-python@v5\n        with:\n          python-version: '3.11'\n      - run: pip install jnkn[full]\n      - run: jnkn scan --dir ${{ inputs.directory }}\n</code></pre> <p>Use in other workflows:</p> <pre><code>jobs:\n  jnkn:\n    uses: ./.github/workflows/jnkn-reusable.yml\n    with:\n      directory: src/\n      threshold: 5\n</code></pre>"},{"location":"how-to/integration/gitlab-ci/","title":"GitLab CI","text":"<p>Set up Jnkn in GitLab CI/CD pipelines.</p>"},{"location":"how-to/integration/gitlab-ci/#minimal-setup","title":"Minimal Setup","text":"<pre><code># .gitlab-ci.yml\njnkn:\n  image: python:3.11-slim\n  script:\n    - pip install jnkn[full]\n    - jnkn scan\n    - jnkn stats\n  only:\n    changes:\n      - \"**/*.py\"\n      - \"**/*.tf\"\n</code></pre>"},{"location":"how-to/integration/gitlab-ci/#with-caching","title":"With Caching","text":"<pre><code>jnkn:\n  image: python:3.11-slim\n  cache:\n    key: jnkn-$CI_COMMIT_REF_SLUG\n    paths:\n      - .jnkn/\n  script:\n    - pip install jnkn[full]\n    - jnkn scan\n    - jnkn stats\n</code></pre>"},{"location":"how-to/integration/gitlab-ci/#block-pipeline-on-high-impact","title":"Block Pipeline on High Impact","text":"<pre><code>jnkn:\n  image: python:3.11-slim\n  script:\n    - pip install jnkn[full] jq\n    - jnkn scan\n    - |\n      MAX_IMPACT=10\n      FAILED=0\n\n      for f in $(git diff --name-only origin/$CI_MERGE_REQUEST_TARGET_BRANCH_NAME...HEAD | grep -E '\\.(py|tf)$'); do\n        IMPACT=$(jnkn blast \"file://$f\" --format json 2&gt;/dev/null | jq '.total_impacted_count // 0')\n        if [ \"$IMPACT\" -gt \"$MAX_IMPACT\" ]; then\n          echo \"High impact ($IMPACT) for $f\"\n          FAILED=1\n        fi\n      done\n\n      if [ \"$FAILED\" -eq 1 ]; then\n        exit 1\n      fi\n  rules:\n    - if: $CI_PIPELINE_SOURCE == \"merge_request_event\"\n</code></pre>"},{"location":"how-to/integration/gitlab-ci/#docker-image","title":"Docker Image","text":"<p>Use a pre-built image for faster pipelines:</p> <pre><code>jnkn:\n  image: ghcr.io/jnkn-io/jnkn:latest\n  script:\n    - jnkn scan\n    - jnkn stats\n</code></pre>"},{"location":"how-to/integration/gitlab-ci/#parallel-jobs","title":"Parallel Jobs","text":"<pre><code>.jnkn-template:\n  image: python:3.11-slim\n  before_script:\n    - pip install jnkn[full]\n\njnkn-backend:\n  extends: .jnkn-template\n  script:\n    - jnkn scan --dir backend/\n\njnkn-infra:\n  extends: .jnkn-template\n  script:\n    - jnkn scan --dir terraform/\n</code></pre>"},{"location":"how-to/integration/gitlab-ci/#artifacts","title":"Artifacts","text":"<p>Save results for later stages:</p> <pre><code>jnkn:\n  script:\n    - jnkn scan\n    - jnkn stats --format json &gt; stats.json\n    - jnkn export --format json &gt; graph.json\n  artifacts:\n    paths:\n      - stats.json\n      - graph.json\n    expire_in: 1 week\n</code></pre>"},{"location":"how-to/integration/jenkins/","title":"Jenkins","text":"<p>Integrating with Jenkins.</p>"},{"location":"how-to/integration/jira-integration/","title":"Jira Integration","text":"<p>Creating tickets for breaking changes.</p>"},{"location":"how-to/integration/slack-notifications/","title":"Slack Notifications","text":"<p>Sending alerts to Slack.</p>"},{"location":"how-to/scanning/incremental-scanning/","title":"Incremental Scanning","text":"<p>Only re-scan files that have changed since the last scan.</p>"},{"location":"how-to/scanning/incremental-scanning/#how-it-works","title":"How It Works","text":"<p>Jnkn stores a hash of each file. On subsequent scans, unchanged files are skipped:</p> <pre><code>First scan:  847 files parsed\nSecond scan: 12 files parsed (835 unchanged)\n</code></pre>"},{"location":"how-to/scanning/incremental-scanning/#usage","title":"Usage","text":"<p>Incremental scanning is automatic:</p> <pre><code>jnkn scan  # First time: full scan\n# ... make changes ...\njnkn scan  # Only changed files\n</code></pre>"},{"location":"how-to/scanning/incremental-scanning/#force-full-rescan","title":"Force Full Rescan","text":"<p>When you need to regenerate everything:</p> <pre><code>jnkn scan --full\n</code></pre> <p>Use this when:</p> <ul> <li>Upgrading Jnkn (new patterns detected)</li> <li>Changing configuration</li> <li>Debugging issues</li> </ul>"},{"location":"how-to/scanning/incremental-scanning/#check-file-status","title":"Check File Status","text":"<p>See which files would be scanned:</p> <pre><code>jnkn scan --dry-run\n</code></pre> <pre><code>Would scan:\n  src/config.py (modified)\n  src/api/users.py (modified)\n  terraform/rds.tf (new)\n\nWould skip:\n  src/main.py (unchanged)\n  src/utils.py (unchanged)\n  ... 842 more unchanged files\n</code></pre>"},{"location":"how-to/scanning/incremental-scanning/#git-integration","title":"Git Integration","text":"<p>Scan only files changed in a PR:</p> <pre><code># Get changed files from git\nCHANGED=$(git diff --name-only origin/main...HEAD)\n\n# Scan just those files\njnkn scan --files $CHANGED\n</code></pre> <p>Or in CI:</p> <pre><code>- name: Scan changed files\n  run: |\n    CHANGED=$(git diff --name-only ${{ github.event.before }} ${{ github.sha }})\n    jnkn scan --files $CHANGED\n</code></pre>"},{"location":"how-to/scanning/incremental-scanning/#cache-location","title":"Cache Location","text":"<p>The database is stored at <code>.jnkn/jnkn.db</code> by default.</p> <p>To use a different location:</p> <pre><code>jnkn scan --db /path/to/jnkn.db\n</code></pre>"},{"location":"how-to/scanning/incremental-scanning/#troubleshooting","title":"Troubleshooting","text":""},{"location":"how-to/scanning/incremental-scanning/#files-not-being-detected-as-changed","title":"Files not being detected as changed","text":"<p>Check the stored hash:</p> <pre><code>jnkn stats --show-hashes | grep myfile.py\n</code></pre>"},{"location":"how-to/scanning/incremental-scanning/#scan-is-slow-despite-few-changes","title":"Scan is slow despite few changes","text":"<p>The stitching phase runs on all nodes, not just changed files. This is necessary to detect new cross-domain links.</p> <p>For very large graphs, consider splitting by domain (see Scan a Monorepo).</p>"},{"location":"how-to/scanning/parallel-scanning/","title":"Parallel Scanning","text":"<p>Optimizing performance.</p>"},{"location":"how-to/scanning/scan-monorepo/","title":"Scan a Monorepo","text":"<p>Strategies for scanning large codebases efficiently.</p>"},{"location":"how-to/scanning/scan-monorepo/#the-challenge","title":"The Challenge","text":"<p>Monorepos can have thousands of files. A full scan may take minutes and produce a huge graph.</p>"},{"location":"how-to/scanning/scan-monorepo/#strategy-1-scope-to-directories","title":"Strategy 1: Scope to Directories","text":"<p>Scan only relevant directories:</p> <pre><code>jnkn scan --dir src/services --dir terraform/\n</code></pre> <p>Or use <code>.jnknignore</code>:</p> <pre><code># .jnknignore\nnode_modules/\nvendor/\n*.test.py\n*_test.go\n__pycache__/\n.git/\ndocs/\nscripts/\n</code></pre>"},{"location":"how-to/scanning/scan-monorepo/#strategy-2-incremental-scanning","title":"Strategy 2: Incremental Scanning","text":"<p>Only re-scan changed files:</p> <pre><code># First scan (full)\njnkn scan\n\n# Subsequent scans (incremental)\njnkn scan  # Automatically detects unchanged files via hash\n</code></pre> <p>Force full rescan if needed:</p> <pre><code>jnkn scan --full\n</code></pre>"},{"location":"how-to/scanning/scan-monorepo/#strategy-3-parallel-scanning","title":"Strategy 3: Parallel Scanning","text":"<p>Use multiple cores:</p> <pre><code>jnkn scan --jobs 8\n</code></pre> <p>Or auto-detect:</p> <pre><code>jnkn scan --jobs auto  # Uses CPU count\n</code></pre>"},{"location":"how-to/scanning/scan-monorepo/#strategy-4-split-by-domain","title":"Strategy 4: Split by Domain","text":"<p>For very large monorepos, maintain separate databases:</p> <pre><code># Backend team\njnkn scan --dir backend/ --db .jnkn/backend.db\n\n# Infrastructure team  \njnkn scan --dir terraform/ --db .jnkn/infra.db\n\n# Query across both\njnkn blast env:DATABASE_URL \\\n  --db .jnkn/backend.db \\\n  --db .jnkn/infra.db\n</code></pre>"},{"location":"how-to/scanning/scan-monorepo/#strategy-5-ci-caching","title":"Strategy 5: CI Caching","text":"<p>Cache the database between CI runs:</p> <pre><code>- uses: actions/cache@v4\n  with:\n    path: .jnkn/\n    key: jnkn-${{ hashFiles('**/*.py', '**/*.tf') }}\n    restore-keys: jnkn-\n</code></pre>"},{"location":"how-to/scanning/scan-monorepo/#performance-tips","title":"Performance Tips","text":"Files Expected Scan Time Recommendation &lt; 100 &lt; 5 seconds Default settings 100-1000 5-30 seconds Enable caching 1000-10000 30s - 3 min Parallel + incremental &gt; 10000 3+ min Split by domain"},{"location":"how-to/scanning/scan-monorepo/#monitoring-scan-performance","title":"Monitoring Scan Performance","text":"<pre><code>jnkn scan --verbose\n</code></pre> <p>Output includes timing:</p> <pre><code>Parsing: 12.3s (847 files)\nStitching: 3.2s (156 rules evaluated)\nStorage: 0.8s (2341 nodes written)\nTotal: 16.3s\n</code></pre>"},{"location":"how-to/scanning/scan-specific-directories/","title":"Filtering Scans","text":"<p>Using include/exclude patterns.</p>"},{"location":"how-to/troubleshooting/no-matches-found/","title":"No Matches Found","text":"<p>Debug why Jnkn isn't detecting dependencies.</p>"},{"location":"how-to/troubleshooting/no-matches-found/#check-what-was-scanned","title":"Check What Was Scanned","text":"<pre><code>jnkn stats\n</code></pre> <p>If <code>Nodes: 0</code>, no files were parsed.</p>"},{"location":"how-to/troubleshooting/no-matches-found/#verify-file-discovery","title":"Verify File Discovery","text":"<pre><code>jnkn scan --verbose\n</code></pre> <p>Look for:</p> <pre><code>Scanning /path/to/project\n  Found 0 Python files\n  Found 0 Terraform files\n</code></pre>"},{"location":"how-to/troubleshooting/no-matches-found/#common-causes","title":"Common Causes","text":"<p>Wrong directory:</p> <pre><code># Make sure you're in the right place\njnkn scan --dir ./src\n</code></pre> <p>Files ignored:</p> <p>Check <code>.jnknignore</code>:</p> <pre><code># This ignores everything!\n*\n</code></pre> <p>Unsupported extension:</p> <p>Jnkn only scans <code>.py</code>, <code>.tf</code>, <code>.yaml</code>, <code>.yml</code> by default.</p>"},{"location":"how-to/troubleshooting/no-matches-found/#verify-pattern-detection","title":"Verify Pattern Detection","text":"<p>For a specific file:</p> <pre><code>jnkn scan --verbose --files src/config.py\n</code></pre> <p>Look for detected patterns:</p> <pre><code>src/config.py:\n  Detected: env:DATABASE_URL (os.getenv)\n  Detected: env:API_KEY (pydantic_settings)\n</code></pre>"},{"location":"how-to/troubleshooting/no-matches-found/#common-causes_1","title":"Common Causes","text":"<p>Pattern not supported:</p> <p>Check Supported Patterns. Your pattern may not be implemented yet.</p> <p>Syntax variation:</p> <pre><code># Supported\nos.getenv(\"DATABASE_URL\")\n\n# NOT supported (variable key)\nkey = \"DATABASE_URL\"\nos.getenv(key)\n</code></pre> <p>Comments or strings:</p> <pre><code># This is NOT detected (it's a comment)\n# os.getenv(\"DATABASE_URL\")\n\n# This is NOT detected (it's a string)\nexample = 'os.getenv(\"DATABASE_URL\")'\n</code></pre>"},{"location":"how-to/troubleshooting/no-matches-found/#check-stitching","title":"Check Stitching","text":"<p>If nodes exist but no cross-domain edges:</p> <pre><code>jnkn stats\n</code></pre> <pre><code>Nodes: 50\nEdges: 45\nCross-domain edges: 0  # Problem!\n</code></pre>"},{"location":"how-to/troubleshooting/no-matches-found/#verify-tokens","title":"Verify Tokens","text":"<pre><code>jnkn explain env:DATABASE_URL infra:db_instance\n</code></pre> <pre><code>Source tokens: [database, url]\nTarget tokens: [db, instance]\nToken overlap: 0/2  # No match!\n</code></pre> <p>Solution: The names are too different. Consider:</p> <ul> <li>Renaming to match conventions</li> <li>Creating a custom stitching rule</li> <li>Lowering confidence threshold</li> </ul>"},{"location":"how-to/troubleshooting/no-matches-found/#check-confidence","title":"Check Confidence","text":"<pre><code>jnkn explain env:DB_HOST infra:db_host\n</code></pre> <pre><code>Confidence: 0.45 (REJECTED)\nThreshold: 0.50\n</code></pre> <p>Solution: Lower the threshold:</p> <pre><code>stitching:\n  min_confidence: 0.4\n</code></pre>"},{"location":"how-to/troubleshooting/no-matches-found/#check-for-suppressions","title":"Check for Suppressions","text":"<p>A suppression might be hiding the match:</p> <pre><code>jnkn suppress test env:DATABASE_URL infra:db_instance\n</code></pre> <pre><code>\u2713 Would be SUPPRESSED by rule 2\n</code></pre> <p>Solution: Remove or disable the suppression:</p> <pre><code>jnkn suppress remove 2\n</code></pre>"},{"location":"how-to/troubleshooting/no-matches-found/#enable-debug-logging","title":"Enable Debug Logging","text":"<pre><code>JUNKAN_LOG_LEVEL=DEBUG jnkn scan\n</code></pre> <p>This shows detailed parsing and matching information.</p>"},{"location":"how-to/troubleshooting/no-matches-found/#still-stuck","title":"Still Stuck?","text":"<ol> <li>Check GitHub Issues for similar problems</li> <li>Run <code>jnkn feedback</code> to report a bug</li> <li>Ask in the community Slack</li> </ol>"},{"location":"how-to/troubleshooting/parser-errors/","title":"Parser Errors","text":"<p>Handling syntax errors.</p>"},{"location":"how-to/troubleshooting/performance-issues/","title":"Performance Issues","text":"<p>Debugging slow scans.</p>"},{"location":"how-to/troubleshooting/too-many-false-positives/","title":"Too Many False Positives","text":"<p>Reduce incorrect matches when Jnkn links unrelated artifacts.</p>"},{"location":"how-to/troubleshooting/too-many-false-positives/#quick-fixes","title":"Quick Fixes","text":""},{"location":"how-to/troubleshooting/too-many-false-positives/#1-raise-confidence-threshold","title":"1. Raise Confidence Threshold","text":"<pre><code># .jnkn/config.yaml\nstitching:\n  min_confidence: 0.7  # Up from 0.5\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#2-suppress-known-bad-patterns","title":"2. Suppress Known Bad Patterns","text":"<pre><code># Generic patterns that match too much\njnkn suppress add \"env:*_ID\" \"infra:*\" --reason \"ID fields too generic\"\njnkn suppress add \"env:*_KEY\" \"infra:*\" --reason \"KEY fields too generic\"\njnkn suppress add \"env:HOST\" \"*\" --reason \"HOST alone is too generic\"\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#3-block-common-tokens","title":"3. Block Common Tokens","text":"<pre><code># .jnkn/config.yaml\nstitching:\n  blocked_tokens:\n    - id\n    - key\n    - url\n    - host\n    - port\n    - name\n    - config\n    - value\n    - data\n    - type\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#systematic-approach","title":"Systematic Approach","text":""},{"location":"how-to/troubleshooting/too-many-false-positives/#step-1-identify-the-problem","title":"Step 1: Identify the Problem","text":"<p>List all current matches:</p> <pre><code>jnkn stats --edges --type cross_domain\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#step-2-sample-and-review","title":"Step 2: Sample and Review","text":"<p>Pick 10 random matches and verify:</p> <pre><code>jnkn stats --edges --type cross_domain --format json | jq '.[0:10]'\n</code></pre> <p>For each, ask: \"Is this a real dependency?\"</p>"},{"location":"how-to/troubleshooting/too-many-false-positives/#step-3-categorize-false-positives","title":"Step 3: Categorize False Positives","text":"<p>Common categories:</p> Category Example Solution Generic tokens <code>HOST</code> matches everything Block token Naming collision <code>user_id</code> matches <code>uuid</code> Suppress pattern Low confidence 0.51 sneaking through Raise threshold Wrong domain Test \u2192 Prod matches Suppress pattern"},{"location":"how-to/troubleshooting/too-many-false-positives/#step-4-apply-fixes","title":"Step 4: Apply Fixes","text":"<p>For generic tokens:</p> <pre><code>stitching:\n  blocked_tokens:\n    - host\n    - user\n</code></pre> <p>For naming collisions:</p> <pre><code>jnkn suppress add \"env:USER_ID\" \"infra:uuid_*\" --reason \"Collision\"\n</code></pre> <p>For low confidence:</p> <pre><code>stitching:\n  min_confidence: 0.6\n</code></pre> <p>For wrong domain:</p> <pre><code>jnkn suppress add \"*\" \"infra:test_*\" --reason \"Test infra\"\njnkn suppress add \"*\" \"infra:*_dev\" --reason \"Dev infra\"\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#step-5-verify","title":"Step 5: Verify","text":"<p>Rescan and check:</p> <pre><code>jnkn scan --full\njnkn stats --edges --type cross_domain\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#advanced-custom-penalties","title":"Advanced: Custom Penalties","text":"<p>Add penalties for tokens that reduce confidence:</p> <pre><code>stitching:\n  confidence:\n    penalties:\n      short_token: 0.5    # &lt; 4 chars\n      common_token: 0.6   # Generic words\n\n  low_value_tokens:\n    - aws\n    - gcp\n    - prod\n    - dev\n    - staging\n    - main\n    - default\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#advanced-rule-specific-tuning","title":"Advanced: Rule-Specific Tuning","text":"<p>Different rules can have different thresholds:</p> <pre><code>stitching:\n  rule_overrides:\n    EnvVarToInfraRule:\n      min_confidence: 0.7     # Stricter\n      blocked_tokens:\n        - host\n        - port\n\n    K8sToSecretRule:\n      min_confidence: 0.5     # Default\n</code></pre>"},{"location":"how-to/troubleshooting/too-many-false-positives/#measuring-improvement","title":"Measuring Improvement","text":"<p>Track precision over time:</p> <pre><code># Before changes\njnkn stats --edges --type cross_domain | wc -l\n# 150 matches\n\n# After changes  \njnkn stats --edges --type cross_domain | wc -l\n# 45 matches (70% reduction)\n</code></pre> <p>Review the remaining matches to ensure you didn't lose real dependencies.</p>"},{"location":"how-to/troubleshooting/too-many-false-positives/#when-to-accept-some-false-positives","title":"When to Accept Some False Positives","text":"<p>Consider keeping false positives if:</p> <ul> <li>Manual review is fast (&lt; 5 matches per PR)</li> <li>The cost of missing a real dependency is high</li> <li>Your team prefers over-alerting to under-alerting</li> </ul> <p>The goal is useful signal, not zero noise.</p>"},{"location":"legal/license/","title":"License","text":"<p>MIT License details.</p>"},{"location":"legal/security-policy/","title":"Security Policy","text":"<p>Reporting vulnerabilities.</p>"},{"location":"openlineage/design/","title":"OpenLineage Integration Architecture","text":"<p>Version: 1.0.0 Last Updated: December 2024</p> <p>This document describes how Jnkn integrates with OpenLineage to provide complete pre-merge impact analysis for data pipelines.</p>"},{"location":"openlineage/design/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Executive Summary</li> <li>The Problem</li> <li>Why OpenLineage Alone Isn't Enough</li> <li>The Jnkn + OpenLineage Solution</li> <li>Architecture Overview</li> <li>Data Flow</li> <li>Integration Patterns</li> <li>Technical Implementation</li> <li>Confidence Model</li> <li>CI/CD Integration</li> <li>Deployment Options</li> </ol>"},{"location":"openlineage/design/#executive-summary","title":"Executive Summary","text":"<p>The Problem: Data pipeline failures are often caused by upstream code changes that existing tools only detect after downstream damage occurs.</p> <p>The Gap: OpenLineage captures runtime lineage (what happened), but cannot predict the impact of code changes before they're deployed.</p> <p>The Solution: Jnkn combines static code analysis with OpenLineage runtime data to provide pre-merge impact prediction with production-grade confidence.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                                     \u2502\n\u2502   Code Change \u2192 Jnkn Analysis \u2192 OpenLineage Lookup \u2192 Impact Map   \u2502\n\u2502                                                                     \u2502\n\u2502   \"This PR modifies     \"Which jobs      \"These 4 systems          \u2502\n\u2502    column X\"             consume X?\"      will be affected\"         \u2502\n\u2502                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"openlineage/design/#the-problem","title":"The Problem","text":""},{"location":"openlineage/design/#silent-data-pipeline-failures","title":"Silent Data Pipeline Failures","text":"<p>Data pipelines fail silently. Unlike application code that throws errors, data issues often manifest as:</p> <ul> <li>Wrong numbers in dashboards</li> <li>Degraded ML model performance</li> <li>Compliance reports with incorrect values</li> <li>Analytics that \"look fine\" but are subtly wrong</li> </ul>"},{"location":"openlineage/design/#the-root-cause","title":"The Root Cause","text":"<p>Most data incidents trace back to upstream changes:</p> <pre><code>graph LR\n    subgraph \"Root Causes\"\n        A[Schema change] \n        B[Column rename]\n        C[Filter logic change]\n        D[Aggregation change]\n    end\n\n    subgraph \"Silent Propagation\"\n        E[No immediate error]\n        F[Downstream jobs run]\n        G[Wrong data written]\n    end\n\n    subgraph \"Late Detection\"\n        H[Dashboard looks wrong]\n        I[Model accuracy drops]\n        J[Audit fails]\n    end\n\n    A --&gt; E --&gt; H\n    B --&gt; F --&gt; I\n    C --&gt; G --&gt; J\n\n    style H fill:#ff6b6b,stroke:#c92a2a,color:#fff\n    style I fill:#ff6b6b,stroke:#c92a2a,color:#fff\n    style J fill:#ff6b6b,stroke:#c92a2a,color:#fff</code></pre>"},{"location":"openlineage/design/#current-state-siloed-tooling","title":"Current State: Siloed Tooling","text":"Tool What It Sees What It Misses Unit Tests Code logic Downstream consumers OpenLineage Runtime dependencies Future code changes Data Quality Tools Anomalies after the fact Root cause in code Code Review Syntax and logic Production dependencies"},{"location":"openlineage/design/#why-openlineage-alone-isnt-enough","title":"Why OpenLineage Alone Isn't Enough","text":"<p>OpenLineage is excellent at capturing what happened. It records:</p> <ul> <li>Which jobs ran</li> <li>What datasets were read/written</li> <li>Column-level lineage (with proper instrumentation)</li> <li>Execution timestamps and durations</li> </ul> <pre><code>sequenceDiagram\n    participant Job as Spark Job\n    participant OL as OpenLineage\n    participant Marquez as Marquez/DataHub\n\n    Job-&gt;&gt;Job: Execute query\n    Job-&gt;&gt;OL: Emit START event\n    Job-&gt;&gt;Job: Read from table_a\n    Job-&gt;&gt;Job: Write to table_b\n    Job-&gt;&gt;OL: Emit COMPLETE event\n    OL-&gt;&gt;Marquez: Store lineage\n\n    Note over Marquez: Now we know table_a \u2192 table_b\n    Note over Marquez: But only AFTER execution</code></pre>"},{"location":"openlineage/design/#the-timing-gap","title":"The Timing Gap","text":"<pre><code>Timeline:\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\n\n   PR Created    PR Merged    Job Runs    Failure Detected\n       \u2502             \u2502            \u2502              \u2502\n       \u25bc             \u25bc            \u25bc              \u25bc\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502 Code  \u2502    \u2502 Deploy \u2502   \u2502 OpenL. \u2502    \u2502 PagerDuty\u2502\n   \u2502 Review\u2502    \u2502        \u2502   \u2502 Event  \u2502    \u2502 Alert    \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                          \u2502              \u2502\n       \u2502                          \u2502              \u2502\n       \u25bc                          \u25bc              \u25bc\n   No lineage              Lineage recorded   Too late\n   info available          (post-facto)       to prevent\n</code></pre> <p>OpenLineage tells you what broke. It cannot tell you what will break.</p>"},{"location":"openlineage/design/#the-jnkn-openlineage-solution","title":"The Jnkn + OpenLineage Solution","text":"<p>Jnkn bridges the timing gap by combining:</p> <ol> <li>Static Analysis (pre-merge): Parse code to understand what changes</li> <li>Runtime Lineage (OpenLineage): Know actual production dependencies</li> <li>Impact Prediction: Map code changes to affected systems</li> </ol> <pre><code>graph TB\n    subgraph \"Pre-Merge (Jnkn)\"\n        PR[Pull Request]\n        STATIC[Static Analysis]\n        DIFF[Change Detection]\n    end\n\n    subgraph \"Runtime Data (OpenLineage)\"\n        OL_DB[(OpenLineage&lt;br/&gt;Marquez/DataHub)]\n        JOBS[Job Catalog]\n        DEPS[Dependencies]\n    end\n\n    subgraph \"Combined Analysis\"\n        MERGE[Unified Graph]\n        IMPACT[Impact Calculator]\n        DECISION[Gate Decision]\n    end\n\n    PR --&gt; STATIC\n    STATIC --&gt; DIFF\n    DIFF --&gt; MERGE\n\n    OL_DB --&gt; JOBS\n    OL_DB --&gt; DEPS\n    JOBS --&gt; MERGE\n    DEPS --&gt; MERGE\n\n    MERGE --&gt; IMPACT\n    IMPACT --&gt; DECISION\n\n    DECISION --&gt; BLOCK[\u274c Block PR]\n    DECISION --&gt; WARN[\u26a0\ufe0f Warn + Notify]\n    DECISION --&gt; PASS[\u2705 Safe to Merge]\n\n    style MERGE fill:#4dabf7,stroke:#1971c2,color:#fff\n    style BLOCK fill:#ff6b6b,stroke:#c92a2a,color:#fff\n    style WARN fill:#fab005,stroke:#f59f00,color:#000\n    style PASS fill:#40c057,stroke:#2f9e44,color:#fff</code></pre>"},{"location":"openlineage/design/#value-proposition","title":"Value Proposition","text":"Capability OpenLineage Only Jnkn + OpenLineage Know what ran \u2705 \u2705 Know dependencies \u2705 \u2705 Predict impact pre-merge \u274c \u2705 Block risky PRs \u274c \u2705 Auto-notify downstream teams \u274c \u2705 Confidence scoring N/A \u2705 (100% for runtime data)"},{"location":"openlineage/design/#architecture-overview","title":"Architecture Overview","text":""},{"location":"openlineage/design/#system-components","title":"System Components","text":"<pre><code>graph TB\n    subgraph \"Developer Workflow\"\n        DEV[Developer]\n        PR[Pull Request]\n        CI[CI/CD Pipeline]\n    end\n\n    subgraph \"Jnkn Core\"\n        PARSER_ENGINE[Parser Engine]\n\n        subgraph \"Parsers\"\n            PY[Python Parser]\n            SPARK[PySpark Parser]\n            TF[Terraform Parser]\n            OL_PARSER[OpenLineage Parser]\n        end\n\n        GRAPH[Unified Graph]\n        STITCHER[Cross-Domain Stitcher]\n        ANALYZER[Impact Analyzer]\n    end\n\n    subgraph \"Data Sources\"\n        CODE[(Git Repository)]\n        MARQUEZ[(Marquez API)]\n        DATAHUB[(DataHub API)]\n    end\n\n    subgraph \"Outputs\"\n        REPORT[Impact Report]\n        GATE[PR Gate Decision]\n        NOTIFY[Team Notifications]\n    end\n\n    DEV --&gt; PR\n    PR --&gt; CI\n    CI --&gt; PARSER_ENGINE\n\n    CODE --&gt; PY\n    CODE --&gt; SPARK\n    CODE --&gt; TF\n    MARQUEZ --&gt; OL_PARSER\n    DATAHUB --&gt; OL_PARSER\n\n    PY --&gt; GRAPH\n    SPARK --&gt; GRAPH\n    TF --&gt; GRAPH\n    OL_PARSER --&gt; GRAPH\n\n    GRAPH --&gt; STITCHER\n    STITCHER --&gt; ANALYZER\n\n    ANALYZER --&gt; REPORT\n    ANALYZER --&gt; GATE\n    ANALYZER --&gt; NOTIFY\n\n    style OL_PARSER fill:#4dabf7,stroke:#1971c2,color:#fff\n    style GRAPH fill:#40c057,stroke:#2f9e44,color:#fff</code></pre>"},{"location":"openlineage/design/#data-model","title":"Data Model","text":"<pre><code>classDiagram\n    class Node {\n        +str id\n        +str name\n        +NodeType type\n        +Tuple tokens\n        +Dict metadata\n        +str source\n    }\n\n    class Edge {\n        +str source_id\n        +str target_id\n        +RelationshipType type\n        +float confidence\n        +Dict metadata\n    }\n\n    class NodeType {\n        &lt;&lt;enumeration&gt;&gt;\n        CODE_FILE\n        JOB\n        DATA_ASSET\n        COLUMN\n        ENV_VAR\n        INFRA_RESOURCE\n    }\n\n    class RelationshipType {\n        &lt;&lt;enumeration&gt;&gt;\n        READS\n        WRITES\n        TRANSFORMS\n        PROVIDES\n        DEPENDS_ON\n    }\n\n    Node --&gt; NodeType\n    Edge --&gt; RelationshipType\n    Edge --&gt; Node : source\n    Edge --&gt; Node : target</code></pre>"},{"location":"openlineage/design/#data-flow","title":"Data Flow","text":""},{"location":"openlineage/design/#end-to-end-flow","title":"End-to-End Flow","text":"<pre><code>sequenceDiagram\n    participant Dev as Developer\n    participant Git as GitHub/GitLab\n    participant CI as CI Pipeline\n    participant Jnkn as Jnkn\n    participant OL as OpenLineage API\n    participant Slack as Notifications\n\n    Dev-&gt;&gt;Git: Push PR (modifies etl_job.py)\n    Git-&gt;&gt;CI: Trigger pipeline\n    CI-&gt;&gt;Jnkn: Run impact analysis\n\n    rect rgb(240, 248, 255)\n        Note over Jnkn: Static Analysis Phase\n        Jnkn-&gt;&gt;Jnkn: Parse changed files\n        Jnkn-&gt;&gt;Jnkn: Extract columns, tables\n        Jnkn-&gt;&gt;Jnkn: Detect modifications\n    end\n\n    rect rgb(255, 248, 240)\n        Note over Jnkn,OL: Runtime Enrichment Phase\n        Jnkn-&gt;&gt;OL: Query job dependencies\n        OL--&gt;&gt;Jnkn: Return lineage graph\n        Jnkn-&gt;&gt;Jnkn: Merge static + runtime\n    end\n\n    rect rgb(240, 255, 240)\n        Note over Jnkn: Impact Analysis Phase\n        Jnkn-&gt;&gt;Jnkn: Traverse dependency graph\n        Jnkn-&gt;&gt;Jnkn: Identify affected systems\n        Jnkn-&gt;&gt;Jnkn: Calculate risk score\n    end\n\n    alt High Risk\n        Jnkn-&gt;&gt;CI: Block PR\n        Jnkn-&gt;&gt;Slack: Notify affected teams\n        CI-&gt;&gt;Git: Post check failure\n    else Medium Risk\n        Jnkn-&gt;&gt;CI: Warn\n        Jnkn-&gt;&gt;Slack: Notify for awareness\n        CI-&gt;&gt;Git: Post warning comment\n    else Low Risk\n        Jnkn-&gt;&gt;CI: Pass\n        CI-&gt;&gt;Git: Post success\n    end</code></pre>"},{"location":"openlineage/design/#openlineage-data-ingestion","title":"OpenLineage Data Ingestion","text":"<pre><code>flowchart TB\n    subgraph \"OpenLineage Sources\"\n        SPARK_EVENTS[Spark Events]\n        AIRFLOW_EVENTS[Airflow Events]\n        DBT_EVENTS[dbt Events]\n    end\n\n    subgraph \"Lineage Store\"\n        MARQUEZ[Marquez]\n        DATAHUB[DataHub]\n        CUSTOM[Custom Store]\n    end\n\n    subgraph \"Jnkn Ingestion\"\n        OL_PARSER[OpenLineage Parser]\n\n        subgraph \"Extraction\"\n            JOBS[Extract Jobs]\n            DATASETS[Extract Datasets]\n            COLUMNS[Extract Columns]\n            EDGES[Extract Relationships]\n        end\n    end\n\n    subgraph \"Unified Graph\"\n        GRAPH[(Jnkn Graph)]\n    end\n\n    SPARK_EVENTS --&gt; MARQUEZ\n    AIRFLOW_EVENTS --&gt; MARQUEZ\n    DBT_EVENTS --&gt; DATAHUB\n\n    MARQUEZ --&gt; OL_PARSER\n    DATAHUB --&gt; OL_PARSER\n    CUSTOM --&gt; OL_PARSER\n\n    OL_PARSER --&gt; JOBS\n    OL_PARSER --&gt; DATASETS\n    OL_PARSER --&gt; COLUMNS\n    OL_PARSER --&gt; EDGES\n\n    JOBS --&gt; GRAPH\n    DATASETS --&gt; GRAPH\n    COLUMNS --&gt; GRAPH\n    EDGES --&gt; GRAPH\n\n    style OL_PARSER fill:#4dabf7,stroke:#1971c2,color:#fff</code></pre>"},{"location":"openlineage/design/#integration-patterns","title":"Integration Patterns","text":""},{"location":"openlineage/design/#pattern-1-api-based-real-time","title":"Pattern 1: API-Based (Real-Time)","text":"<p>Query OpenLineage at PR time for freshest data.</p> <pre><code># In CI pipeline\nfrom jnkn.parsing.openlineage import OpenLineageParser\n\nparser = OpenLineageParser()\nevents = parser.fetch_from_marquez(\n    base_url=\"http://marquez.internal:5000\",\n    namespace=\"spark-production\"\n)\n\nfor item in parser.parse_events(events):\n    graph.add(item)\n</code></pre> <p>Pros: Always current Cons: Adds latency, requires network access from CI</p>"},{"location":"openlineage/design/#pattern-2-snapshot-based-periodic-sync","title":"Pattern 2: Snapshot-Based (Periodic Sync)","text":"<p>Export OpenLineage data periodically, commit to repo or artifact store.</p> <pre><code># .github/workflows/sync-lineage.yml\nname: Sync OpenLineage\non:\n  schedule:\n    - cron: '0 */6 * * *'  # Every 6 hours\n\njobs:\n  sync:\n    runs-on: ubuntu-latest\n    steps:\n      - run: |\n          curl -o lineage.json \\\n            \"$MARQUEZ_URL/api/v1/namespaces/spark/jobs\"\n      - uses: actions/upload-artifact@v3\n        with:\n          name: lineage-snapshot\n          path: lineage.json\n</code></pre> <p>Pros: Fast CI, no runtime dependency Cons: Up to 6 hours stale</p>"},{"location":"openlineage/design/#pattern-3-hybrid-cached-delta","title":"Pattern 3: Hybrid (Cached + Delta)","text":"<p>Use cached snapshot, fetch only recent changes.</p> <pre><code># Load cached baseline\ncached_graph = load_from_cache(\"lineage-snapshot.json\")\n\n# Fetch only events since last sync\nrecent_events = parser.fetch_from_marquez(\n    base_url=MARQUEZ_URL,\n    since=cached_graph.last_updated\n)\n\n# Merge\nfor item in parser.parse_events(recent_events):\n    cached_graph.add(item)\n</code></pre> <p>Pros: Fast + fresh Cons: More complex implementation</p>"},{"location":"openlineage/design/#technical-implementation","title":"Technical Implementation","text":""},{"location":"openlineage/design/#openlineage-parser","title":"OpenLineage Parser","text":"<pre><code>class OpenLineageParser:\n    \"\"\"\n    Converts OpenLineage events to Jnkn nodes and edges.\n\n    Supports:\n    - Marquez API\n    - DataHub API  \n    - Raw JSON event files\n    - Kafka event streams (planned)\n    \"\"\"\n\n    def parse_events(self, events: List[Dict]) -&gt; Iterator[Node | Edge]:\n        for event in events:\n            # Extract job node\n            yield self._create_job_node(event[\"job\"])\n\n            # Extract input datasets + READS edges\n            for input in event.get(\"inputs\", []):\n                yield self._create_dataset_node(input)\n                yield Edge(\n                    source_id=job_id,\n                    target_id=dataset_id,\n                    type=RelationshipType.READS,\n                    confidence=1.0  # Observed in production\n                )\n\n            # Extract output datasets + WRITES edges\n            for output in event.get(\"outputs\", []):\n                yield self._create_dataset_node(output)\n                yield Edge(\n                    source_id=job_id,\n                    target_id=dataset_id,\n                    type=RelationshipType.WRITES,\n                    confidence=1.0\n                )\n\n            # Extract column lineage if present\n            yield from self._extract_column_lineage(output)\n</code></pre>"},{"location":"openlineage/design/#cross-domain-stitching","title":"Cross-Domain Stitching","text":"<p>Jnkn links code files to OpenLineage jobs via token matching:</p> <pre><code>graph LR\n    subgraph \"Static Analysis\"\n        CODE[file:daily_user_etl.py]\n        TOKENS1[\"tokens: [daily, user, etl]\"]\n    end\n\n    subgraph \"OpenLineage\"\n        JOB[job:spark/daily_user_etl]\n        TOKENS2[\"tokens: [daily, user, etl]\"]\n    end\n\n    subgraph \"Stitching\"\n        MATCH[Token Overlap: 100%]\n        EDGE[Edge: PROVIDES&lt;br/&gt;confidence: 0.95]\n    end\n\n    CODE --&gt; TOKENS1\n    JOB --&gt; TOKENS2\n    TOKENS1 --&gt; MATCH\n    TOKENS2 --&gt; MATCH\n    MATCH --&gt; EDGE\n\n    style EDGE fill:#40c057,stroke:#2f9e44,color:#fff</code></pre>"},{"location":"openlineage/design/#unified-graph-queries","title":"Unified Graph Queries","text":"<pre><code># Find all downstream consumers of a table\ndownstream = graph.get_downstream(\"data:s3/warehouse/dim_users\")\n\n# Result:\n# [\n#   (\"job:spark/user_metrics\", confidence=1.0, path=[...]),\n#   (\"job:spark/exec_dashboard_loader\", confidence=1.0, path=[...]),\n#   (\"data:redshift/exec_dashboard\", confidence=1.0, path=[...]),\n# ]\n\n# Find what code files affect a critical table\nupstream = graph.get_upstream(\"data:redshift/exec_dashboard\")\n\n# Result includes both:\n# - OpenLineage jobs (runtime)\n# - Code files (static analysis)\n</code></pre>"},{"location":"openlineage/design/#confidence-model","title":"Confidence Model","text":""},{"location":"openlineage/design/#confidence-levels-by-source","title":"Confidence Levels by Source","text":"Source Confidence Rationale OpenLineage (runtime) 1.0 Observed in production Static: Direct column reference 0.95 High certainty from code Static: Variable-resolved column 0.80 Resolved at parse time Cross-domain stitch (exact match) 0.95 Name match Cross-domain stitch (token overlap) 0.70-0.85 Fuzzy match Static: Dynamic/unresolved 0.50 Flagged for review"},{"location":"openlineage/design/#confidence-propagation","title":"Confidence Propagation","text":"<pre><code>graph LR\n    A[Code File&lt;br/&gt;conf: 0.95] --&gt;|PROVIDES| B[Job&lt;br/&gt;conf: 1.0]\n    B --&gt;|WRITES| C[Table A&lt;br/&gt;conf: 1.0]\n    C --&gt;|READS| D[Job 2&lt;br/&gt;conf: 1.0]\n    D --&gt;|WRITES| E[Table B&lt;br/&gt;conf: 1.0]\n\n    subgraph \"Path Confidence\"\n        PATH[\"A \u2192 E: min(0.95, 1.0, 1.0, 1.0, 1.0) = 0.95\"]\n    end</code></pre> <p>Path confidence = minimum confidence along the path.</p>"},{"location":"openlineage/design/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"openlineage/design/#github-actions-example","title":"GitHub Actions Example","text":"<pre><code>name: Jnkn Impact Analysis\n\non:\n  pull_request:\n    paths:\n      - 'src/**/*.py'\n      - 'dbt/**/*.sql'\n      - 'terraform/**/*.tf'\n\njobs:\n  impact-analysis:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.11'\n\n      - name: Install Jnkn\n        run: pip install jnkn\n\n      - name: Fetch OpenLineage Data\n        env:\n          MARQUEZ_URL: ${{ secrets.MARQUEZ_URL }}\n        run: |\n          jnkn openlineage fetch \\\n            --url $MARQUEZ_URL \\\n            --output lineage-cache.json\n\n      - name: Run Impact Analysis\n        run: |\n          jnkn analyze \\\n            --changed-files \"${{ github.event.pull_request.changed_files }}\" \\\n            --openlineage lineage-cache.json \\\n            --critical-tables config/critical-tables.yaml \\\n            --output impact-report.json\n\n      - name: Post Results\n        uses: actions/github-script@v6\n        with:\n          script: |\n            const report = require('./impact-report.json');\n\n            let comment = '## \ud83d\udd0d Jnkn Impact Analysis\\n\\n';\n\n            if (report.critical_impact.length &gt; 0) {\n              comment += '### \ud83d\udea8 Critical Systems Affected\\n';\n              for (const item of report.critical_impact) {\n                comment += `- ${item.system} (confidence: ${item.confidence})\\n`;\n              }\n              comment += '\\n**This PR requires approval from data platform team.**\\n';\n            }\n\n            if (report.downstream_count &gt; 0) {\n              comment += `\\n### \ud83d\udcca Downstream Impact\\n`;\n              comment += `- **${report.downstream_count}** jobs affected\\n`;\n              comment += `- **${report.tables_affected}** tables affected\\n`;\n            }\n\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: comment\n            });\n\n      - name: Gate Decision\n        run: |\n          if jnkn gate --report impact-report.json --policy config/policy.yaml; then\n            echo \"\u2705 Safe to merge\"\n          else\n            echo \"\u274c Blocked - requires approval\"\n            exit 1\n          fi\n</code></pre>"},{"location":"openlineage/design/#critical-tables-configuration","title":"Critical Tables Configuration","text":"<pre><code># config/critical-tables.yaml\ncritical:\n  # Executive dashboards\n  - pattern: \"redshift/analytics.exec_*\"\n    severity: critical\n    owners:\n      - \"@data-platform-team\"\n      - \"@analytics-team\"\n    require_approval: true\n\n  # ML feature stores\n  - pattern: \"s3/ml-features/*\"\n    severity: high\n    owners:\n      - \"@ml-engineering\"\n    require_approval: true\n\n  # Compliance/audit\n  - pattern: \"*/compliance.*\"\n    severity: critical\n    owners:\n      - \"@compliance-team\"\n      - \"@data-governance\"\n    require_approval: true\n    notify_always: true\n</code></pre>"},{"location":"openlineage/design/#deployment-options","title":"Deployment Options","text":""},{"location":"openlineage/design/#option-1-standalone-cli","title":"Option 1: Standalone CLI","text":"<pre><code># Install\npip install jnkn\n\n# One-time analysis\njnkn analyze \\\n  --dir ./src \\\n  --openlineage-url http://marquez:5000 \\\n  --output report.json\n</code></pre>"},{"location":"openlineage/design/#option-2-cicd-integration","title":"Option 2: CI/CD Integration","text":"<p>See GitHub Actions example above. Also supports: - GitLab CI - Jenkins - CircleCI - Azure DevOps</p>"},{"location":"openlineage/design/#option-3-service-mode-planned","title":"Option 3: Service Mode (Planned)","text":"<pre><code># docker-compose.yml\nservices:\n  jnkn:\n    image: jnkn/server:latest\n    ports:\n      - \"8080:8080\"\n    environment:\n      - MARQUEZ_URL=http://marquez:5000\n      - GITHUB_TOKEN=${GITHUB_TOKEN}\n    volumes:\n      - ./config:/config\n</code></pre> <p>Provides: - REST API for impact queries - Webhook receiver for PR events - Continuous lineage sync - Web UI for exploration</p>"},{"location":"openlineage/design/#summary","title":"Summary","text":""},{"location":"openlineage/design/#before-reactive-firefighting","title":"Before: Reactive Firefighting","text":"<pre><code>Code Change \u2192 Deploy \u2192 Run \u2192 Failure \u2192 Alert \u2192 Debug \u2192 Fix \u2192 Deploy\n                                         \u2502\n                                    Hours/Days of\n                                    wrong data\n</code></pre>"},{"location":"openlineage/design/#after-proactive-prevention","title":"After: Proactive Prevention","text":"<pre><code>Code Change \u2192 Jnkn + OpenLineage \u2192 Impact Known \u2192 Coordinated Deploy\n                     \u2502\n              Block if critical,\n              notify stakeholders\n</code></pre>"},{"location":"openlineage/design/#key-takeaways","title":"Key Takeaways","text":"<ol> <li> <p>OpenLineage is necessary but not sufficient - It captures runtime truth but can't predict future impact.</p> </li> <li> <p>Static analysis alone misses production reality - Code doesn't know what actually runs in production.</p> </li> <li> <p>The combination is powerful - Static analysis predicts what changes, OpenLineage knows what depends on what, together they prevent incidents.</p> </li> <li> <p>Confidence matters - Runtime lineage has 100% confidence (observed), static analysis ranges from 50-95% (inferred). The unified model tracks this.</p> </li> <li> <p>CI/CD integration is the delivery mechanism - The value is realized when every PR gets automatic impact analysis before merge.</p> </li> </ol>"},{"location":"openlineage/design/#references","title":"References","text":"<ul> <li>OpenLineage Specification</li> <li>Marquez Documentation</li> <li>DataHub Lineage</li> <li>Jnkn Architecture</li> <li>PySpark Column Lineage</li> </ul>"},{"location":"pyspark/design/","title":"Column-Level Lineage Design","text":""},{"location":"pyspark/design/#problem-statement","title":"Problem Statement","text":"<p>Current parser extracts table-level lineage: - <code>process_events.py</code> READS <code>warehouse.dim_users</code> - <code>process_events.py</code> WRITES <code>warehouse.fact_events</code></p> <p>But engineers need column-level lineage: - <code>warehouse.fact_events.user_segment</code> comes from <code>warehouse.dim_users.segment</code> - <code>warehouse.fact_events.total_revenue</code> is computed from <code>staging.events.revenue</code></p>"},{"location":"pyspark/design/#extraction-patterns","title":"Extraction Patterns","text":""},{"location":"pyspark/design/#pattern-1-sql-strings-easiest","title":"Pattern 1: SQL Strings (Easiest)","text":"<pre><code>spark.sql(\"SELECT column_a, column_b FROM database.table WHERE column_a = 'xyz'\")\nspark.sql(\"\"\"\n    SELECT \n        t1.user_id,\n        t1.event_count,\n        t2.segment\n    FROM warehouse.events t1\n    JOIN warehouse.users t2 ON t1.user_id = t2.user_id\n\"\"\")\n</code></pre> <p>Approach: Use sqlglot to parse SQL and extract: - SELECT columns \u2192 output columns - FROM/JOIN tables \u2192 source tables - WHERE/ON columns \u2192 filter columns - Column aliases \u2192 transformations</p>"},{"location":"pyspark/design/#pattern-2-dataframe-method-chains-medium","title":"Pattern 2: DataFrame Method Chains (Medium)","text":"<pre><code>read_df = spark.read.parquet(\"hdfs://path/to/table\")\nfiltered_df = read_df.filter(col(\"column_a\") == 'xyz')\nselected_df = filtered_df.select(\"column_a\", \"column_b\")\nresult = selected_df.withColumn(\"new_col\", col(\"column_a\") + col(\"column_b\"))\n</code></pre> <p>Approach: Track DataFrame transformations: - <code>.select()</code> \u2192 output columns - <code>.filter()</code> / <code>.where()</code> \u2192 filter columns - <code>.withColumn()</code> \u2192 new column + source columns - <code>.groupBy()</code> \u2192 grouping columns - <code>.agg()</code> \u2192 aggregation columns - <code>.join()</code> \u2192 join keys + source columns</p>"},{"location":"pyspark/design/#pattern-3-dynamicvariable-references-hard","title":"Pattern 3: Dynamic/Variable References (Hard)","text":"<pre><code>grouping_fields = [\"column_a\", \"column_b\"]\nfilter_value = 'xyz'\n\nfiltered_df = read_df.filter(col(\"column_a\") == filter_value)\nselected_df = filtered_df.select(grouping_fields)\nselected_df = filtered_df.select(*grouping_fields)\n</code></pre> <p>Approach:  - Track variable assignments (AST analysis) - Resolve list literals to column names - Handle <code>*args</code> unpacking - Mark as \"dynamic\" when truly unresolvable</p>"},{"location":"pyspark/design/#pattern-4-f-expressions-and-col-medium","title":"Pattern 4: F-expressions and col() (Medium)","text":"<pre><code>from pyspark.sql import functions as F\nfrom pyspark.sql.functions import col, sum, avg\n\ndf.select(F.col(\"a\"), F.sum(\"b\").alias(\"total_b\"))\ndf.withColumn(\"ratio\", F.col(\"a\") / F.col(\"b\"))\ndf.filter(F.col(\"status\") == \"active\")\n</code></pre> <p>Approach: Extract column names from: - <code>col(\"name\")</code>, <code>F.col(\"name\")</code> - <code>F.sum(\"name\")</code>, <code>F.avg(\"name\")</code>, etc. - <code>df[\"column\"]</code> bracket notation - <code>.alias(\"new_name\")</code> for output naming</p>"},{"location":"pyspark/design/#data-model","title":"Data Model","text":"<pre><code>@dataclass\nclass ColumnReference:\n    \"\"\"A reference to a column in the code.\"\"\"\n    column_name: str\n    table_name: Optional[str]  # If known\n    line_number: int\n    context: str  # \"select\", \"filter\", \"groupby\", \"join\", \"agg\", \"write\"\n    is_dynamic: bool = False  # True if from variable\n    alias: Optional[str] = None  # If renamed\n\n@dataclass\nclass ColumnLineage:\n    \"\"\"Lineage for a single output column.\"\"\"\n    output_column: str\n    output_table: str\n    source_columns: List[ColumnReference]\n    transformation: Optional[str]  # \"direct\", \"sum\", \"concat\", \"case\", etc.\n\n@dataclass \nclass FileColumnLineage:\n    \"\"\"All column lineage extracted from a file.\"\"\"\n    file_path: str\n    columns_read: List[ColumnReference]\n    columns_written: List[ColumnReference]\n    lineage: List[ColumnLineage]  # Output \u2192 Source mappings\n</code></pre>"},{"location":"pyspark/design/#implementation-strategy","title":"Implementation Strategy","text":""},{"location":"pyspark/design/#phase-1-sql-string-extraction-this-pr","title":"Phase 1: SQL String Extraction (This PR)","text":"<ul> <li>Parse SQL strings with sqlglot</li> <li>Extract SELECT columns, FROM tables, WHERE columns</li> <li>Handle JOINs and subqueries</li> <li>High accuracy, well-defined grammar</li> </ul>"},{"location":"pyspark/design/#phase-2-dataframe-method-tracking-next-pr","title":"Phase 2: DataFrame Method Tracking (Next PR)","text":"<ul> <li>Regex-based extraction of .select(), .filter(), etc.</li> <li>Extract column names from method arguments</li> <li>Track method chains to infer flow</li> </ul>"},{"location":"pyspark/design/#phase-3-variable-resolution-future","title":"Phase 3: Variable Resolution (Future)","text":"<ul> <li>AST-based analysis for variable tracking</li> <li>Resolve list literals and f-strings</li> <li>Mark unresolvable as \"dynamic\"</li> </ul>"},{"location":"pyspark/design/#confidence-levels","title":"Confidence Levels","text":"Pattern Confidence Example SQL string literal HIGH <code>spark.sql(\"SELECT a FROM t\")</code> Direct column ref HIGH <code>.select(\"col_a\", \"col_b\")</code> col() function HIGH <code>.filter(col(\"status\") == \"x\")</code> List variable (literal) MEDIUM <code>cols = [\"a\", \"b\"]; df.select(cols)</code> Config/param variable LOW <code>df.select(config.columns)</code> Dynamic expression UNKNOWN <code>df.select(*get_columns())</code>"},{"location":"pyspark/design/#output-format","title":"Output Format","text":"<pre><code>{\n  \"file\": \"jobs/process_events.py\",\n  \"table_lineage\": {\n    \"reads\": [\"staging.events\", \"warehouse.users\"],\n    \"writes\": [\"warehouse.fact_events\"]\n  },\n  \"column_lineage\": [\n    {\n      \"output\": \"warehouse.fact_events.user_segment\",\n      \"sources\": [\n        {\"table\": \"warehouse.users\", \"column\": \"segment\", \"transform\": \"direct\"}\n      ],\n      \"confidence\": \"high\"\n    },\n    {\n      \"output\": \"warehouse.fact_events.total_revenue\",\n      \"sources\": [\n        {\"table\": \"staging.events\", \"column\": \"revenue\", \"transform\": \"sum\"}\n      ],\n      \"confidence\": \"high\"\n    },\n    {\n      \"output\": \"warehouse.fact_events.event_date\",\n      \"sources\": [\n        {\"table\": \"staging.events\", \"column\": \"event_timestamp\", \"transform\": \"to_date\"}\n      ],\n      \"confidence\": \"high\"\n    }\n  ],\n  \"dynamic_columns\": [\n    {\n      \"location\": \"line 45\",\n      \"pattern\": \"df.select(*grouping_fields)\",\n      \"note\": \"columns from variable 'grouping_fields'\"\n    }\n  ]\n}\n</code></pre>"},{"location":"pyspark/design/#test-cases","title":"Test Cases","text":""},{"location":"pyspark/design/#sql-extraction","title":"SQL Extraction","text":"<pre><code># Simple SELECT\nspark.sql(\"SELECT user_id, name FROM users\")\n# \u2192 reads: users.user_id, users.name\n\n# JOIN\nspark.sql(\"\"\"\n    SELECT a.id, b.value \n    FROM table_a a \n    JOIN table_b b ON a.id = b.id\n\"\"\")\n# \u2192 reads: table_a.id, table_b.value, table_b.id\n\n# Aggregation\nspark.sql(\"SELECT category, SUM(amount) as total FROM sales GROUP BY category\")\n# \u2192 reads: sales.category, sales.amount\n# \u2192 output: total (from SUM(amount))\n</code></pre>"},{"location":"pyspark/design/#dataframe-method-extraction","title":"DataFrame Method Extraction","text":"<pre><code># Select\ndf.select(\"a\", \"b\", \"c\")\n# \u2192 columns: a, b, c\n\n# Filter\ndf.filter(col(\"status\") == \"active\")\n# \u2192 filter column: status\n\n# WithColumn\ndf.withColumn(\"full_name\", concat(col(\"first\"), col(\"last\")))\n# \u2192 output: full_name\n# \u2192 sources: first, last\n# \u2192 transform: concat\n\n# GroupBy + Agg\ndf.groupBy(\"category\").agg(sum(\"amount\").alias(\"total\"))\n# \u2192 grouping: category\n# \u2192 aggregation: amount \u2192 total (sum)\n</code></pre>"},{"location":"pyspark/design/#variable-resolution","title":"Variable Resolution","text":"<pre><code># Resolvable\ncols = [\"a\", \"b\", \"c\"]\ndf.select(cols)\n# \u2192 columns: a, b, c (confidence: medium)\n\n# Partially resolvable\nbase_cols = [\"id\", \"name\"]\ndf.select(*base_cols, \"extra_col\")\n# \u2192 columns: id, name, extra_col\n\n# Not resolvable\ndf.select(get_dynamic_columns())\n# \u2192 columns: UNKNOWN (flag for review)\n</code></pre>"},{"location":"reference/","title":"Reference","text":"<p>Complete reference documentation for Jnkn.</p>"},{"location":"reference/#cli","title":"CLI","text":"<ul> <li>CLI Overview \u2014 All commands and global options</li> </ul>"},{"location":"reference/#configuration","title":"Configuration","text":"<ul> <li>config.yaml \u2014 Main configuration file</li> <li>.jnknignore \u2014 File exclusion patterns</li> <li>suppressions.yaml \u2014 False positive management</li> </ul>"},{"location":"reference/#patterns","title":"Patterns","text":"<ul> <li>Overview \u2014 How pattern detection works</li> <li>Python \u2014 Python environment variable patterns</li> <li>Terraform \u2014 Terraform resource patterns</li> <li>Kubernetes \u2014 Kubernetes reference patterns</li> </ul>"},{"location":"reference/#output","title":"Output","text":"<ul> <li>JSON Schema \u2014 Output format specification</li> </ul>"},{"location":"reference/#glossary","title":"Glossary","text":"<ul> <li>Glossary \u2014 Terms and definitions</li> </ul>"},{"location":"reference/glossary/","title":"Glossary","text":"<p>Terms used in Jnkn documentation.</p>"},{"location":"reference/glossary/#a","title":"A","text":"<p>Artifact : A node in the dependency graph representing code, configuration, or infrastructure. Examples: env var, file, Terraform resource.</p>"},{"location":"reference/glossary/#b","title":"B","text":"<p>Blast Radius : The set of artifacts that would be affected by a change to a given artifact. Computed by traversing downstream dependencies.</p> <p>Blocked Token : A token (like \"id\", \"key\") that provides no signal for matching and is ignored during stitching.</p>"},{"location":"reference/glossary/#c","title":"C","text":"<p>Confidence : A score from 0.0 to 1.0 indicating how likely a cross-domain match is correct. Higher = more certain.</p> <p>Cross-Domain Dependency : A dependency that spans different technology domains (e.g., Python code depending on a Terraform resource).</p>"},{"location":"reference/glossary/#d","title":"D","text":"<p>Dependency Graph : A directed graph where nodes are artifacts and edges are dependencies between them.</p>"},{"location":"reference/glossary/#e","title":"E","text":"<p>Edge : A connection between two nodes in the dependency graph. Has a type (reads, imports, etc.) and optional metadata.</p> <p>Extractor : A component that detects specific patterns in source code (e.g., <code>os.getenv()</code> calls).</p>"},{"location":"reference/glossary/#g","title":"G","text":"<p>Graph : See Dependency Graph.</p>"},{"location":"reference/glossary/#m","title":"M","text":"<p>Matcher : A component that determines if two artifacts should be linked based on name similarity.</p>"},{"location":"reference/glossary/#n","title":"N","text":"<p>Node : An entity in the dependency graph. Has an ID, type, and metadata.</p> <p>Normalized Name : A standardized form of an artifact name used for matching. Example: <code>DATABASE_URL</code> \u2192 <code>databaseurl</code>.</p>"},{"location":"reference/glossary/#p","title":"P","text":"<p>Parser : A component that reads source files and extracts nodes and edges.</p> <p>Pattern : A code construct that Jnkn recognizes (e.g., <code>os.getenv(\"VAR\")</code>).</p> <p>Penalty : A multiplier that reduces confidence (e.g., 0.5 for short tokens).</p>"},{"location":"reference/glossary/#r","title":"R","text":"<p>Rule : See Stitching Rule.</p>"},{"location":"reference/glossary/#s","title":"S","text":"<p>Signal : A factor that increases confidence in a match (e.g., exact token overlap).</p> <p>Stitching : The process of creating edges between nodes from different domains based on name similarity.</p> <p>Stitching Rule : A rule that defines which node types can be matched and how confidence is calculated.</p> <p>Suppression : A user-defined rule to ignore specific matches (false positives).</p>"},{"location":"reference/glossary/#t","title":"T","text":"<p>Token : A word extracted from an artifact name. <code>DATABASE_URL</code> \u2192 <code>[\"database\", \"url\"]</code>.</p> <p>Token Matching : The technique of linking artifacts by comparing their tokenized names.</p>"},{"location":"reference/glossary/#artifact-types","title":"Artifact Types","text":"<p>code_file : A source code file (<code>.py</code>, <code>.js</code>, etc.).</p> <p>code_entity : A function or class definition within a file.</p> <p>env_var : An environment variable.</p> <p>infra_resource : A Terraform resource, variable, output, or data source.</p> <p>k8s_resource : A Kubernetes resource (Deployment, ConfigMap, Secret, etc.).</p> <p>data_asset : A dbt model, source, or seed.</p>"},{"location":"reference/glossary/#edge-types","title":"Edge Types","text":"<p>reads : Source reads a value from target (e.g., file reads env var).</p> <p>imports : Source imports target (e.g., Python import).</p> <p>provides : Source provides target (e.g., Terraform outputs an env var value).</p> <p>configures : Source configures target (e.g., K8s deployment uses ServiceAccount).</p> <p>contains : Source contains target (e.g., file contains function definition).</p> <p>references : Generic reference between artifacts.</p>"},{"location":"reference/cli/","title":"CLI Reference","text":""},{"location":"reference/cli/#global-options","title":"Global Options","text":"<pre><code>jnkn [OPTIONS] COMMAND [ARGS]\n</code></pre> Option Description <code>--db PATH</code> Database path (default: <code>.jnkn/jnkn.db</code>) <code>--config PATH</code> Config file (default: <code>.jnkn/config.yaml</code>) <code>--verbose</code> Enable verbose output <code>--quiet</code> Suppress non-error output <code>--version</code> Show version <code>--help</code> Show help"},{"location":"reference/cli/#commands","title":"Commands","text":""},{"location":"reference/cli/#jnkn-init","title":"<code>jnkn init</code>","text":"<p>Initialize Jnkn in the current directory.</p> <pre><code>jnkn init [OPTIONS]\n</code></pre> Option Description <code>--force</code> Overwrite existing configuration <p>Creates: - <code>.jnkn/config.yaml</code> - <code>.jnkn/suppressions.yaml</code> - <code>.jnknignore</code></p>"},{"location":"reference/cli/#jnkn-scan","title":"<code>jnkn scan</code>","text":"<p>Parse codebase and build dependency graph.</p> <pre><code>jnkn scan [OPTIONS]\n</code></pre> Option Default Description <code>--dir PATH</code> <code>.</code> Directory to scan <code>--full</code> <code>false</code> Force full rescan <code>--jobs N</code> <code>1</code> Parallel workers <code>--files FILE...</code> Scan specific files only <p>Examples:</p> <pre><code>jnkn scan\njnkn scan --dir src/ --dir terraform/\njnkn scan --full --jobs 4\n</code></pre>"},{"location":"reference/cli/#jnkn-blast-radius","title":"<code>jnkn blast-radius</code>","text":"<p>Calculate downstream impact.</p> <pre><code>jnkn blast ARTIFACT [ARTIFACTS...] [OPTIONS]\n</code></pre> Option Default Description <code>--max-depth N</code> <code>-1</code> Max traversal depth (-1 = unlimited) <code>--type TYPE</code> Filter by artifact type <code>--format FMT</code> <code>json</code> Output format: json, markdown, plain, sarif <p>Examples:</p> <pre><code>jnkn blast env:DATABASE_URL\njnkn blast env:X env:Y --max-depth 2\njnkn blast env:X --format markdown\n</code></pre>"},{"location":"reference/cli/#jnkn-explain","title":"<code>jnkn explain</code>","text":"<p>Explain why a match was made (or not made).</p> <pre><code>jnkn explain SOURCE TARGET [OPTIONS]\n</code></pre> Option Description <code>--why-not</code> Explain why match was rejected <code>--alternatives</code> Show other candidates considered <p>Examples:</p> <pre><code>jnkn explain env:DB_HOST infra:db_host\njnkn explain env:HOST infra:main --why-not\n</code></pre>"},{"location":"reference/cli/#jnkn-suppress","title":"<code>jnkn suppress</code>","text":"<p>Manage suppressions.</p> <pre><code>jnkn suppress COMMAND [OPTIONS]\n</code></pre>"},{"location":"reference/cli/#suppress-add","title":"<code>suppress add</code>","text":"<pre><code>jnkn suppress add SOURCE_PATTERN TARGET_PATTERN [OPTIONS]\n</code></pre> Option Description <code>--reason TEXT</code> Reason for suppression <code>--expires DATE</code> Expiration date (ISO format)"},{"location":"reference/cli/#suppress-list","title":"<code>suppress list</code>","text":"<pre><code>jnkn suppress list [OPTIONS]\n</code></pre> Option Description <code>--format FMT</code> Output format: table, json, yaml"},{"location":"reference/cli/#suppress-remove","title":"<code>suppress remove</code>","text":"<pre><code>jnkn suppress remove ID\njnkn suppress remove --source PATTERN --target PATTERN\n</code></pre>"},{"location":"reference/cli/#suppress-test","title":"<code>suppress test</code>","text":"<pre><code>jnkn suppress test SOURCE TARGET\n</code></pre>"},{"location":"reference/cli/#jnkn-stats","title":"<code>jnkn stats</code>","text":"<p>Show graph statistics.</p> <pre><code>jnkn stats [OPTIONS]\n</code></pre> Option Description <code>--nodes</code> Show all nodes <code>--edges</code> Show all edges <code>--format FMT</code> Output format: table, json"},{"location":"reference/cli/#jnkn-diff","title":"<code>jnkn diff</code>","text":"<p>Compare dependency graphs between git refs.</p> <pre><code>jnkn diff [REF1]..[REF2] [OPTIONS]\n</code></pre> Option Description <code>--show WHAT</code> Show: all, added, removed <code>--type TYPE</code> Filter by artifact type <code>--format FMT</code> Output format: json, markdown <p>Examples:</p> <pre><code>jnkn diff main..HEAD\njnkn diff main --show added\n</code></pre>"},{"location":"reference/cli/#jnkn-export","title":"<code>jnkn export</code>","text":"<p>Export the dependency graph.</p> <pre><code>jnkn export [OPTIONS]\n</code></pre> Option Default Description <code>--format FMT</code> <code>json</code> Format: json, graphml, dot, csv <code>--type TYPE</code> Filter by artifact type"},{"location":"reference/cli/#jnkn-clear","title":"<code>jnkn clear</code>","text":"<p>Clear all data.</p> <pre><code>jnkn clear [OPTIONS]\n</code></pre> Option Description <code>--force</code> Skip confirmation"},{"location":"reference/cli/#environment-variables","title":"Environment Variables","text":"Variable Description <code>JUNKAN_DB</code> Database path <code>JUNKAN_CONFIG</code> Config file path <code>JUNKAN_MIN_CONFIDENCE</code> Override confidence threshold <code>JUNKAN_LOG_LEVEL</code> Logging level: DEBUG, INFO, WARNING, ERROR"},{"location":"reference/cli/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Configuration error 3 Parse error 10 Impact threshold exceeded (CI mode)"},{"location":"reference/configuration/environment-vars/","title":"Environment Variables","text":"<p>List of supported environment variables.</p>"},{"location":"reference/configuration/junkan-yaml/","title":"config.yaml Reference","text":"<p>Main configuration file at <code>.jnkn/config.yaml</code>.</p>"},{"location":"reference/configuration/junkan-yaml/#full-schema","title":"Full Schema","text":"<pre><code># Jnkn Configuration\n\n# Parsing settings\nparsing:\n  # File extensions to parse (auto-detected if not specified)\n  extensions:\n    python: [\".py\", \".pyi\"]\n    terraform: [\".tf\", \".tfvars\"]\n    kubernetes: [\".yaml\", \".yml\"]\n    javascript: [\".js\", \".ts\", \".mjs\"]\n\n  # Python-specific settings\n  python:\n    # Additional extractors to load\n    extra_extractors:\n      - my_package.MyExtractor\n\n# Stitching settings\nstitching:\n  # Minimum confidence for creating edges (0.0 - 1.0)\n  min_confidence: 0.5\n\n  # Token configuration\n  min_token_length: 3\n\n  # Tokens that provide no signal (ignored in matching)\n  blocked_tokens:\n    - id\n    - key\n    - url\n    - host\n    - port\n\n  # Tokens that reduce confidence when matched alone\n  low_value_tokens:\n    - aws\n    - prod\n    - dev\n    - main\n    - test\n\n  # Confidence calculation weights\n  confidence:\n    signals:\n      exact_match: 1.0\n      normalized_match: 0.9\n      token_overlap_high: 0.85    # &gt; 80% overlap\n      token_overlap_medium: 0.7   # 50-80% overlap\n      suffix_match: 0.6\n      prefix_match: 0.6\n      contains: 0.5\n      single_token: 0.4\n\n    penalties:\n      short_token: 0.5      # Token &lt; 4 chars\n      common_token: 0.7     # Generic words\n      ambiguous: 0.8        # Multiple possible matches\n      low_value: 0.9        # Low-value tokens\n\n  # Per-rule overrides\n  rule_overrides:\n    EnvVarToInfraRule:\n      min_confidence: 0.6\n      blocked_tokens:\n        - host\n    K8sToSecretRule:\n      min_confidence: 0.4\n\n  # Disable specific rules\n  disabled_rules:\n    - SomeUnwantedRule\n\n  # Additional rules to load\n  extra_rules:\n    - my_package.MyRule\n\n# Analysis settings\nanalysis:\n  # Default max depth for blast radius (-1 = unlimited)\n  default_max_depth: -1\n\n  # Include transitive dependencies\n  include_transitive: true\n\n# Storage settings\nstorage:\n  # Database path\n  path: .jnkn/jnkn.db\n\n  # Enable WAL mode for better concurrency\n  wal_mode: true\n\n# Output settings\noutput:\n  # Default output format\n  default_format: json\n\n  # Include metadata in output\n  include_metadata: true\n\n  # Pretty print JSON\n  pretty: true\n\n# Logging\nlogging:\n  level: INFO  # DEBUG, INFO, WARNING, ERROR\n  format: \"%(asctime)s - %(name)s - %(levelname)s - %(message)s\"\n</code></pre>"},{"location":"reference/configuration/junkan-yaml/#minimal-config","title":"Minimal Config","text":"<p>Most settings have sensible defaults. A minimal config:</p> <pre><code>stitching:\n  min_confidence: 0.5\n</code></pre>"},{"location":"reference/configuration/junkan-yaml/#section-reference","title":"Section Reference","text":""},{"location":"reference/configuration/junkan-yaml/#parsing","title":"<code>parsing</code>","text":"<p>Controls how files are discovered and parsed.</p> Key Type Default Description <code>extensions</code> dict auto File extensions per language <code>python.extra_extractors</code> list <code>[]</code> Additional Python extractors"},{"location":"reference/configuration/junkan-yaml/#stitching","title":"<code>stitching</code>","text":"<p>Controls how cross-domain links are created.</p> Key Type Default Description <code>min_confidence</code> float <code>0.5</code> Minimum confidence threshold <code>min_token_length</code> int <code>3</code> Minimum token length <code>blocked_tokens</code> list <code>[]</code> Tokens to ignore <code>low_value_tokens</code> list <code>[]</code> Tokens that reduce confidence <code>confidence.signals</code> dict see above Signal weights <code>confidence.penalties</code> dict see above Penalty multipliers <code>rule_overrides</code> dict <code>{}</code> Per-rule settings <code>disabled_rules</code> list <code>[]</code> Rules to disable <code>extra_rules</code> list <code>[]</code> Additional rules to load"},{"location":"reference/configuration/junkan-yaml/#analysis","title":"<code>analysis</code>","text":"<p>Controls blast radius and other analysis.</p> Key Type Default Description <code>default_max_depth</code> int <code>-1</code> Default traversal depth <code>include_transitive</code> bool <code>true</code> Include transitive deps"},{"location":"reference/configuration/junkan-yaml/#storage","title":"<code>storage</code>","text":"<p>Controls the database.</p> Key Type Default Description <code>path</code> string <code>.jnkn/jnkn.db</code> Database file path <code>wal_mode</code> bool <code>true</code> Enable WAL mode"},{"location":"reference/configuration/junkan-yaml/#output","title":"<code>output</code>","text":"<p>Controls output formatting.</p> Key Type Default Description <code>default_format</code> string <code>json</code> Default output format <code>include_metadata</code> bool <code>true</code> Include extra metadata <code>pretty</code> bool <code>true</code> Pretty print JSON"},{"location":"reference/configuration/junkan-yaml/#logging","title":"<code>logging</code>","text":"<p>Controls logging.</p> Key Type Default Description <code>level</code> string <code>INFO</code> Log level <code>format</code> string see above Log format string"},{"location":"reference/configuration/junkanignore/","title":".jnknignore Reference","text":"<p>Exclude files and directories from scanning.</p>"},{"location":"reference/configuration/junkanignore/#location","title":"Location","text":"<p>Place <code>.jnknignore</code> in your project root (same level as <code>.jnkn/</code>).</p>"},{"location":"reference/configuration/junkanignore/#syntax","title":"Syntax","text":"<p>Uses gitignore-style patterns.</p> <pre><code># Comments start with #\n\n# Ignore specific file\nsecret.py\n\n# Ignore by extension\n*.test.py\n*_test.go\n\n# Ignore directories\nnode_modules/\nvendor/\n__pycache__/\n.git/\n\n# Ignore paths\ntests/fixtures/\ndocs/\n\n# Negate (un-ignore)\n!important.test.py\n\n# Wildcards\n*.min.js\nbuild-*\n\n# Double star (any depth)\n**/generated/**\n</code></pre>"},{"location":"reference/configuration/junkanignore/#pattern-reference","title":"Pattern Reference","text":"Pattern Matches Doesn't Match <code>*.py</code> <code>foo.py</code>, <code>dir/bar.py</code> <code>foo.pyc</code> <code>test_*.py</code> <code>test_foo.py</code> <code>foo_test.py</code> <code>tests/</code> <code>tests/foo.py</code> <code>src/tests.py</code> <code>**/test/**</code> <code>a/test/b.py</code>, <code>test/c.py</code> <code>testing/d.py</code> <code>!important.py</code> (negates previous rule)"},{"location":"reference/configuration/junkanignore/#default-ignores","title":"Default Ignores","text":"<p>Even without <code>.jnknignore</code>, Jnkn skips:</p> <pre><code>.git/\n.hg/\n.svn/\n__pycache__/\n*.pyc\n*.pyo\nnode_modules/\n.terraform/\n</code></pre>"},{"location":"reference/configuration/junkanignore/#examples","title":"Examples","text":""},{"location":"reference/configuration/junkanignore/#python-project","title":"Python Project","text":"<pre><code># Virtual environments\nvenv/\n.venv/\nenv/\n\n# Caches\n__pycache__/\n*.pyc\n.pytest_cache/\n.mypy_cache/\n\n# Tests (optional - you may want to scan these)\ntests/\n*_test.py\ntest_*.py\n\n# Generated\n*.egg-info/\ndist/\nbuild/\n</code></pre>"},{"location":"reference/configuration/junkanignore/#terraform-project","title":"Terraform Project","text":"<pre><code># State files\n*.tfstate\n*.tfstate.backup\n\n# Terraform internals\n.terraform/\n.terraform.lock.hcl\n\n# Environment-specific\nenvironments/dev/\nenvironments/staging/\n</code></pre>"},{"location":"reference/configuration/junkanignore/#monorepo","title":"Monorepo","text":"<pre><code># Third-party\nvendor/\nnode_modules/\n\n# Generated code\n**/generated/\n**/*.pb.go\n\n# Documentation\ndocs/\n\n# Specific services to skip\nservices/deprecated-*/\n</code></pre>"},{"location":"reference/configuration/junkanignore/#precedence","title":"Precedence","text":"<ol> <li>Built-in defaults (lowest)</li> <li><code>.jnknignore</code> in project root</li> <li><code>--exclude</code> CLI flag (highest)</li> </ol>"},{"location":"reference/configuration/junkanignore/#debugging","title":"Debugging","text":"<p>See what's being ignored:</p> <pre><code>jnkn scan --verbose\n</code></pre> <p>Output shows:</p> <pre><code>Ignored: tests/test_foo.py (matched: tests/)\nIgnored: build/output.py (matched: build/)\nScanning: src/main.py\n</code></pre>"},{"location":"reference/configuration/suppressions-yaml/","title":"suppressions.yaml Reference","text":"<p>Manage false positive suppressions at <code>.jnkn/suppressions.yaml</code>.</p>"},{"location":"reference/configuration/suppressions-yaml/#schema","title":"Schema","text":"<pre><code>suppressions:\n  - id: 1\n    source_pattern: \"env:*_ID\"\n    target_pattern: \"infra:*\"\n    reason: \"ID fields are too generic for matching\"\n    enabled: true\n    expires: null\n    created_at: \"2024-01-15T10:30:00Z\"\n    created_by: \"user@example.com\"\n\n  - id: 2\n    source_pattern: \"env:HOST\"\n    target_pattern: \"infra:ghost_*\"\n    reason: \"ghost_writer is unrelated logging service\"\n    enabled: true\n    expires: \"2024-06-01\"\n    created_at: \"2024-01-15T10:35:00Z\"\n    created_by: null\n</code></pre>"},{"location":"reference/configuration/suppressions-yaml/#fields","title":"Fields","text":"Field Type Required Description <code>id</code> integer yes Unique identifier <code>source_pattern</code> string yes Glob pattern for source artifact <code>target_pattern</code> string yes Glob pattern for target artifact <code>reason</code> string no Why this suppression exists <code>enabled</code> boolean no Whether suppression is active (default: true) <code>expires</code> string no ISO 8601 date when suppression expires <code>created_at</code> string no ISO 8601 timestamp of creation <code>created_by</code> string no Who created this suppression"},{"location":"reference/configuration/suppressions-yaml/#glob-patterns","title":"Glob Patterns","text":"Pattern Matches <code>*</code> Any characters <code>?</code> Single character <code>[abc]</code> Character class <code>[!abc]</code> Negated character class"},{"location":"reference/configuration/suppressions-yaml/#examples","title":"Examples","text":"Pattern Matches Doesn't Match <code>env:*</code> <code>env:X</code>, <code>env:DATABASE_URL</code> <code>infra:X</code> <code>env:DB_*</code> <code>env:DB_HOST</code>, <code>env:DB_PORT</code> <code>env:DATABASE</code> <code>*_URL</code> <code>env:DATABASE_URL</code>, <code>infra:api_url</code> <code>env:URL_PREFIX</code> <code>env:???</code> <code>env:ABC</code>, <code>env:XYZ</code> <code>env:ABCD</code> <code>env:[A-Z]*</code> <code>env:ABC</code> <code>env:abc</code>"},{"location":"reference/configuration/suppressions-yaml/#order-of-evaluation","title":"Order of Evaluation","text":"<p>Suppressions are evaluated in order. First match wins.</p> <pre><code>suppressions:\n  # This matches first\n  - source_pattern: \"env:DATABASE_URL\"\n    target_pattern: \"infra:main_db\"\n    reason: \"Specific exception\"\n    enabled: true\n\n  # This is more general but evaluated second\n  - source_pattern: \"env:*\"\n    target_pattern: \"infra:*\"\n    reason: \"Broad suppression\"\n    enabled: true\n</code></pre>"},{"location":"reference/configuration/suppressions-yaml/#expiration","title":"Expiration","text":"<p>Suppressions can expire:</p> <pre><code>- source_pattern: \"env:TEMP_*\"\n  target_pattern: \"*\"\n  reason: \"Temporary during migration\"\n  expires: \"2024-06-01\"  # Ignored after this date\n</code></pre> <p>Expired suppressions remain in the file but are not applied.</p>"},{"location":"reference/configuration/suppressions-yaml/#disabling","title":"Disabling","text":"<p>Disable without removing:</p> <pre><code>- source_pattern: \"env:X\"\n  target_pattern: \"infra:Y\"\n  enabled: false  # Kept for reference but not applied\n</code></pre>"},{"location":"reference/configuration/suppressions-yaml/#managing-via-cli","title":"Managing via CLI","text":"<pre><code># Add\njnkn suppress add \"env:*_ID\" \"infra:*\" --reason \"Generic\"\n\n# List\njnkn suppress list\n\n# Remove\njnkn suppress remove 1\n\n# Enable/disable\njnkn suppress disable 2\njnkn suppress enable 2\n\n# Test\njnkn suppress test env:USER_ID infra:user_service\n</code></pre>"},{"location":"reference/configuration/suppressions-yaml/#best-practices","title":"Best Practices","text":"<ol> <li>Always add a reason \u2014 Future you will thank you</li> <li>Use specific patterns \u2014 Avoid <code>*</code> \u2192 <code>*</code></li> <li>Set expiration for temporary suppressions</li> <li>Commit to version control \u2014 Share with team</li> <li>Review periodically \u2014 Remove stale suppressions</li> </ol>"},{"location":"reference/output-formats/csv/","title":"CSV","text":"<p>CSV output format.</p>"},{"location":"reference/output-formats/json-schema/","title":"JSON Output Schema","text":"<p>Reference for Jnkn's JSON output formats.</p>"},{"location":"reference/output-formats/json-schema/#blast-radius","title":"Blast Radius","text":"<pre><code>jnkn blast env:DATABASE_URL --format json\n</code></pre> <pre><code>{\n  \"source_artifacts\": [\"env:DATABASE_URL\"],\n  \"total_impacted_count\": 5,\n  \"impacted_artifacts\": [\n    \"file://src/db/connection.py\",\n    \"file://src/api/users.py\",\n    \"infra:aws_db_instance.main\",\n    \"k8s:default/deployment/api\",\n    \"k8s:default/secret/db-creds\"\n  ],\n  \"breakdown\": {\n    \"code\": [\n      \"file://src/db/connection.py\",\n      \"file://src/api/users.py\"\n    ],\n    \"infra\": [\n      \"infra:aws_db_instance.main\"\n    ],\n    \"k8s\": [\n      \"k8s:default/deployment/api\",\n      \"k8s:default/secret/db-creds\"\n    ],\n    \"env\": [],\n    \"data\": []\n  },\n  \"max_depth_reached\": 2,\n  \"paths\": [\n    {\n      \"target\": \"file://src/db/connection.py\",\n      \"path\": [\"env:DATABASE_URL\", \"file://src/db/connection.py\"],\n      \"depth\": 1\n    }\n  ]\n}\n</code></pre>"},{"location":"reference/output-formats/json-schema/#fields","title":"Fields","text":"Field Type Description <code>source_artifacts</code> string[] Input artifact IDs <code>total_impacted_count</code> integer Total downstream artifacts <code>impacted_artifacts</code> string[] All impacted artifact IDs <code>breakdown</code> object Artifacts grouped by type <code>max_depth_reached</code> integer Deepest traversal level <code>paths</code> object[] (Optional) Paths to each artifact"},{"location":"reference/output-formats/json-schema/#stats","title":"Stats","text":"<pre><code>jnkn stats --format json\n</code></pre> <pre><code>{\n  \"version\": \"0.1.0\",\n  \"schema_version\": 2,\n  \"database_path\": \".jnkn/jnkn.db\",\n  \"database_size_bytes\": 124500,\n  \"total_nodes\": 156,\n  \"total_edges\": 97,\n  \"tracked_files\": 47,\n  \"nodes_by_type\": {\n    \"code_file\": 42,\n    \"env_var\": 12,\n    \"infra_resource\": 8,\n    \"k8s_resource\": 6\n  },\n  \"edges_by_type\": {\n    \"reads\": 45,\n    \"imports\": 32,\n    \"provides\": 12,\n    \"configures\": 8\n  },\n  \"cross_domain_edges\": 8,\n  \"last_scan\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre>"},{"location":"reference/output-formats/json-schema/#explain","title":"Explain","text":"<pre><code>jnkn explain env:DB_HOST infra:db_host --format json\n</code></pre> <pre><code>{\n  \"source\": {\n    \"id\": \"env:DB_HOST\",\n    \"type\": \"env_var\",\n    \"tokens\": [\"db\", \"host\"]\n  },\n  \"target\": {\n    \"id\": \"infra:db_host\",\n    \"type\": \"infra_resource\",\n    \"tokens\": [\"db\", \"host\"]\n  },\n  \"confidence\": {\n    \"score\": 0.85,\n    \"level\": \"HIGH\",\n    \"signals\": [\n      {\n        \"name\": \"normalized_match\",\n        \"weight\": 0.9,\n        \"description\": \"'dbhost' == 'dbhost'\"\n      }\n    ],\n    \"penalties\": [\n      {\n        \"name\": \"short_token\",\n        \"multiplier\": 0.95,\n        \"description\": \"Token 'db' is only 2 chars\"\n      }\n    ]\n  },\n  \"matched_tokens\": [\"db\", \"host\"],\n  \"would_create_edge\": true,\n  \"suppressed\": false\n}\n</code></pre>"},{"location":"reference/output-formats/json-schema/#diff","title":"Diff","text":"<pre><code>jnkn diff main..HEAD --format json\n</code></pre> <pre><code>{\n  \"base_ref\": \"main\",\n  \"target_ref\": \"HEAD\",\n  \"summary\": {\n    \"nodes_added\": 3,\n    \"nodes_removed\": 1,\n    \"edges_added\": 5,\n    \"edges_removed\": 2\n  },\n  \"added_nodes\": [\n    {\n      \"id\": \"env:NEW_VAR\",\n      \"type\": \"env_var\",\n      \"metadata\": {\n        \"file\": \"src/config.py\",\n        \"line\": 15\n      }\n    }\n  ],\n  \"removed_nodes\": [\n    {\n      \"id\": \"env:OLD_VAR\",\n      \"type\": \"env_var\"\n    }\n  ],\n  \"added_edges\": [\n    {\n      \"source\": \"file://src/new.py\",\n      \"target\": \"env:NEW_VAR\",\n      \"type\": \"reads\"\n    }\n  ],\n  \"removed_edges\": [\n    {\n      \"source\": \"file://src/old.py\",\n      \"target\": \"env:OLD_VAR\",\n      \"type\": \"reads\"\n    }\n  ]\n}\n</code></pre>"},{"location":"reference/output-formats/json-schema/#export-full-graph","title":"Export (Full Graph)","text":"<pre><code>jnkn export --format json\n</code></pre> <pre><code>{\n  \"version\": \"0.1.0\",\n  \"exported_at\": \"2024-01-15T10:30:00Z\",\n  \"nodes\": [\n    {\n      \"id\": \"env:DATABASE_URL\",\n      \"name\": \"DATABASE_URL\",\n      \"type\": \"env_var\",\n      \"metadata\": {\n        \"source\": \"os.getenv\",\n        \"file\": \"src/config.py\",\n        \"line\": 10\n      }\n    },\n    {\n      \"id\": \"file://src/config.py\",\n      \"name\": \"config.py\",\n      \"type\": \"code_file\",\n      \"path\": \"src/config.py\",\n      \"language\": \"python\",\n      \"file_hash\": \"abc123...\"\n    }\n  ],\n  \"edges\": [\n    {\n      \"source\": \"file://src/config.py\",\n      \"target\": \"env:DATABASE_URL\",\n      \"type\": \"reads\",\n      \"metadata\": {\n        \"pattern\": \"os.getenv\",\n        \"confidence\": 1.0\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"reference/output-formats/json-schema/#node-types","title":"Node Types","text":"Type Description <code>code_file</code> Source code file <code>code_entity</code> Function/class definition <code>env_var</code> Environment variable <code>infra_resource</code> Terraform resource <code>k8s_resource</code> Kubernetes resource <code>data_asset</code> dbt model/source <code>unknown</code> Unresolved reference"},{"location":"reference/output-formats/json-schema/#edge-types","title":"Edge Types","text":"Type Description <code>reads</code> Source reads from target <code>imports</code> Source imports target <code>provides</code> Source provides target <code>configures</code> Source configures target <code>contains</code> Source contains target <code>references</code> Generic reference"},{"location":"reference/output-formats/sarif/","title":"SARIF","text":"<p>SARIF output format.</p>"},{"location":"reference/patterns/","title":"Supported Patterns","text":"<p>Jnkn detects environment variables and configuration patterns across multiple languages and frameworks.</p>"},{"location":"reference/patterns/#how-detection-works","title":"How Detection Works","text":"<ol> <li>Parse \u2014 Tree-sitter parses source code into an AST</li> <li>Extract \u2014 Pattern extractors find specific code patterns</li> <li>Normalize \u2014 Variable names are tokenized for matching</li> </ol> <pre><code>graph LR\n    F[Source File] --&gt; P[Parser]\n    P --&gt; A[AST]\n    A --&gt; E1[Extractor 1]\n    A --&gt; E2[Extractor 2]\n    A --&gt; E3[Extractor N]\n    E1 --&gt; N[Nodes]\n    E2 --&gt; N\n    E3 --&gt; N</code></pre>"},{"location":"reference/patterns/#supported-languages","title":"Supported Languages","text":"Language Patterns Status Python os.getenv, Pydantic, Click, django-environ \u2705 Full Terraform Resources, variables, outputs \u2705 Full Kubernetes ConfigMaps, Secrets, env vars \u2705 Full JavaScript process.env, dotenv \ud83d\udea7 Beta dbt ref(), source(), var() \u2705 Full"},{"location":"reference/patterns/#adding-new-patterns","title":"Adding New Patterns","text":"<p>If Jnkn doesn't detect your pattern:</p> <ol> <li>Check if it's a supported variation</li> <li>File a GitHub issue with an example</li> <li>Or write a custom extractor</li> </ol>"},{"location":"reference/patterns/#detection-confidence","title":"Detection Confidence","text":"<p>Each pattern has inherent confidence:</p> Source Base Confidence Notes Explicit (<code>os.getenv(\"VAR\")</code>) 1.0 Direct reference Framework (<code>Field(env=\"VAR\")</code>) 0.95 Framework-specific Inferred (Pydantic field name) 0.85 Name \u2192 env var mapping Heuristic (<code>DATABASE_URL = ...</code>) 0.7 Pattern-based guess"},{"location":"reference/patterns/#testing-detection","title":"Testing Detection","text":"<p>Check if a pattern is detected:</p> <pre><code>jnkn scan --verbose --files myfile.py\n</code></pre> <p>Or test in Python:</p> <pre><code>from jnkn.parsing.python import PythonParser\n\nparser = PythonParser()\ncontent = b'DATABASE_URL = os.getenv(\"DATABASE_URL\")'\n\nfor item in parser.parse(Path(\"test.py\"), content):\n    print(item)\n</code></pre>"},{"location":"reference/patterns/dbt-refs/","title":"dbt Patterns","text":"<p>Supported dbt references.</p>"},{"location":"reference/patterns/javascript-env-vars/","title":"JavaScript Patterns","text":"<p>Supported JavaScript patterns.</p>"},{"location":"reference/patterns/kubernetes-refs/","title":"Kubernetes Reference Patterns","text":"<p>All Kubernetes patterns Jnkn detects.</p>"},{"location":"reference/patterns/kubernetes-refs/#environment-variables","title":"Environment Variables","text":""},{"location":"reference/patterns/kubernetes-refs/#direct-values","title":"Direct Values","text":"<pre><code># \u2705 Detected as env:DATABASE_URL\nenv:\n  - name: DATABASE_URL\n    value: \"postgresql://localhost/db\"\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#configmap-references","title":"ConfigMap References","text":"<pre><code># \u2705 Detected as env:DATABASE_HOST\n# \u2705 Creates edge to k8s:default/configmap/app-config\nenv:\n  - name: DATABASE_HOST\n    valueFrom:\n      configMapKeyRef:\n        name: app-config\n        key: db-host\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#secret-references","title":"Secret References","text":"<pre><code># \u2705 Detected as env:DATABASE_PASSWORD\n# \u2705 Creates edge to k8s:default/secret/app-secrets\nenv:\n  - name: DATABASE_PASSWORD\n    valueFrom:\n      secretKeyRef:\n        name: app-secrets\n        key: db-password\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#field-references","title":"Field References","text":"<pre><code># \u2705 Detected as env:POD_NAME\nenv:\n  - name: POD_NAME\n    valueFrom:\n      fieldRef:\n        fieldPath: metadata.name\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#envfrom","title":"envFrom","text":""},{"location":"reference/patterns/kubernetes-refs/#all-keys-from-configmap","title":"All Keys from ConfigMap","text":"<pre><code># \u2705 Creates edge to k8s:default/configmap/app-config\nenvFrom:\n  - configMapRef:\n      name: app-config\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#all-keys-from-secret","title":"All Keys from Secret","text":"<pre><code># \u2705 Creates edge to k8s:default/secret/app-secrets\nenvFrom:\n  - secretRef:\n      name: app-secrets\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#workload-types","title":"Workload Types","text":"<p>Jnkn parses these Kubernetes resources:</p> Kind Detected Deployment \u2705 StatefulSet \u2705 DaemonSet \u2705 Job \u2705 CronJob \u2705 Pod \u2705 ReplicaSet \u2705"},{"location":"reference/patterns/kubernetes-refs/#node-id-format","title":"Node ID Format","text":"<pre><code>k8s:{namespace}/{kind}/{name}\n</code></pre> <p>Examples: - <code>k8s:default/deployment/api-server</code> - <code>k8s:production/statefulset/database</code> - <code>k8s:default/configmap/app-config</code> - <code>k8s:default/secret/app-secrets</code></p>"},{"location":"reference/patterns/kubernetes-refs/#dependencies-detected","title":"Dependencies Detected","text":""},{"location":"reference/patterns/kubernetes-refs/#workload-configmap","title":"Workload \u2192 ConfigMap","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\n  namespace: default\nspec:\n  template:\n    spec:\n      containers:\n        - name: api\n          envFrom:\n            - configMapRef:\n                name: api-config\n# Edge: k8s:default/deployment/api-server \u2192 k8s:default/configmap/api-config\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#workload-secret","title":"Workload \u2192 Secret","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  template:\n    spec:\n      containers:\n        - name: api\n          env:\n            - name: DB_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: db-creds\n                  key: password\n# Edge: k8s:default/deployment/api-server \u2192 k8s:default/secret/db-creds\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#workload-serviceaccount","title":"Workload \u2192 ServiceAccount","text":"<pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  template:\n    spec:\n      serviceAccountName: api-sa\n# Edge: k8s:default/deployment/api-server \u2192 k8s:default/serviceaccount/api-sa\n</code></pre>"},{"location":"reference/patterns/kubernetes-refs/#cross-domain-matching","title":"Cross-Domain Matching","text":"<p>K8s env vars are matched to other domains:</p> K8s Env Var Python Confidence <code>DATABASE_URL</code> <code>os.getenv(\"DATABASE_URL\")</code> HIGH (0.95) <code>API_KEY</code> <code>env:API_KEY</code> HIGH (0.90) K8s ConfigMap Terraform Confidence <code>api-config</code> <code>infra:aws_ssm_parameter.api_config</code> MEDIUM (0.75)"},{"location":"reference/patterns/kubernetes-refs/#multi-document-yaml","title":"Multi-Document YAML","text":"<p>Jnkn handles multi-document YAML files:</p> <pre><code>---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: app-config\ndata:\n  DATABASE_HOST: \"localhost\"\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: app\nspec:\n  template:\n    spec:\n      containers:\n        - name: app\n          envFrom:\n            - configMapRef:\n                name: app-config\n</code></pre> <p>Both resources are detected and linked.</p>"},{"location":"reference/patterns/kubernetes-refs/#not-detected","title":"Not Detected","text":"<pre><code># \u274c Helm templates (pre-rendered)\nenv:\n  - name: {{ .Values.envName }}\n    value: {{ .Values.envValue }}\n\n# \u274c Kustomize patches (pre-rendered)\n# Process with helm template or kustomize build first\n</code></pre>"},{"location":"reference/patterns/python-env-vars/","title":"Python Environment Variable Patterns","text":"<p>All Python patterns Jnkn detects.</p>"},{"location":"reference/patterns/python-env-vars/#standard-library","title":"Standard Library","text":""},{"location":"reference/patterns/python-env-vars/#osgetenv","title":"<code>os.getenv()</code>","text":"<pre><code># \u2705 Detected\nos.getenv(\"DATABASE_URL\")\nos.getenv(\"DATABASE_URL\", \"default\")\nos.getenv(\"DATABASE_URL\", default=\"default\")\n\n# \u274c Not detected (dynamic key)\nkey = \"DATABASE_URL\"\nos.getenv(key)\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#osenvironget","title":"<code>os.environ.get()</code>","text":"<pre><code># \u2705 Detected\nos.environ.get(\"DATABASE_URL\")\nos.environ.get(\"DATABASE_URL\", \"default\")\n\n# \u274c Not detected\nos.environ.get(key)\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#osenviron","title":"<code>os.environ[]</code>","text":"<pre><code># \u2705 Detected\nos.environ[\"DATABASE_URL\"]\n\n# \u274c Not detected\nos.environ[key]\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#from-imports","title":"From-imports","text":"<pre><code>from os import getenv, environ\n\n# \u2705 Detected\ngetenv(\"DATABASE_URL\")\nenviron.get(\"DATABASE_URL\")\nenviron[\"DATABASE_URL\"]\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#pydantic-settings","title":"Pydantic Settings","text":""},{"location":"reference/patterns/python-env-vars/#basesettings-fields","title":"BaseSettings Fields","text":"<pre><code>from pydantic_settings import BaseSettings\n\nclass Settings(BaseSettings):\n    # \u2705 Detected as env:DATABASE_URL\n    database_url: str\n\n    # \u2705 Detected as env:API_KEY\n    api_key: str = \"default\"\n\n    # \u2705 Detected as env:DEBUG\n    debug: bool = False\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#field-with-env","title":"Field with <code>env=</code>","text":"<pre><code>from pydantic import Field\nfrom pydantic_settings import BaseSettings\n\nclass Settings(BaseSettings):\n    # \u2705 Detected as env:DB_URL (explicit override)\n    database_url: str = Field(env=\"DB_URL\")\n\n    # \u2705 Detected as env:MY_API_KEY\n    api_key: str = Field(env=\"MY_API_KEY\")\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#env_prefix","title":"<code>env_prefix</code>","text":"<pre><code>class Settings(BaseSettings):\n    # \u2705 Detected as env:APP_DATABASE_URL\n    database_url: str\n\n    # \u2705 Detected as env:APP_DEBUG\n    debug: bool = False\n\n    class Config:\n        env_prefix = \"APP_\"\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#model_config","title":"<code>model_config</code>","text":"<pre><code>class Settings(BaseSettings):\n    database_url: str  # \u2705 env:MYAPP_DATABASE_URL\n\n    model_config = SettingsConfigDict(env_prefix=\"MYAPP_\")\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#click-typer","title":"Click / Typer","text":""},{"location":"reference/patterns/python-env-vars/#click-envvar","title":"Click <code>envvar=</code>","text":"<pre><code>import click\n\n@click.command()\n@click.option(\"--host\", envvar=\"API_HOST\")  # \u2705 Detected\n@click.option(\"--port\", envvar=\"API_PORT\", type=int)  # \u2705 Detected\n@click.option(\"--db\", envvar=[\"DB_URL\", \"DATABASE_URL\"])  # \u2705 Both detected\ndef main(host, port, db):\n    pass\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#typer-envvar","title":"Typer <code>envvar=</code>","text":"<pre><code>import typer\n\napp = typer.Typer()\n\n@app.command()\ndef main(\n    host: str = typer.Option(..., envvar=\"API_HOST\"),  # \u2705 Detected\n    port: int = typer.Option(8080, envvar=\"API_PORT\"),  # \u2705 Detected\n):\n    pass\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#django-environ","title":"django-environ","text":""},{"location":"reference/patterns/python-env-vars/#environenv","title":"<code>environ.Env()</code>","text":"<pre><code>import environ\n\nenv = environ.Env()\n\n# \u2705 All detected\nDEBUG = env(\"DEBUG\")\nDATABASE_URL = env.db(\"DATABASE_URL\")\nSECRET_KEY = env.str(\"SECRET_KEY\")\nALLOWED_HOSTS = env.list(\"ALLOWED_HOSTS\")\nCACHE_URL = env.cache(\"CACHE_URL\")\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#type-methods","title":"Type Methods","text":"Method Example Detected As <code>env()</code> <code>env(\"VAR\")</code> <code>env:VAR</code> <code>env.str()</code> <code>env.str(\"VAR\")</code> <code>env:VAR</code> <code>env.bool()</code> <code>env.bool(\"VAR\")</code> <code>env:VAR</code> <code>env.int()</code> <code>env.int(\"VAR\")</code> <code>env:VAR</code> <code>env.float()</code> <code>env.float(\"VAR\")</code> <code>env:VAR</code> <code>env.list()</code> <code>env.list(\"VAR\")</code> <code>env:VAR</code> <code>env.dict()</code> <code>env.dict(\"VAR\")</code> <code>env:VAR</code> <code>env.url()</code> <code>env.url(\"VAR\")</code> <code>env:VAR</code> <code>env.db()</code> <code>env.db(\"VAR\")</code> <code>env:VAR</code> <code>env.cache()</code> <code>env.cache(\"VAR\")</code> <code>env:VAR</code>"},{"location":"reference/patterns/python-env-vars/#python-dotenv","title":"python-dotenv","text":""},{"location":"reference/patterns/python-env-vars/#dotenv_values","title":"<code>dotenv_values()</code>","text":"<pre><code>from dotenv import dotenv_values\n\nconfig = dotenv_values(\".env\")\n\n# \u2705 Detected\nDATABASE_URL = config[\"DATABASE_URL\"]\nAPI_KEY = config.get(\"API_KEY\")\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#environs","title":"environs","text":"<pre><code>from environs import Env\n\nenv = Env()\nenv.read_env()\n\n# \u2705 All detected\nDEBUG = env.bool(\"DEBUG\")\nDATABASE_URL = env.str(\"DATABASE_URL\")\nPORT = env.int(\"PORT\", 8080)\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#heuristic-detection","title":"Heuristic Detection","text":"<p>Jnkn uses heuristics for patterns that look like env vars:</p> <pre><code># \u2705 Detected (heuristic, lower confidence)\nDATABASE_URL = some_config.get(\"DATABASE_URL\")\nAPI_KEY = settings[\"API_KEY\"]\n\n# These variable names suggest env vars:\n# *_URL, *_HOST, *_PORT, *_KEY, *_SECRET, *_TOKEN, *_PASSWORD\n</code></pre>"},{"location":"reference/patterns/python-env-vars/#not-detected","title":"Not Detected","text":"<pre><code># \u274c Dynamic keys\nkey = \"DATABASE_URL\"\nos.getenv(key)\n\n# \u274c Computed keys\nos.getenv(f\"PREFIX_{suffix}\")\n\n# \u274c Comments\n# os.getenv(\"DATABASE_URL\")\n\n# \u274c Strings\ndoc = 'Use os.getenv(\"DATABASE_URL\")'\n\n# \u274c Different module named os\nimport mypackage.os as os\nos.getenv(\"VAR\")  # Not stdlib\n</code></pre>"},{"location":"reference/patterns/terraform-resources/","title":"Terraform Resource Patterns","text":"<p>All Terraform patterns Jnkn detects.</p>"},{"location":"reference/patterns/terraform-resources/#resources","title":"Resources","text":"<pre><code># \u2705 Detected as infra:aws_db_instance.main\nresource \"aws_db_instance\" \"main\" {\n  identifier = \"my-database\"\n  engine     = \"postgres\"\n}\n\n# \u2705 Detected as infra:aws_s3_bucket.data\nresource \"aws_s3_bucket\" \"data\" {\n  bucket = \"my-data-bucket\"\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#node-id-format","title":"Node ID Format","text":"<pre><code>infra:{resource_type}.{resource_name}\n</code></pre> <p>Examples: - <code>infra:aws_db_instance.main</code> - <code>infra:aws_s3_bucket.logs</code> - <code>infra:google_compute_instance.web</code></p>"},{"location":"reference/patterns/terraform-resources/#variables","title":"Variables","text":"<pre><code># \u2705 Detected as infra:var.database_url\nvariable \"database_url\" {\n  type        = string\n  description = \"Database connection URL\"\n}\n\n# \u2705 Detected as infra:var.api_key\nvariable \"api_key\" {\n  type      = string\n  sensitive = true\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#node-id-format_1","title":"Node ID Format","text":"<pre><code>infra:var.{variable_name}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#outputs","title":"Outputs","text":"<pre><code># \u2705 Detected as infra:output.database_endpoint\noutput \"database_endpoint\" {\n  value = aws_db_instance.main.endpoint\n}\n\n# \u2705 Detected as infra:output.bucket_arn\noutput \"bucket_arn\" {\n  value = aws_s3_bucket.data.arn\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#node-id-format_2","title":"Node ID Format","text":"<pre><code>infra:output.{output_name}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#data-sources","title":"Data Sources","text":"<pre><code># \u2705 Detected as infra:data.aws_ami.ubuntu\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n  owners      = [\"099720109477\"]\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#node-id-format_3","title":"Node ID Format","text":"<pre><code>infra:data.{data_type}.{data_name}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#locals","title":"Locals","text":"<pre><code># \u2705 Detected as infra:local.database_host\nlocals {\n  database_host = var.database_url\n  api_endpoint  = \"https://${var.domain}/api\"\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#node-id-format_4","title":"Node ID Format","text":"<pre><code>infra:local.{local_name}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#modules","title":"Modules","text":"<pre><code># \u2705 Detected as infra:module.vpc\nmodule \"vpc\" {\n  source = \"./modules/vpc\"\n\n  cidr_block = var.vpc_cidr\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#node-id-format_5","title":"Node ID Format","text":"<pre><code>infra:module.{module_name}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#dependencies-detected","title":"Dependencies Detected","text":"<p>Jnkn creates edges for:</p>"},{"location":"reference/patterns/terraform-resources/#variable-references","title":"Variable References","text":"<pre><code>resource \"aws_instance\" \"web\" {\n  ami = var.ami_id  # Edge: infra:aws_instance.web \u2192 infra:var.ami_id\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#resource-references","title":"Resource References","text":"<pre><code>resource \"aws_security_group_rule\" \"allow\" {\n  security_group_id = aws_security_group.main.id\n  # Edge: infra:aws_security_group_rule.allow \u2192 infra:aws_security_group.main\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#output-references","title":"Output References","text":"<pre><code>output \"instance_ip\" {\n  value = aws_instance.web.public_ip\n  # Edge: infra:output.instance_ip \u2192 infra:aws_instance.web\n}\n</code></pre>"},{"location":"reference/patterns/terraform-resources/#cross-domain-matching","title":"Cross-Domain Matching","text":"<p>Terraform resources are matched to env vars via token matching:</p> Terraform Env Var Match Confidence <code>aws_db_instance.main_db</code> <code>env:MAIN_DB_HOST</code> HIGH (0.85) <code>output.database_url</code> <code>env:DATABASE_URL</code> HIGH (0.92) <code>var.api_key</code> <code>env:API_KEY</code> HIGH (0.90)"},{"location":"reference/patterns/terraform-resources/#not-detected","title":"Not Detected","text":"<pre><code># \u274c Dynamic blocks (partial support)\ndynamic \"setting\" {\n  for_each = var.settings\n  content {\n    name  = setting.value.name\n    value = setting.value.value\n  }\n}\n\n# \u274c Complex expressions\nlocals {\n  name = var.enabled ? \"prod\" : \"dev\"\n}\n</code></pre>"},{"location":"tutorials/","title":"Tutorials","text":"<p>Step-by-step guides to learn Jnkn from basics to advanced usage.</p>"},{"location":"tutorials/#learning-path","title":"Learning Path","text":"<pre><code>graph LR\n    B[Beginner] --&gt; I[Intermediate] --&gt; A[Advanced]\n\n    B --&gt; B1[Scan Python]\n    B --&gt; B2[Blast Radius]\n    B --&gt; B3[Fix False Positives]\n\n    I --&gt; I1[Multi-Stack]\n    I --&gt; I2[CI/CD]\n\n    A --&gt; A1[Custom Parsers]\n    A --&gt; A2[Custom Rules]</code></pre>"},{"location":"tutorials/#beginner","title":"Beginner","text":"<p>Start here if you're new to Jnkn.</p> Tutorial Time What You'll Learn Scanning a Python Project 10 min Detect env vars in FastAPI/Django Understanding Blast Radius 15 min Read and interpret results Fixing False Positives 10 min Suppressions and tuning"},{"location":"tutorials/#intermediate","title":"Intermediate","text":"<p>For teams integrating Jnkn into workflows.</p> Tutorial Time What You'll Learn Multi-Stack Analysis 20 min Python + Terraform + dbt CI/CD Integration 25 min Full pipeline setup"},{"location":"tutorials/#advanced","title":"Advanced","text":"<p>Extend Jnkn for your specific needs.</p> Tutorial Time What You'll Learn Custom Parsers 30 min Add new language support Custom Stitching Rules 30 min Domain-specific matching"},{"location":"tutorials/advanced/custom-parsers/","title":"Custom Parsers","text":"<p>Extend Jnkn to detect patterns in new languages or frameworks.</p> <p>Time: 30 minutes</p>"},{"location":"tutorials/advanced/custom-parsers/#when-to-write-a-custom-parser","title":"When to Write a Custom Parser","text":"<ul> <li>Your framework has unique configuration patterns</li> <li>You use an unsupported language</li> <li>You have internal conventions Jnkn doesn't recognize</li> </ul>"},{"location":"tutorials/advanced/custom-parsers/#architecture","title":"Architecture","text":"<pre><code>graph TD\n    F[File] --&gt; E{Extractor&lt;br/&gt;Registry}\n    E --&gt; E1[StdlibExtractor]\n    E --&gt; E2[PydanticExtractor]\n    E --&gt; E3[YourExtractor]\n    E1 --&gt; N[Nodes + Edges]\n    E2 --&gt; N\n    E3 --&gt; N</code></pre> <p>Parsers are composed of Extractors \u2014 small, focused classes that detect specific patterns.</p>"},{"location":"tutorials/advanced/custom-parsers/#creating-an-extractor","title":"Creating an Extractor","text":""},{"location":"tutorials/advanced/custom-parsers/#step-1-define-the-extractor","title":"Step 1: Define the Extractor","text":"<p>Create <code>my_extractors/internal_config.py</code>:</p> <pre><code>\"\"\"Extractor for internal @config decorator pattern.\"\"\"\n\nfrom pathlib import Path\nfrom typing import Generator, Optional, Set, Union\nimport re\n\nfrom jnkn.parsing.python.extractors.base import BaseExtractor\nfrom jnkn.core.types import Node, Edge, NodeType, RelationshipType\n\n\nclass InternalConfigExtractor(BaseExtractor):\n    \"\"\"\n    Detects env vars from internal @config decorator.\n\n    Pattern:\n        @config(env=\"DATABASE_URL\", required=True)\n        def get_database_url() -&gt; str:\n            ...\n    \"\"\"\n\n    @property\n    def name(self) -&gt; str:\n        return \"internal_config\"\n\n    @property\n    def priority(self) -&gt; int:\n        return 75  # Between stdlib (100) and heuristic (10)\n\n    # Regex pattern for the decorator\n    PATTERN = re.compile(\n        r'@config\\s*\\(\\s*env\\s*=\\s*[\"\\']([^\"\\']+)[\"\\']',\n        re.MULTILINE\n    )\n\n    def can_extract(self, text: str) -&gt; bool:\n        \"\"\"Quick check if this file uses @config.\"\"\"\n        return \"@config\" in text and \"env=\" in text\n\n    def extract(\n        self,\n        file_path: Path,\n        file_id: str,\n        tree,  # tree-sitter AST (optional)\n        text: str,\n        seen_vars: Set[str],\n    ) -&gt; Generator[Union[Node, Edge], None, None]:\n        \"\"\"Extract env vars from @config decorators.\"\"\"\n\n        for match in self.PATTERN.finditer(text):\n            var_name = match.group(1)\n\n            # Skip if already detected by another extractor\n            if var_name in seen_vars:\n                continue\n\n            # Calculate line number\n            line = text[:match.start()].count('\\n') + 1\n\n            env_id = f\"env:{var_name}\"\n\n            # Yield the env var node\n            yield Node(\n                id=env_id,\n                name=var_name,\n                type=NodeType.ENV_VAR,\n                metadata={\n                    \"source\": self.name,\n                    \"file\": str(file_path),\n                    \"line\": line,\n                },\n            )\n\n            # Yield edge: file reads this env var\n            yield Edge(\n                source_id=file_id,\n                target_id=env_id,\n                type=RelationshipType.READS,\n                metadata={\"pattern\": self.name},\n            )\n</code></pre>"},{"location":"tutorials/advanced/custom-parsers/#step-2-register-the-extractor","title":"Step 2: Register the Extractor","text":"<p>Create <code>my_extractors/__init__.py</code>:</p> <pre><code>from .internal_config import InternalConfigExtractor\n\nCUSTOM_EXTRACTORS = [InternalConfigExtractor]\n</code></pre>"},{"location":"tutorials/advanced/custom-parsers/#step-3-configure-jnkn","title":"Step 3: Configure Jnkn","text":"<p>In <code>.jnkn/config.yaml</code>:</p> <pre><code>parsing:\n  python:\n    extra_extractors:\n      - my_extractors.InternalConfigExtractor\n</code></pre> <p>Or programmatically:</p> <pre><code>from jnkn.parsing.python import PythonParser\nfrom my_extractors import InternalConfigExtractor\n\nparser = PythonParser()\nparser.register_extractor(InternalConfigExtractor())\n</code></pre>"},{"location":"tutorials/advanced/custom-parsers/#using-tree-sitter-recommended","title":"Using Tree-Sitter (Recommended)","text":"<p>For complex patterns, use tree-sitter instead of regex:</p> <pre><code>from jnkn.parsing.python.extractors.base import BaseExtractor\n\nclass TypedConfigExtractor(BaseExtractor):\n    \"\"\"Extract env vars using tree-sitter AST.\"\"\"\n\n    # Tree-sitter query\n    QUERY = \"\"\"\n    (decorated_definition\n      (decorator\n        (call\n          function: (identifier) @_func\n          arguments: (argument_list\n            (keyword_argument\n              name: (identifier) @_kwarg\n              value: (string) @env_var))))\n      (#eq? @_func \"config\")\n      (#eq? @_kwarg \"env\"))\n    \"\"\"\n\n    def extract(self, file_path, file_id, tree, text, seen_vars):\n        if tree is None:\n            return  # Fall back to regex if no tree-sitter\n\n        query = self._language.query(self.QUERY)\n        captures = query.captures(tree.root_node)\n\n        for node, capture_name in captures:\n            if capture_name != \"env_var\":\n                continue\n\n            var_name = node.text.decode(\"utf-8\").strip('\"\\'')\n\n            if var_name in seen_vars:\n                continue\n\n            yield Node(\n                id=f\"env:{var_name}\",\n                name=var_name,\n                type=NodeType.ENV_VAR,\n                metadata={\n                    \"source\": self.name,\n                    \"file\": str(file_path),\n                    \"line\": node.start_point[0] + 1,\n                },\n            )\n\n            yield Edge(\n                source_id=file_id,\n                target_id=f\"env:{var_name}\",\n                type=RelationshipType.READS,\n            )\n</code></pre>"},{"location":"tutorials/advanced/custom-parsers/#testing-your-extractor","title":"Testing Your Extractor","text":"<p>Create <code>tests/test_internal_config.py</code>:</p> <pre><code>import pytest\nfrom pathlib import Path\nfrom my_extractors import InternalConfigExtractor\nfrom jnkn.core.types import NodeType\n\nclass TestInternalConfigExtractor:\n    @pytest.fixture\n    def extractor(self):\n        return InternalConfigExtractor()\n\n    def test_detects_config_decorator(self, extractor):\n        code = '''\n@config(env=\"DATABASE_URL\", required=True)\ndef get_db_url():\n    pass\n\n@config(env=\"API_KEY\")\ndef get_api_key():\n    pass\n'''\n\n        nodes = list(extractor.extract(\n            file_path=Path(\"test.py\"),\n            file_id=\"file://test.py\",\n            tree=None,\n            text=code,\n            seen_vars=set(),\n        ))\n\n        env_nodes = [n for n in nodes if hasattr(n, 'type') and n.type == NodeType.ENV_VAR]\n        env_names = {n.name for n in env_nodes}\n\n        assert env_names == {\"DATABASE_URL\", \"API_KEY\"}\n\n    def test_skips_already_seen(self, extractor):\n        code = '@config(env=\"DATABASE_URL\")\\ndef f(): pass'\n\n        nodes = list(extractor.extract(\n            file_path=Path(\"test.py\"),\n            file_id=\"file://test.py\",\n            tree=None,\n            text=code,\n            seen_vars={\"DATABASE_URL\"},  # Already seen\n        ))\n\n        env_nodes = [n for n in nodes if hasattr(n, 'type') and n.type == NodeType.ENV_VAR]\n        assert len(env_nodes) == 0\n</code></pre> <p>Run tests:</p> <pre><code>pytest tests/test_internal_config.py -v\n</code></pre>"},{"location":"tutorials/advanced/custom-parsers/#complete-example-go-parser","title":"Complete Example: Go Parser","text":"<p>For a new language, create a full parser:</p> <pre><code># jnkn_go/parser.py\nfrom jnkn.parsing.base import LanguageParser\n\nclass GoParser(LanguageParser):\n    @property\n    def name(self) -&gt; str:\n        return \"go\"\n\n    @property\n    def extensions(self) -&gt; list[str]:\n        return [\".go\"]\n\n    def parse(self, file_path, content):\n        # Detect os.Getenv(\"VAR\")\n        pattern = r'os\\.Getenv\\s*\\(\\s*\"([^\"]+)\"\\s*\\)'\n        ...\n</code></pre>"},{"location":"tutorials/advanced/custom-parsers/#next-steps","title":"Next Steps","text":"<ul> <li> Custom stitching rules</li> <li> Python patterns reference</li> </ul>"},{"location":"tutorials/advanced/custom-stitching-rules/","title":"Custom Stitching Rules","text":"<p>Create domain-specific rules for linking artifacts across your stack.</p> <p>Time: 30 minutes</p>"},{"location":"tutorials/advanced/custom-stitching-rules/#when-to-create-custom-rules","title":"When to Create Custom Rules","text":"<ul> <li>Your organization has naming conventions Jnkn doesn't know</li> <li>You need to link artifact types in specific ways</li> <li>Default token matching produces too many false positives</li> </ul>"},{"location":"tutorials/advanced/custom-stitching-rules/#how-stitching-works","title":"How Stitching Works","text":"<pre><code>graph LR\n    N1[Node A] --&gt; R{Rule Engine}\n    N2[Node B] --&gt; R\n    R --&gt; M{Matcher}\n    M --&gt; C[Confidence&lt;br/&gt;Calculator]\n    C --&gt; E[Edge]</code></pre> <p>Rules filter which node pairs to consider. Matchers compute similarity. Confidence scores determine if a link is created.</p>"},{"location":"tutorials/advanced/custom-stitching-rules/#creating-a-custom-rule","title":"Creating a Custom Rule","text":""},{"location":"tutorials/advanced/custom-stitching-rules/#example-link-python-services-to-their-terraform-modules","title":"Example: Link Python Services to Their Terraform Modules","text":"<p>Convention: Python service <code>payment_service</code> should link to Terraform module <code>modules/payment</code>.</p> <pre><code># my_rules/service_to_module.py\nfrom jnkn.stitching.rules import StitchingRule\nfrom jnkn.core.types import Node, NodeType\n\nclass ServiceToModuleRule(StitchingRule):\n    \"\"\"\n    Link Python service files to Terraform modules.\n\n    Convention: src/services/{name}_service.py \u2192 terraform/modules/{name}/\n    \"\"\"\n\n    @property\n    def name(self) -&gt; str:\n        return \"service_to_module\"\n\n    @property\n    def source_types(self) -&gt; set[NodeType]:\n        return {NodeType.CODE_FILE}\n\n    @property\n    def target_types(self) -&gt; set[NodeType]:\n        return {NodeType.INFRA_RESOURCE}\n\n    def should_evaluate(self, source: Node, target: Node) -&gt; bool:\n        \"\"\"Quick filter before expensive matching.\"\"\"\n        # Source must be a Python service file\n        if not source.path:\n            return False\n        if \"_service.py\" not in source.path:\n            return False\n\n        # Target must be a Terraform module resource\n        if not target.id.startswith(\"infra:module.\"):\n            return False\n\n        return True\n\n    def extract_service_name(self, path: str) -&gt; str | None:\n        \"\"\"Extract service name from path like 'src/services/payment_service.py'.\"\"\"\n        import re\n        match = re.search(r'/(\\w+)_service\\.py$', path)\n        return match.group(1) if match else None\n\n    def extract_module_name(self, node_id: str) -&gt; str | None:\n        \"\"\"Extract module name from ID like 'infra:module.payment.aws_rds'.\"\"\"\n        import re\n        match = re.search(r'^infra:module\\.(\\w+)\\.', node_id)\n        return match.group(1) if match else None\n\n    def compute_confidence(self, source: Node, target: Node) -&gt; float:\n        \"\"\"Compute match confidence.\"\"\"\n        service_name = self.extract_service_name(source.path)\n        module_name = self.extract_module_name(target.id)\n\n        if not service_name or not module_name:\n            return 0.0\n\n        # Exact match\n        if service_name == module_name:\n            return 0.95\n\n        # Partial match (e.g., \"payment\" in \"payment_gateway\")\n        if service_name in module_name or module_name in service_name:\n            return 0.75\n\n        return 0.0\n</code></pre>"},{"location":"tutorials/advanced/custom-stitching-rules/#register-the-rule","title":"Register the Rule","text":"<p>In <code>.jnkn/config.yaml</code>:</p> <pre><code>stitching:\n  extra_rules:\n    - my_rules.ServiceToModuleRule\n</code></pre> <p>Or programmatically:</p> <pre><code>from jnkn.stitching import StitchingEngine\nfrom my_rules import ServiceToModuleRule\n\nengine = StitchingEngine()\nengine.register_rule(ServiceToModuleRule())\n</code></pre>"},{"location":"tutorials/advanced/custom-stitching-rules/#rule-interface","title":"Rule Interface","text":"<pre><code>class StitchingRule(ABC):\n    @property\n    @abstractmethod\n    def name(self) -&gt; str:\n        \"\"\"Unique identifier for this rule.\"\"\"\n\n    @property\n    @abstractmethod\n    def source_types(self) -&gt; set[NodeType]:\n        \"\"\"Node types this rule matches as sources.\"\"\"\n\n    @property\n    @abstractmethod\n    def target_types(self) -&gt; set[NodeType]:\n        \"\"\"Node types this rule matches as targets.\"\"\"\n\n    @abstractmethod\n    def should_evaluate(self, source: Node, target: Node) -&gt; bool:\n        \"\"\"Quick filter before expensive computation.\"\"\"\n\n    @abstractmethod\n    def compute_confidence(self, source: Node, target: Node) -&gt; float:\n        \"\"\"Return confidence score 0.0-1.0.\"\"\"\n\n    def get_metadata(self, source: Node, target: Node) -&gt; dict:\n        \"\"\"Optional: Add metadata to the created edge.\"\"\"\n        return {\"rule\": self.name}\n</code></pre>"},{"location":"tutorials/advanced/custom-stitching-rules/#advanced-context-aware-rules","title":"Advanced: Context-Aware Rules","text":"<p>Rules can access the full graph for context:</p> <pre><code>class TransitiveDependencyRule(StitchingRule):\n    \"\"\"Link nodes that share a common dependency.\"\"\"\n\n    def __init__(self, graph):\n        self.graph = graph\n\n    def compute_confidence(self, source: Node, target: Node) -&gt; float:\n        # Find common dependencies\n        source_deps = set(self.graph.get_dependencies(source.id))\n        target_deps = set(self.graph.get_dependencies(target.id))\n\n        common = source_deps &amp; target_deps\n\n        if not common:\n            return 0.0\n\n        # More shared dependencies = higher confidence\n        overlap = len(common) / min(len(source_deps), len(target_deps))\n        return min(0.9, overlap)\n</code></pre>"},{"location":"tutorials/advanced/custom-stitching-rules/#testing-rules","title":"Testing Rules","text":"<pre><code>import pytest\nfrom my_rules import ServiceToModuleRule\nfrom jnkn.core.types import Node, NodeType\n\nclass TestServiceToModuleRule:\n    @pytest.fixture\n    def rule(self):\n        return ServiceToModuleRule()\n\n    def test_exact_match(self, rule):\n        source = Node(\n            id=\"file://src/services/payment_service.py\",\n            name=\"payment_service.py\",\n            type=NodeType.CODE_FILE,\n            path=\"src/services/payment_service.py\",\n        )\n        target = Node(\n            id=\"infra:module.payment.aws_rds\",\n            name=\"aws_rds\",\n            type=NodeType.INFRA_RESOURCE,\n        )\n\n        assert rule.should_evaluate(source, target) is True\n        assert rule.compute_confidence(source, target) == 0.95\n\n    def test_no_match(self, rule):\n        source = Node(\n            id=\"file://src/utils.py\",\n            name=\"utils.py\",\n            type=NodeType.CODE_FILE,\n            path=\"src/utils.py\",\n        )\n        target = Node(\n            id=\"infra:module.payment.aws_rds\",\n            name=\"aws_rds\",\n            type=NodeType.INFRA_RESOURCE,\n        )\n\n        assert rule.should_evaluate(source, target) is False\n</code></pre>"},{"location":"tutorials/advanced/custom-stitching-rules/#built-in-rules","title":"Built-in Rules","text":"<p>Jnkn ships with these rules:</p> Rule Source \u2192 Target Description <code>EnvVarToInfraRule</code> env_var \u2192 infra Token matching <code>CodeToEnvRule</code> code_file \u2192 env_var Direct detection <code>K8sToSecretRule</code> k8s_workload \u2192 k8s_secret ConfigMap/Secret refs <code>DbtRefRule</code> dbt_model \u2192 dbt_model <code>ref()</code> calls"},{"location":"tutorials/advanced/custom-stitching-rules/#disabling-built-in-rules","title":"Disabling Built-in Rules","text":"<pre><code>stitching:\n  disabled_rules:\n    - EnvVarToInfraRule  # Too many false positives for us\n</code></pre>"},{"location":"tutorials/advanced/custom-stitching-rules/#next-steps","title":"Next Steps","text":"<ul> <li> Confidence model explanation</li> <li> Stitching engine architecture</li> </ul>"},{"location":"tutorials/advanced/enterprise-deployment/","title":"Enterprise Deployment","text":"<p>Air-gapped installation and compliance.</p>"},{"location":"tutorials/advanced/extending-junkan/","title":"Extending Jnkn","text":"<p>Using the plugin architecture.</p>"},{"location":"tutorials/beginner/fixing-false-positives/","title":"Fixing False Positives","text":"<p>Learn to tune Jnkn when it makes incorrect matches.</p> <p>Time: 10 minutes</p>"},{"location":"tutorials/beginner/fixing-false-positives/#when-to-suppress","title":"When to Suppress","text":"<p>False positives happen when Jnkn links unrelated artifacts due to similar names:</p> <pre><code>env:HOST  \u2190\u2192  infra:ghost_writer    # Wrong! Just share \"host\" substring\nenv:ID    \u2190\u2192  infra:user_id         # Wrong! \"ID\" is too generic\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#strategy-1-raise-confidence-threshold","title":"Strategy 1: Raise Confidence Threshold","text":"<p>Edit <code>.jnkn/config.yaml</code>:</p> <pre><code>stitching:\n  min_confidence: 0.6  # Default is 0.5\n</code></pre> <p>Higher threshold = fewer matches = fewer false positives (but may miss real links).</p>"},{"location":"tutorials/beginner/fixing-false-positives/#strategy-2-add-suppressions","title":"Strategy 2: Add Suppressions","text":"<p>Suppress specific patterns that you know are wrong.</p>"},{"location":"tutorials/beginner/fixing-false-positives/#suppress-a-single-match","title":"Suppress a Single Match","text":"<pre><code>jnkn suppress add \"env:HOST\" \"infra:ghost_writer\" \\\n  --reason \"Unrelated - ghost_writer is a logging service\"\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#suppress-a-pattern","title":"Suppress a Pattern","text":"<p>Use globs to suppress categories:</p> <pre><code># All *_ID env vars are too generic\njnkn suppress add \"env:*_ID\" \"infra:*\" \\\n  --reason \"ID fields are too generic for matching\"\n\n# Ignore all matches to test infrastructure  \njnkn suppress add \"*\" \"infra:test_*\" \\\n  --reason \"Test infrastructure, not production\"\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#list-suppressions","title":"List Suppressions","text":"<pre><code>jnkn suppress list\n</code></pre> <pre><code>ID  Source        Target         Reason                    Expires\n1   env:HOST      infra:ghost_*  Unrelated services        never\n2   env:*_ID      infra:*        ID fields too generic     never\n3   *             infra:test_*   Test infrastructure       2024-03-01\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#remove-a-suppression","title":"Remove a Suppression","text":"<pre><code>jnkn suppress remove 1\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#test-a-suppression","title":"Test a Suppression","text":"<p>Check if a match would be suppressed:</p> <pre><code>jnkn suppress test env:USER_ID infra:user_service\n</code></pre> <pre><code>\u2713 Would be SUPPRESSED by rule 2: \"env:*_ID\" \u2192 \"infra:*\"\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#strategy-3-configure-token-filtering","title":"Strategy 3: Configure Token Filtering","text":"<p>Some tokens are too common to be meaningful. Edit <code>.jnkn/config.yaml</code>:</p> <pre><code>stitching:\n  blocked_tokens:\n    - id\n    - key\n    - url\n    - host\n    - port\n    - name\n\n  min_token_length: 3  # Ignore tokens shorter than this\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#suppressions-file","title":"Suppressions File","text":"<p>Suppressions are stored in <code>.jnkn/suppressions.yaml</code>:</p> <pre><code>suppressions:\n  - source_pattern: \"env:*_ID\"\n    target_pattern: \"infra:*\"\n    reason: \"ID fields are too generic\"\n    enabled: true\n    expires: null\n    created_at: \"2024-01-15T10:30:00Z\"\n\n  - source_pattern: \"env:HOST\"\n    target_pattern: \"infra:ghost_*\"\n    reason: \"Unrelated services\"\n    enabled: true\n    expires: \"2024-06-01\"\n    created_at: \"2024-01-15T10:35:00Z\"\n</code></pre> <p>Commit suppressions to git</p> <p>Suppressions should be version-controlled so the whole team benefits.</p>"},{"location":"tutorials/beginner/fixing-false-positives/#verifying-your-fixes","title":"Verifying Your Fixes","text":"<p>After adding suppressions, re-scan:</p> <pre><code>jnkn scan --full\n</code></pre> <p>Check that false positives are gone:</p> <pre><code>jnkn blast env:HOST\n</code></pre>"},{"location":"tutorials/beginner/fixing-false-positives/#when-to-not-suppress","title":"When to NOT Suppress","text":"<p>Don't suppress just because a match is unexpected. Investigate first:</p> <pre><code>jnkn explain env:PAYMENT_DB_HOST infra:payment_database\n</code></pre> <p>If the confidence is high and the tokens genuinely overlap, the match might be correct \u2014 you may have discovered a real dependency you didn't know about.</p>"},{"location":"tutorials/beginner/fixing-false-positives/#next-steps","title":"Next Steps","text":"<ul> <li> Configure confidence in detail</li> <li> Understand how matching works</li> </ul>"},{"location":"tutorials/beginner/scanning-python-project/","title":"Scanning a Python Project","text":"<p>Learn to detect environment variables in a Python application.</p> <p>Time: 10 minutes</p>"},{"location":"tutorials/beginner/scanning-python-project/#prerequisites","title":"Prerequisites","text":"<ul> <li>Jnkn installed (<code>pip install jnkn[full]</code>)</li> <li>A Python project (or use our example)</li> </ul>"},{"location":"tutorials/beginner/scanning-python-project/#setup","title":"Setup","text":"<p>If you don't have a project, create a sample:</p> <pre><code>mkdir jnkn-tutorial &amp;&amp; cd jnkn-tutorial\n</code></pre> <p>Create <code>app/config.py</code>:</p> <pre><code>import os\nfrom pydantic_settings import BaseSettings\n\nclass Settings(BaseSettings):\n    database_url: str\n    api_key: str\n    debug: bool = False\n\n    class Config:\n        env_prefix = \"APP_\"\n\nsettings = Settings()\n\n# Also using direct env access\nREDIS_URL = os.getenv(\"REDIS_URL\", \"redis://localhost:6379\")\nLOG_LEVEL = os.environ.get(\"LOG_LEVEL\", \"INFO\")\n</code></pre> <p>Create <code>app/main.py</code>:</p> <pre><code>from config import settings, REDIS_URL\nimport os\n\ndef get_db_connection():\n    return connect(os.getenv(\"DATABASE_URL\"))  # Different from settings!\n\ndef get_cache():\n    return Redis.from_url(REDIS_URL)\n</code></pre>"},{"location":"tutorials/beginner/scanning-python-project/#scan","title":"Scan","text":"<pre><code>jnkn init\njnkn scan\n</code></pre> <p>Output:</p> <pre><code>\ud83d\udd0d Scanning /path/to/jnkn-tutorial\n\ud83d\udcc1 Found 2 Python files\n\u2705 Parsed 8 nodes, 6 edges\n\nDetected Environment Variables:\n  env:APP_DATABASE_URL     (pydantic_settings)\n  env:APP_API_KEY          (pydantic_settings)  \n  env:APP_DEBUG            (pydantic_settings)\n  env:REDIS_URL            (os.getenv)\n  env:LOG_LEVEL            (os.environ.get)\n  env:DATABASE_URL         (os.getenv)\n</code></pre>"},{"location":"tutorials/beginner/scanning-python-project/#understanding-the-output","title":"Understanding the Output","text":"<p>Jnkn detected 6 environment variables from multiple patterns:</p> Variable Source Pattern <code>APP_DATABASE_URL</code> Pydantic Settings <code>env_prefix + field_name</code> <code>APP_API_KEY</code> Pydantic Settings <code>env_prefix + field_name</code> <code>APP_DEBUG</code> Pydantic Settings <code>env_prefix + field_name</code> <code>REDIS_URL</code> Direct access <code>os.getenv()</code> <code>LOG_LEVEL</code> Direct access <code>os.environ.get()</code> <code>DATABASE_URL</code> Direct access <code>os.getenv()</code> <p>Potential Bug Detected</p> <p>Notice <code>DATABASE_URL</code> and <code>APP_DATABASE_URL</code> \u2014 these might be the same intent but different names. Jnkn helps you spot these inconsistencies.</p>"},{"location":"tutorials/beginner/scanning-python-project/#view-the-graph","title":"View the Graph","text":"<pre><code>jnkn stats\n</code></pre> <pre><code>\ud83d\udcca Graph Statistics\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nNodes by Type:\n  code_file:    2\n  env_var:      6\n\nEdges by Type:\n  reads:        6\n</code></pre>"},{"location":"tutorials/beginner/scanning-python-project/#explore-dependencies","title":"Explore Dependencies","text":"<p>Which files read <code>REDIS_URL</code>?</p> <pre><code>jnkn blast env:REDIS_URL\n</code></pre> <pre><code>{\n  \"source\": \"env:REDIS_URL\",\n  \"impacted\": [\"file://app/config.py\"],\n  \"total_impacted\": 1\n}\n</code></pre>"},{"location":"tutorials/beginner/scanning-python-project/#supported-python-patterns","title":"Supported Python Patterns","text":"<p>Jnkn detects these patterns automatically:</p> Pattern Example <code>os.getenv()</code> <code>os.getenv(\"VAR\")</code> <code>os.environ.get()</code> <code>os.environ.get(\"VAR\")</code> <code>os.environ[]</code> <code>os.environ[\"VAR\"]</code> Pydantic Settings <code>class Config(BaseSettings)</code> Pydantic Field <code>Field(env=\"VAR\")</code> Click/Typer <code>@click.option(envvar=\"VAR\")</code> django-environ <code>env.str(\"VAR\")</code> <p>See Python Patterns Reference for the full list.</p>"},{"location":"tutorials/beginner/scanning-python-project/#next-steps","title":"Next Steps","text":"<ul> <li> Understanding Blast Radius</li> <li> Add Terraform to your scan</li> </ul>"},{"location":"tutorials/beginner/scanning-terraform/","title":"Scanning Terraform","text":"<p>Learn how to map infrastructure resources.</p>"},{"location":"tutorials/beginner/understanding-blast-radius/","title":"Understanding Blast Radius","text":"<p>Learn to read Jnkn's impact analysis output.</p> <p>Time: 15 minutes</p>"},{"location":"tutorials/beginner/understanding-blast-radius/#what-is-blast-radius","title":"What is Blast Radius?","text":"<p>Blast radius answers: \"If I change X, what else might break?\"</p> <pre><code>graph TD\n    ENV[env:DATABASE_URL] --&gt; F1[connection.py]\n    ENV --&gt; F2[users.py]\n    ENV --&gt; TF[aws_db_instance.main]\n    F1 --&gt; F3[api.py]\n\n    style ENV fill:#ff6b6b,stroke:#c92a2a\n    style F1 fill:#ffd43b,stroke:#fab005\n    style F2 fill:#ffd43b,stroke:#fab005\n    style TF fill:#ffd43b,stroke:#fab005\n    style F3 fill:#ffe066,stroke:#fab005</code></pre> <p>Changing <code>DATABASE_URL</code> directly impacts 3 artifacts, and transitively impacts 1 more.</p>"},{"location":"tutorials/beginner/understanding-blast-radius/#running-blast-radius","title":"Running Blast Radius","text":"<pre><code>jnkn blast env:DATABASE_URL\n</code></pre>"},{"location":"tutorials/beginner/understanding-blast-radius/#json-output-default","title":"JSON Output (Default)","text":"<pre><code>{\n  \"source_artifacts\": [\"env:DATABASE_URL\"],\n  \"total_impacted_count\": 4,\n  \"impacted_artifacts\": [\n    \"file://src/db/connection.py\",\n    \"file://src/api/users.py\",\n    \"infra:aws_db_instance.main\",\n    \"file://src/api/api.py\"\n  ],\n  \"breakdown\": {\n    \"code\": [\"file://src/db/connection.py\", \"file://src/api/users.py\", \"file://src/api/api.py\"],\n    \"infra\": [\"infra:aws_db_instance.main\"],\n    \"env\": [],\n    \"data\": []\n  },\n  \"max_depth_reached\": 2\n}\n</code></pre>"},{"location":"tutorials/beginner/understanding-blast-radius/#understanding-the-fields","title":"Understanding the Fields","text":"Field Meaning <code>source_artifacts</code> What you're analyzing <code>total_impacted_count</code> Total downstream artifacts <code>impacted_artifacts</code> List of affected artifacts <code>breakdown</code> Grouped by type <code>max_depth_reached</code> How far the impact travels"},{"location":"tutorials/beginner/understanding-blast-radius/#reading-artifact-ids","title":"Reading Artifact IDs","text":"<p>Jnkn uses prefixed IDs to identify artifact types:</p> Prefix Type Example <code>env:</code> Environment variable <code>env:DATABASE_URL</code> <code>file://</code> Code file <code>file://src/app.py</code> <code>infra:</code> Infrastructure resource <code>infra:aws_rds.main</code> <code>data:</code> Data asset (dbt model) <code>data:fct_orders</code> <code>k8s:</code> Kubernetes resource <code>k8s:default/deployment/api</code>"},{"location":"tutorials/beginner/understanding-blast-radius/#limiting-depth","title":"Limiting Depth","text":"<p>For large graphs, limit traversal depth:</p> <pre><code>jnkn blast env:DATABASE_URL --max-depth 1\n</code></pre> <p>This shows only direct dependencies, not transitive ones.</p>"},{"location":"tutorials/beginner/understanding-blast-radius/#multiple-sources","title":"Multiple Sources","text":"<p>Analyze multiple artifacts at once:</p> <pre><code>jnkn blast env:DATABASE_URL env:REDIS_URL\n</code></pre> <p>The result shows the union of all impacted artifacts.</p>"},{"location":"tutorials/beginner/understanding-blast-radius/#output-formats","title":"Output Formats","text":"JSONMarkdownPlain <pre><code>jnkn blast env:X --format json\n</code></pre> <pre><code>jnkn blast env:X --format markdown\n</code></pre> <pre><code>## Blast Radius: env:X\n\n**4 artifacts impacted**\n\n| Type | Artifact |\n|------|----------|\n| code | file://src/db/connection.py |\n| code | file://src/api/users.py |\n| infra | infra:aws_db_instance.main |\n</code></pre> <pre><code>jnkn blast env:X --format plain\n</code></pre> <pre><code>file://src/db/connection.py\nfile://src/api/users.py\ninfra:aws_db_instance.main\n</code></pre>"},{"location":"tutorials/beginner/understanding-blast-radius/#interpreting-results","title":"Interpreting Results","text":""},{"location":"tutorials/beginner/understanding-blast-radius/#low-impact-1-3-artifacts","title":"Low Impact (1-3 artifacts)","text":"<p>Safe to proceed. Normal for leaf nodes or well-encapsulated components.</p>"},{"location":"tutorials/beginner/understanding-blast-radius/#medium-impact-4-10-artifacts","title":"Medium Impact (4-10 artifacts)","text":"<p>Review carefully. Consider notifying affected teams.</p>"},{"location":"tutorials/beginner/understanding-blast-radius/#high-impact-10-artifacts","title":"High Impact (10+ artifacts)","text":"<p>Proceed with caution. This change affects many components:</p> <ul> <li>Schedule deployment during low-traffic periods</li> <li>Have rollback plan ready</li> <li>Consider feature flags</li> </ul>"},{"location":"tutorials/beginner/understanding-blast-radius/#why-is-something-in-the-blast-radius","title":"Why Is Something in the Blast Radius?","text":"<p>Use <code>explain</code> to understand why two artifacts are linked:</p> <pre><code>jnkn explain env:DATABASE_URL infra:aws_db_instance.main\n</code></pre> <pre><code>Confidence: 0.87 (HIGH)\n\nSignals:\n  [+0.85] token_overlap: 3/3 tokens match [database, url, main]\n  [+0.10] suffix_match: both end in common pattern\n\nPenalties:\n  [-0.08] short_token: 'url' is only 3 chars\n</code></pre>"},{"location":"tutorials/beginner/understanding-blast-radius/#next-steps","title":"Next Steps","text":"<ul> <li> Fix false positives</li> <li> Configure confidence</li> </ul>"},{"location":"tutorials/intermediate/ci-cd-integration/","title":"CI/CD Integration","text":"<p>Set up a complete CI pipeline with impact analysis, blocking, and notifications.</p> <p>Time: 25 minutes</p>"},{"location":"tutorials/intermediate/ci-cd-integration/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    PR[Pull Request] --&gt; Scan[jnkn scan]\n    Scan --&gt; Diff[jnkn diff]\n    Diff --&gt; Check{Impact &gt; threshold?}\n    Check --&gt;|No| Pass[\u2705 Pass]\n    Check --&gt;|Yes| Block[\u274c Block + Comment]</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#github-actions-full-setup","title":"GitHub Actions: Full Setup","text":"<p>Create <code>.github/workflows/jnkn.yml</code>:</p> <pre><code>name: Jnkn Impact Analysis\n\non:\n  pull_request:\n    paths:\n      - '**.py'\n      - '**.tf'\n      - '**.yaml'\n      - '**.yml'\n\npermissions:\n  contents: read\n  pull-requests: write\n\nenv:\n  JUNKAN_MIN_CONFIDENCE: 0.5\n  IMPACT_THRESHOLD: 10\n\njobs:\n  analyze:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout PR\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Checkout base branch\n        run: git fetch origin ${{ github.base_ref }}\n\n      - name: Set up Python\n        uses: actions/setup-python@v5\n        with:\n          python-version: '3.11'\n          cache: 'pip'\n\n      - name: Install Jnkn\n        run: pip install jnkn[full]\n\n      - name: Scan base branch\n        run: |\n          git checkout origin/${{ github.base_ref }}\n          jnkn scan --db .jnkn/base.db\n\n      - name: Scan PR branch\n        run: |\n          git checkout ${{ github.sha }}\n          jnkn scan --db .jnkn/pr.db\n\n      - name: Analyze impact\n        id: impact\n        run: |\n          # Get changed files\n          CHANGED=$(git diff --name-only origin/${{ github.base_ref }}...HEAD)\n\n          # Calculate total impact\n          TOTAL_IMPACT=0\n          REPORT=\"\"\n\n          for file in $CHANGED; do\n            if [[ \"$file\" =~ \\.(py|tf|yaml|yml)$ ]]; then\n              IMPACT=$(jnkn blast \"file://$file\" --db .jnkn/pr.db --format json 2&gt;/dev/null | jq -r '.total_impacted_count // 0')\n              TOTAL_IMPACT=$((TOTAL_IMPACT + IMPACT))\n\n              if [ \"$IMPACT\" -gt 0 ]; then\n                REPORT=\"$REPORT\\n### \\`$file\\` \u2014 $IMPACT artifacts\\n\"\n                REPORT=\"$REPORT$(jnkn blast \"file://$file\" --db .jnkn/pr.db --format markdown 2&gt;/dev/null || echo '')\\n\"\n              fi\n            fi\n          done\n\n          echo \"total=$TOTAL_IMPACT\" &gt;&gt; $GITHUB_OUTPUT\n          echo \"report&lt;&lt;EOF\" &gt;&gt; $GITHUB_OUTPUT\n          echo -e \"$REPORT\" &gt;&gt; $GITHUB_OUTPUT\n          echo \"EOF\" &gt;&gt; $GITHUB_OUTPUT\n\n      - name: Comment on PR\n        uses: actions/github-script@v7\n        with:\n          script: |\n            const impact = ${{ steps.impact.outputs.total }};\n            const threshold = ${{ env.IMPACT_THRESHOLD }};\n            const report = `${{ steps.impact.outputs.report }}`;\n\n            let status = impact &gt; threshold ? '\ud83d\udd34' : '\ud83d\udfe2';\n            let message = `## ${status} Jnkn Impact Analysis\\n\\n`;\n            message += `**Total Impact:** ${impact} artifacts\\n\\n`;\n\n            if (impact &gt; threshold) {\n              message += `\u26a0\ufe0f **High impact change!** Threshold is ${threshold}.\\n\\n`;\n            }\n\n            if (report.trim()) {\n              message += `### Details\\n${report}`;\n            } else {\n              message += `No cross-domain dependencies detected.`;\n            }\n\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: message\n            });\n\n      - name: Enforce threshold\n        if: steps.impact.outputs.total &gt; env.IMPACT_THRESHOLD\n        run: |\n          echo \"::error::Impact (${{ steps.impact.outputs.total }}) exceeds threshold (${{ env.IMPACT_THRESHOLD }})\"\n          exit 1\n</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#what-this-does","title":"What This Does","text":"<ol> <li>Scans both branches \u2014 Compares base and PR states</li> <li>Calculates impact \u2014 For each changed file</li> <li>Posts a comment \u2014 With detailed breakdown</li> <li>Blocks if too risky \u2014 Fails the check if impact exceeds threshold</li> </ol>"},{"location":"tutorials/intermediate/ci-cd-integration/#example-pr-comment","title":"Example PR Comment","text":"<pre><code>## \ud83d\udd34 Jnkn Impact Analysis\n\n**Total Impact:** 15 artifacts\n\n\u26a0\ufe0f **High impact change!** Threshold is 10.\n\n### Details\n\n### `terraform/rds.tf` \u2014 8 artifacts\n\n| Type | Artifact | Confidence |\n|------|----------|------------|\n| env_var | env:DATABASE_URL | 0.92 |\n| code | src/db/connection.py | 0.88 |\n| code | src/api/users.py | 0.85 |\n| k8s | deployment/api | 0.82 |\n...\n\n### `src/config.py` \u2014 7 artifacts\n...\n</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#customization-options","title":"Customization Options","text":""},{"location":"tutorials/intermediate/ci-cd-integration/#adjust-threshold-by-path","title":"Adjust Threshold by Path","text":"<pre><code>- name: Set threshold\n  run: |\n    if [[ \"${{ github.event.pull_request.base.ref }}\" == \"main\" ]]; then\n      echo \"IMPACT_THRESHOLD=5\" &gt;&gt; $GITHUB_ENV  # Stricter for main\n    else\n      echo \"IMPACT_THRESHOLD=20\" &gt;&gt; $GITHUB_ENV\n    fi\n</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#skip-analysis-for-certain-prs","title":"Skip Analysis for Certain PRs","text":"<pre><code>- name: Check skip label\n  if: contains(github.event.pull_request.labels.*.name, 'skip-jnkn')\n  run: echo \"Skipping Jnkn analysis\"\n</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#notify-slack-on-high-impact","title":"Notify Slack on High Impact","text":"<pre><code>- name: Notify Slack\n  if: steps.impact.outputs.total &gt; 15\n  uses: slackapi/slack-github-action@v1\n  with:\n    payload: |\n      {\n        \"text\": \"\ud83d\udea8 High-impact PR: ${{ github.event.pull_request.html_url }}\\nImpact: ${{ steps.impact.outputs.total }} artifacts\"\n      }\n  env:\n    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}\n</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#caching-for-speed","title":"Caching for Speed","text":"<pre><code>- name: Cache Jnkn database\n  uses: actions/cache@v4\n  with:\n    path: .jnkn/\n    key: jnkn-${{ hashFiles('**/*.py', '**/*.tf') }}\n    restore-keys: jnkn-\n</code></pre>"},{"location":"tutorials/intermediate/ci-cd-integration/#next-steps","title":"Next Steps","text":"<ul> <li> GitLab CI setup</li> <li> Configure thresholds</li> </ul>"},{"location":"tutorials/intermediate/custom-confidence-tuning/","title":"Confidence Tuning","text":"<p>Adjusting matching thresholds for your organization.</p>"},{"location":"tutorials/intermediate/multi-stack-analysis/","title":"Multi-Stack Analysis","text":"<p>Analyze dependencies across Python, Terraform, and Kubernetes together.</p> <p>Time: 20 minutes</p>"},{"location":"tutorials/intermediate/multi-stack-analysis/#the-setup","title":"The Setup","text":"<p>A typical production stack:</p> <pre><code>my-service/\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 app/\n\u2502       \u251c\u2500\u2500 config.py      # Python settings\n\u2502       \u2514\u2500\u2500 main.py        # Application code\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 main.tf           # Infrastructure\n\u2502   \u2514\u2500\u2500 variables.tf\n\u2514\u2500\u2500 k8s/\n    \u2514\u2500\u2500 deployment.yaml   # Kubernetes manifests\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#python-configuration","title":"Python Configuration","text":"<p><code>src/app/config.py</code>:</p> <pre><code>import os\n\nDATABASE_URL = os.getenv(\"DATABASE_URL\")\nREDIS_HOST = os.getenv(\"REDIS_HOST\", \"localhost\")\nAPI_SECRET = os.environ[\"API_SECRET\"]\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#terraform-infrastructure","title":"Terraform Infrastructure","text":"<p><code>terraform/main.tf</code>:</p> <pre><code>resource \"aws_db_instance\" \"main\" {\n  identifier = \"my-service-db\"\n  engine     = \"postgres\"\n}\n\nresource \"aws_elasticache_cluster\" \"redis\" {\n  cluster_id = \"my-service-redis\"\n}\n\noutput \"database_url\" {\n  value = \"postgresql://${aws_db_instance.main.endpoint}/mydb\"\n}\n\noutput \"redis_host\" {\n  value = aws_elasticache_cluster.redis.cache_nodes[0].address\n}\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#kubernetes-deployment","title":"Kubernetes Deployment","text":"<p><code>k8s/deployment.yaml</code>:</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: my-service\nspec:\n  template:\n    spec:\n      containers:\n        - name: app\n          env:\n            - name: DATABASE_URL\n              valueFrom:\n                secretKeyRef:\n                  name: my-service-secrets\n                  key: database-url\n            - name: REDIS_HOST\n              valueFrom:\n                configMapKeyRef:\n                  name: my-service-config\n                  key: redis-host\n            - name: API_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: my-service-secrets\n                  key: api-secret\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#scan-everything","title":"Scan Everything","text":"<pre><code>jnkn scan\n</code></pre> <p>Output:</p> <pre><code>\ud83d\udd0d Scanning /path/to/my-service\n\ud83d\udcc1 Found 5 files (2 Python, 2 Terraform, 1 Kubernetes)\n\u2705 Parsed 15 nodes, 12 edges\n\ud83e\uddf5 Stitching cross-domain dependencies...\n\u2705 Created 6 cross-domain links\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#the-unified-graph","title":"The Unified Graph","text":"<p>Jnkn builds a single graph across all stacks:</p> <pre><code>graph TD\n    subgraph Python\n        PY1[config.py]\n        ENV1[env:DATABASE_URL]\n        ENV2[env:REDIS_HOST]\n        ENV3[env:API_SECRET]\n    end\n\n    subgraph Terraform\n        TF1[aws_db_instance.main]\n        TF2[aws_elasticache.redis]\n        OUT1[output:database_url]\n        OUT2[output:redis_host]\n    end\n\n    subgraph Kubernetes\n        K8S[deployment/my-service]\n        SEC[secret/my-service-secrets]\n        CM[configmap/my-service-config]\n    end\n\n    PY1 --&gt; ENV1\n    PY1 --&gt; ENV2\n    PY1 --&gt; ENV3\n\n    TF1 -.-&gt;|stitched| ENV1\n    TF2 -.-&gt;|stitched| ENV2\n\n    K8S --&gt; SEC\n    K8S --&gt; CM\n    SEC -.-&gt;|stitched| ENV1\n    SEC -.-&gt;|stitched| ENV3\n    CM -.-&gt;|stitched| ENV2\n\n    style ENV1 fill:#ff6b6b\n    style ENV2 fill:#ff6b6b\n    style ENV3 fill:#ff6b6b</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#cross-domain-queries","title":"Cross-Domain Queries","text":""},{"location":"tutorials/intermediate/multi-stack-analysis/#what-breaks-if-we-change-the-database","title":"What breaks if we change the database?","text":"<pre><code>jnkn blast infra:aws_db_instance.main\n</code></pre> <pre><code>{\n  \"source\": \"infra:aws_db_instance.main\",\n  \"impacted\": [\n    \"env:DATABASE_URL\",\n    \"file://src/app/config.py\",\n    \"k8s:default/secret/my-service-secrets\"\n  ]\n}\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#what-provides-redis_host","title":"What provides REDIS_HOST?","text":"<pre><code>jnkn explain env:REDIS_HOST infra:aws_elasticache.redis\n</code></pre> <pre><code>Confidence: 0.82 (HIGH)\n  [+0.85] token_overlap: [redis, host] match\n  [+0.10] terraform_output: output.redis_host references this resource\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#what-happens-if-we-delete-the-configmap","title":"What happens if we delete the ConfigMap?","text":"<pre><code>jnkn blast k8s:default/configmap/my-service-config\n</code></pre> <pre><code>{\n  \"source\": \"k8s:default/configmap/my-service-config\",\n  \"impacted\": [\n    \"k8s:default/deployment/my-service\",\n    \"env:REDIS_HOST\",\n    \"file://src/app/config.py\"\n  ]\n}\n</code></pre>"},{"location":"tutorials/intermediate/multi-stack-analysis/#real-world-scenario","title":"Real-World Scenario","text":"<p>PR: \"Rename <code>redis_host</code> output to <code>cache_endpoint</code>\"</p> <pre><code># What's the impact?\njnkn blast infra:output.redis_host\n</code></pre> <pre><code>\u26a0\ufe0f  4 artifacts affected:\n\n  \u2022 env:REDIS_HOST (config.py will fail to get value)\n  \u2022 k8s:default/configmap/my-service-config (references old name)\n  \u2022 k8s:default/deployment/my-service (pod won't start)\n  \u2022 file://src/app/config.py (REDIS_HOST will be None)\n</code></pre> <p>Action: Update ConfigMap and Python code before merging the Terraform change.</p>"},{"location":"tutorials/intermediate/multi-stack-analysis/#next-steps","title":"Next Steps","text":"<ul> <li> Set up CI to catch these automatically</li> <li> Add dbt to your analysis</li> </ul>"},{"location":"tutorials/intermediate/team-workflows/","title":"Team Workflows","text":"<p>Sharing config and suppressions across teams.</p>"}]}